import{j as o,r as l}from"./react-CvHEjaVo.js";function Or(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(t);s<n.length;s++)e.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(t,n[s])&&(r[n[s]]=t[n[s]]);return r}const le="abcdefgh".split(""),Oe={a8:"bR",b8:"bN",c8:"bB",d8:"bQ",e8:"bK",f8:"bB",g8:"bN",h8:"bR",a7:"bP",b7:"bP",c7:"bP",d7:"bP",e7:"bP",f7:"bP",g7:"bP",h7:"bP",a2:"wP",b2:"wP",c2:"wP",d2:"wP",e2:"wP",f2:"wP",g2:"wP",h2:"wP",a1:"wR",b1:"wN",c1:"wB",d1:"wQ",e1:"wK",f1:"wB",g1:"wN",h1:"wR"},Dr={a:0,b:1,c:2,d:3,e:4,f:5,g:6,h:7},Sr={a:7,b:6,c:5,d:4,e:3,f:2,g:1,h:0},Cr=[7,6,5,4,3,2,1,0],wr=[0,1,2,3,4,5,6,7],ut={wP:o.jsx("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",version:"1.1",width:"45",height:"45"},{children:o.jsx("path",{d:"m 22.5,9 c -2.21,0 -4,1.79 -4,4 0,0.89 0.29,1.71 0.78,2.38 C 17.33,16.5 16,18.59 16,21 c 0,2.03 0.94,3.84 2.41,5.03 C 15.41,27.09 11,31.58 11,39.5 H 34 C 34,31.58 29.59,27.09 26.59,26.03 28.06,24.84 29,23.03 29,21 29,18.59 27.67,16.5 25.72,15.38 26.21,14.71 26.5,13.89 26.5,13 c 0,-2.21 -1.79,-4 -4,-4 z",style:{opacity:"1",fill:"#ffffff",fillOpacity:"1",fillRule:"nonzero",stroke:"#000000",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"miter",strokeMiterlimit:"4",strokeDasharray:"none",strokeOpacity:"1"}})})),wR:o.jsx("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",version:"1.1",width:"45",height:"45"},{children:o.jsxs("g",Object.assign({style:{opacity:"1",fill:"#ffffff",fillOpacity:"1",fillRule:"evenodd",stroke:"#000000",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:"4",strokeDasharray:"none",strokeOpacity:"1"}},{children:[o.jsx("path",{d:"M 9,39 L 36,39 L 36,36 L 9,36 L 9,39 z ",style:{strokeLinecap:"butt"}}),o.jsx("path",{d:"M 12,36 L 12,32 L 33,32 L 33,36 L 12,36 z ",style:{strokeLinecap:"butt"}}),o.jsx("path",{d:"M 11,14 L 11,9 L 15,9 L 15,11 L 20,11 L 20,9 L 25,9 L 25,11 L 30,11 L 30,9 L 34,9 L 34,14",style:{strokeLinecap:"butt"}}),o.jsx("path",{d:"M 34,14 L 31,17 L 14,17 L 11,14"}),o.jsx("path",{d:"M 31,17 L 31,29.5 L 14,29.5 L 14,17",style:{strokeLinecap:"butt",strokeLinejoin:"miter"}}),o.jsx("path",{d:"M 31,29.5 L 32.5,32 L 12.5,32 L 14,29.5"}),o.jsx("path",{d:"M 11,14 L 34,14",style:{fill:"none",stroke:"#000000",strokeLinejoin:"miter"}})]}))})),wN:o.jsx("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",version:"1.1",width:"45",height:"45"},{children:o.jsxs("g",Object.assign({style:{opacity:"1",fill:"none",fillOpacity:"1",fillRule:"evenodd",stroke:"#000000",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:"4",strokeDasharray:"none",strokeOpacity:"1"}},{children:[o.jsx("path",{d:"M 22,10 C 32.5,11 38.5,18 38,39 L 15,39 C 15,30 25,32.5 23,18",style:{fill:"#ffffff",stroke:"#000000"}}),o.jsx("path",{d:"M 24,18 C 24.38,20.91 18.45,25.37 16,27 C 13,29 13.18,31.34 11,31 C 9.958,30.06 12.41,27.96 11,28 C 10,28 11.19,29.23 10,30 C 9,30 5.997,31 6,26 C 6,24 12,14 12,14 C 12,14 13.89,12.1 14,10.5 C 13.27,9.506 13.5,8.5 13.5,7.5 C 14.5,6.5 16.5,10 16.5,10 L 18.5,10 C 18.5,10 19.28,8.008 21,7 C 22,7 22,10 22,10",style:{fill:"#ffffff",stroke:"#000000"}}),o.jsx("path",{d:"M 9.5 25.5 A 0.5 0.5 0 1 1 8.5,25.5 A 0.5 0.5 0 1 1 9.5 25.5 z",style:{fill:"#000000",stroke:"#000000"}}),o.jsx("path",{d:"M 15 15.5 A 0.5 1.5 0 1 1  14,15.5 A 0.5 1.5 0 1 1  15 15.5 z",transform:"matrix(0.866,0.5,-0.5,0.866,9.693,-5.173)",style:{fill:"#000000",stroke:"#000000"}})]}))})),wB:o.jsx("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",version:"1.1",width:"45",height:"45"},{children:o.jsxs("g",Object.assign({style:{opacity:"1",fill:"none",fillRule:"evenodd",fillOpacity:"1",stroke:"#000000",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:"4",strokeDasharray:"none",strokeOpacity:"1"}},{children:[o.jsxs("g",Object.assign({style:{fill:"#ffffff",stroke:"#000000",strokeLinecap:"butt"}},{children:[o.jsx("path",{d:"M 9,36 C 12.39,35.03 19.11,36.43 22.5,34 C 25.89,36.43 32.61,35.03 36,36 C 36,36 37.65,36.54 39,38 C 38.32,38.97 37.35,38.99 36,38.5 C 32.61,37.53 25.89,38.96 22.5,37.5 C 19.11,38.96 12.39,37.53 9,38.5 C 7.65,38.99 6.68,38.97 6,38 C 7.35,36.54 9,36 9,36 z"}),o.jsx("path",{d:"M 15,32 C 17.5,34.5 27.5,34.5 30,32 C 30.5,30.5 30,30 30,30 C 30,27.5 27.5,26 27.5,26 C 33,24.5 33.5,14.5 22.5,10.5 C 11.5,14.5 12,24.5 17.5,26 C 17.5,26 15,27.5 15,30 C 15,30 14.5,30.5 15,32 z"}),o.jsx("path",{d:"M 25 8 A 2.5 2.5 0 1 1  20,8 A 2.5 2.5 0 1 1  25 8 z"})]})),o.jsx("path",{d:"M 17.5,26 L 27.5,26 M 15,30 L 30,30 M 22.5,15.5 L 22.5,20.5 M 20,18 L 25,18",style:{fill:"none",stroke:"#000000",strokeLinejoin:"miter"}})]}))})),wQ:o.jsx("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",version:"1.1",width:"45",height:"45"},{children:o.jsxs("g",Object.assign({style:{fill:"#ffffff",stroke:"#000000",strokeWidth:"1.5",strokeLinejoin:"round"}},{children:[o.jsx("path",{d:"M 9,26 C 17.5,24.5 30,24.5 36,26 L 38.5,13.5 L 31,25 L 30.7,10.9 L 25.5,24.5 L 22.5,10 L 19.5,24.5 L 14.3,10.9 L 14,25 L 6.5,13.5 L 9,26 z"}),o.jsx("path",{d:"M 9,26 C 9,28 10.5,28 11.5,30 C 12.5,31.5 12.5,31 12,33.5 C 10.5,34.5 11,36 11,36 C 9.5,37.5 11,38.5 11,38.5 C 17.5,39.5 27.5,39.5 34,38.5 C 34,38.5 35.5,37.5 34,36 C 34,36 34.5,34.5 33,33.5 C 32.5,31 32.5,31.5 33.5,30 C 34.5,28 36,28 36,26 C 27.5,24.5 17.5,24.5 9,26 z"}),o.jsx("path",{d:"M 11.5,30 C 15,29 30,29 33.5,30",style:{fill:"none"}}),o.jsx("path",{d:"M 12,33.5 C 18,32.5 27,32.5 33,33.5",style:{fill:"none"}}),o.jsx("circle",{cx:"6",cy:"12",r:"2"}),o.jsx("circle",{cx:"14",cy:"9",r:"2"}),o.jsx("circle",{cx:"22.5",cy:"8",r:"2"}),o.jsx("circle",{cx:"31",cy:"9",r:"2"}),o.jsx("circle",{cx:"39",cy:"12",r:"2"})]}))})),wK:o.jsx("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",version:"1.1",width:"45",height:"45"},{children:o.jsxs("g",Object.assign({style:{fill:"none",fillOpacity:"1",fillRule:"evenodd",stroke:"#000000",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:"4",strokeDasharray:"none",strokeOpacity:"1"}},{children:[o.jsx("path",{d:"M 22.5,11.63 L 22.5,6",style:{fill:"none",stroke:"#000000",strokeLinejoin:"miter"}}),o.jsx("path",{d:"M 20,8 L 25,8",style:{fill:"none",stroke:"#000000",strokeLinejoin:"miter"}}),o.jsx("path",{d:"M 22.5,25 C 22.5,25 27,17.5 25.5,14.5 C 25.5,14.5 24.5,12 22.5,12 C 20.5,12 19.5,14.5 19.5,14.5 C 18,17.5 22.5,25 22.5,25",style:{fill:"#ffffff",stroke:"#000000",strokeLinecap:"butt",strokeLinejoin:"miter"}}),o.jsx("path",{d:"M 12.5,37 C 18,40.5 27,40.5 32.5,37 L 32.5,30 C 32.5,30 41.5,25.5 38.5,19.5 C 34.5,13 25,16 22.5,23.5 L 22.5,27 L 22.5,23.5 C 20,16 10.5,13 6.5,19.5 C 3.5,25.5 12.5,30 12.5,30 L 12.5,37",style:{fill:"#ffffff",stroke:"#000000"}}),o.jsx("path",{d:"M 12.5,30 C 18,27 27,27 32.5,30",style:{fill:"none",stroke:"#000000"}}),o.jsx("path",{d:"M 12.5,33.5 C 18,30.5 27,30.5 32.5,33.5",style:{fill:"none",stroke:"#000000"}}),o.jsx("path",{d:"M 12.5,37 C 18,34 27,34 32.5,37",style:{fill:"none",stroke:"#000000"}})]}))})),bP:o.jsx("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",version:"1.1",width:"45",height:"45"},{children:o.jsx("path",{d:"m 22.5,9 c -2.21,0 -4,1.79 -4,4 0,0.89 0.29,1.71 0.78,2.38 C 17.33,16.5 16,18.59 16,21 c 0,2.03 0.94,3.84 2.41,5.03 C 15.41,27.09 11,31.58 11,39.5 H 34 C 34,31.58 29.59,27.09 26.59,26.03 28.06,24.84 29,23.03 29,21 29,18.59 27.67,16.5 25.72,15.38 26.21,14.71 26.5,13.89 26.5,13 c 0,-2.21 -1.79,-4 -4,-4 z",style:{opacity:"1",fill:"#000000",fillOpacity:"1",fillRule:"nonzero",stroke:"#000000",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"miter",strokeMiterlimit:"4",strokeDasharray:"none",strokeOpacity:"1"}})})),bR:o.jsx("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",version:"1.1",width:"45",height:"45"},{children:o.jsxs("g",Object.assign({style:{opacity:"1",fill:"#000000",fillOpacity:"1",fillRule:"evenodd",stroke:"#000000",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:"4",strokeDasharray:"none",strokeOpacity:"1"}},{children:[o.jsx("path",{d:"M 9,39 L 36,39 L 36,36 L 9,36 L 9,39 z ",style:{strokeLinecap:"butt"}}),o.jsx("path",{d:"M 12.5,32 L 14,29.5 L 31,29.5 L 32.5,32 L 12.5,32 z ",style:{strokeLinecap:"butt"}}),o.jsx("path",{d:"M 12,36 L 12,32 L 33,32 L 33,36 L 12,36 z ",style:{strokeLinecap:"butt"}}),o.jsx("path",{d:"M 14,29.5 L 14,16.5 L 31,16.5 L 31,29.5 L 14,29.5 z ",style:{strokeLinecap:"butt",strokeLinejoin:"miter"}}),o.jsx("path",{d:"M 14,16.5 L 11,14 L 34,14 L 31,16.5 L 14,16.5 z ",style:{strokeLinecap:"butt"}}),o.jsx("path",{d:"M 11,14 L 11,9 L 15,9 L 15,11 L 20,11 L 20,9 L 25,9 L 25,11 L 30,11 L 30,9 L 34,9 L 34,14 L 11,14 z ",style:{strokeLinecap:"butt"}}),o.jsx("path",{d:"M 12,35.5 L 33,35.5 L 33,35.5",style:{fill:"none",stroke:"#ffffff",strokeWidth:"1",strokeLinejoin:"miter"}}),o.jsx("path",{d:"M 13,31.5 L 32,31.5",style:{fill:"none",stroke:"#ffffff",strokeWidth:"1",strokeLinejoin:"miter"}}),o.jsx("path",{d:"M 14,29.5 L 31,29.5",style:{fill:"none",stroke:"#ffffff",strokeWidth:"1",strokeLinejoin:"miter"}}),o.jsx("path",{d:"M 14,16.5 L 31,16.5",style:{fill:"none",stroke:"#ffffff",strokeWidth:"1",strokeLinejoin:"miter"}}),o.jsx("path",{d:"M 11,14 L 34,14",style:{fill:"none",stroke:"#ffffff",strokeWidth:"1",strokeLinejoin:"miter"}})]}))})),bN:o.jsx("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",version:"1.1",width:"45",height:"45"},{children:o.jsxs("g",Object.assign({style:{opacity:"1",fill:"none",fillOpacity:"1",fillRule:"evenodd",stroke:"#000000",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:"4",strokeDasharray:"none",strokeOpacity:"1"}},{children:[o.jsx("path",{d:"M 22,10 C 32.5,11 38.5,18 38,39 L 15,39 C 15,30 25,32.5 23,18",style:{fill:"#000000",stroke:"#000000"}}),o.jsx("path",{d:"M 24,18 C 24.38,20.91 18.45,25.37 16,27 C 13,29 13.18,31.34 11,31 C 9.958,30.06 12.41,27.96 11,28 C 10,28 11.19,29.23 10,30 C 9,30 5.997,31 6,26 C 6,24 12,14 12,14 C 12,14 13.89,12.1 14,10.5 C 13.27,9.506 13.5,8.5 13.5,7.5 C 14.5,6.5 16.5,10 16.5,10 L 18.5,10 C 18.5,10 19.28,8.008 21,7 C 22,7 22,10 22,10",style:{fill:"#000000",stroke:"#000000"}}),o.jsx("path",{d:"M 9.5 25.5 A 0.5 0.5 0 1 1 8.5,25.5 A 0.5 0.5 0 1 1 9.5 25.5 z",style:{fill:"#ffffff",stroke:"#ffffff"}}),o.jsx("path",{d:"M 15 15.5 A 0.5 1.5 0 1 1  14,15.5 A 0.5 1.5 0 1 1  15 15.5 z",transform:"matrix(0.866,0.5,-0.5,0.866,9.693,-5.173)",style:{fill:"#ffffff",stroke:"#ffffff"}}),o.jsx("path",{d:"M 24.55,10.4 L 24.1,11.85 L 24.6,12 C 27.75,13 30.25,14.49 32.5,18.75 C 34.75,23.01 35.75,29.06 35.25,39 L 35.2,39.5 L 37.45,39.5 L 37.5,39 C 38,28.94 36.62,22.15 34.25,17.66 C 31.88,13.17 28.46,11.02 25.06,10.5 L 24.55,10.4 z ",style:{fill:"#ffffff",stroke:"none"}})]}))})),bB:o.jsx("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",version:"1.1",width:"45",height:"45"},{children:o.jsxs("g",Object.assign({style:{opacity:"1",fill:"none",fillRule:"evenodd",fillOpacity:"1",stroke:"#000000",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:"4",strokeDasharray:"none",strokeOpacity:"1"}},{children:[o.jsxs("g",Object.assign({style:{fill:"#000000",stroke:"#000000",strokeLinecap:"butt"}},{children:[o.jsx("path",{d:"M 9,36 C 12.39,35.03 19.11,36.43 22.5,34 C 25.89,36.43 32.61,35.03 36,36 C 36,36 37.65,36.54 39,38 C 38.32,38.97 37.35,38.99 36,38.5 C 32.61,37.53 25.89,38.96 22.5,37.5 C 19.11,38.96 12.39,37.53 9,38.5 C 7.65,38.99 6.68,38.97 6,38 C 7.35,36.54 9,36 9,36 z"}),o.jsx("path",{d:"M 15,32 C 17.5,34.5 27.5,34.5 30,32 C 30.5,30.5 30,30 30,30 C 30,27.5 27.5,26 27.5,26 C 33,24.5 33.5,14.5 22.5,10.5 C 11.5,14.5 12,24.5 17.5,26 C 17.5,26 15,27.5 15,30 C 15,30 14.5,30.5 15,32 z"}),o.jsx("path",{d:"M 25 8 A 2.5 2.5 0 1 1  20,8 A 2.5 2.5 0 1 1  25 8 z"})]})),o.jsx("path",{d:"M 17.5,26 L 27.5,26 M 15,30 L 30,30 M 22.5,15.5 L 22.5,20.5 M 20,18 L 25,18",style:{fill:"none",stroke:"#ffffff",strokeLinejoin:"miter"}})]}))})),bQ:o.jsx("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",version:"1.1",width:"45",height:"45"},{children:o.jsxs("g",Object.assign({style:{fill:"#000000",stroke:"#000000",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}},{children:[o.jsx("path",{d:"M 9,26 C 17.5,24.5 30,24.5 36,26 L 38.5,13.5 L 31,25 L 30.7,10.9 L 25.5,24.5 L 22.5,10 L 19.5,24.5 L 14.3,10.9 L 14,25 L 6.5,13.5 L 9,26 z",style:{strokeLinecap:"butt",fill:"#000000"}}),o.jsx("path",{d:"m 9,26 c 0,2 1.5,2 2.5,4 1,1.5 1,1 0.5,3.5 -1.5,1 -1,2.5 -1,2.5 -1.5,1.5 0,2.5 0,2.5 6.5,1 16.5,1 23,0 0,0 1.5,-1 0,-2.5 0,0 0.5,-1.5 -1,-2.5 -0.5,-2.5 -0.5,-2 0.5,-3.5 1,-2 2.5,-2 2.5,-4 -8.5,-1.5 -18.5,-1.5 -27,0 z"}),o.jsx("path",{d:"M 11.5,30 C 15,29 30,29 33.5,30"}),o.jsx("path",{d:"m 12,33.5 c 6,-1 15,-1 21,0"}),o.jsx("circle",{cx:"6",cy:"12",r:"2"}),o.jsx("circle",{cx:"14",cy:"9",r:"2"}),o.jsx("circle",{cx:"22.5",cy:"8",r:"2"}),o.jsx("circle",{cx:"31",cy:"9",r:"2"}),o.jsx("circle",{cx:"39",cy:"12",r:"2"}),o.jsx("path",{d:"M 11,38.5 A 35,35 1 0 0 34,38.5",style:{fill:"none",stroke:"#000000",strokeLinecap:"butt"}}),o.jsxs("g",Object.assign({style:{fill:"none",stroke:"#ffffff"}},{children:[o.jsx("path",{d:"M 11,29 A 35,35 1 0 1 34,29"}),o.jsx("path",{d:"M 12.5,31.5 L 32.5,31.5"}),o.jsx("path",{d:"M 11.5,34.5 A 35,35 1 0 0 33.5,34.5"}),o.jsx("path",{d:"M 10.5,37.5 A 35,35 1 0 0 34.5,37.5"})]}))]}))})),bK:o.jsx("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",version:"1.1",width:"45",height:"45"},{children:o.jsxs("g",Object.assign({style:{fill:"none",fillOpacity:"1",fillRule:"evenodd",stroke:"#000000",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:"4",strokeDasharray:"none",strokeOpacity:"1"}},{children:[o.jsx("path",{d:"M 22.5,11.63 L 22.5,6",style:{fill:"none",stroke:"#000000",strokeLinejoin:"miter"},id:"path6570"}),o.jsx("path",{d:"M 22.5,25 C 22.5,25 27,17.5 25.5,14.5 C 25.5,14.5 24.5,12 22.5,12 C 20.5,12 19.5,14.5 19.5,14.5 C 18,17.5 22.5,25 22.5,25",style:{fill:"#000000",fillOpacity:"1",strokeLinecap:"butt",strokeLinejoin:"miter"}}),o.jsx("path",{d:"M 12.5,37 C 18,40.5 27,40.5 32.5,37 L 32.5,30 C 32.5,30 41.5,25.5 38.5,19.5 C 34.5,13 25,16 22.5,23.5 L 22.5,27 L 22.5,23.5 C 20,16 10.5,13 6.5,19.5 C 3.5,25.5 12.5,30 12.5,30 L 12.5,37",style:{fill:"#000000",stroke:"#000000"}}),o.jsx("path",{d:"M 20,8 L 25,8",style:{fill:"none",stroke:"#000000",strokeLinejoin:"miter"}}),o.jsx("path",{d:"M 32,29.5 C 32,29.5 40.5,25.5 38.03,19.85 C 34.15,14 25,18 22.5,24.5 L 22.5,26.6 L 22.5,24.5 C 20,18 10.85,14 6.97,19.85 C 4.5,25.5 13,29.5 13,29.5",style:{fill:"none",stroke:"#ffffff"}}),o.jsx("path",{d:"M 12.5,30 C 18,27 27,27 32.5,30 M 12.5,33.5 C 18,30.5 27,30.5 32.5,33.5 M 12.5,37 C 18,34 27,34 32.5,37",style:{fill:"none",stroke:"#ffffff"}})]}))}))};function Ye(t,e,r){const n=e/8,s=t==="white"?Dr:Sr,i=t==="white"?Cr:wr,a=s[r[0]]*n+n/2,c=i[parseInt(r[1],10)-1]*n+n/2;return{x:a,y:c}}function lt(t){let e=!1;return Object.keys(Oe).forEach(r=>{t[r]!==Oe[r]&&(e=!0)}),Object.keys(t).forEach(r=>{Oe[r]!==t[r]&&(e=!0)}),e}function Tr(t,e){const r={removed:{},added:{}};return Object.keys(t).forEach(n=>{e[n]!==t[n]&&(r.removed[n]=t[n])}),Object.keys(e).forEach(n=>{t[n]!==e[n]&&(r.added[n]=e[n])}),r}function dt(t){return t==="start"?Oe:typeof t=="string"?xr(t):t}function xr(t){if(!Er(t))return{};t=t.replace(/ .+$/,"");const e=t.split("/"),r={};let n=8;for(let s=0;s<8;s++){const i=e[s].split("");let a=0;for(let c=0;c<i.length;c++)if(i[c].search(/[1-8]/)!==-1){const u=parseInt(i[c],10);a=a+u}else{const u=le[a]+n;r[u]=Ir(i[c]),a=a+1}n=n-1}return r}function Er(t){t=t.replace(/ .+$/,""),t=jr(t);const e=t.split("/");if(e.length!==8)return!1;for(let r=0;r<8;r++)if(e[r].length!==8||e[r].search(/[^kqrnbpKQRNBP1]/)!==-1)return!1;return!0}function jr(t){return t.replace(/8/g,"11111111").replace(/7/g,"1111111").replace(/6/g,"111111").replace(/5/g,"11111").replace(/4/g,"1111").replace(/3/g,"111").replace(/2/g,"11")}function Ir(t){return t.toLowerCase()===t?"b"+t.toUpperCase():"w"+t.toUpperCase()}const Lr=(t,e=!0,r,n)=>{const[s,i]=l.useState([]),[a,c]=l.useState([]),[u,h]=l.useState();l.useEffect(()=>{Array.isArray(t)&&(v(),i(t==null?void 0:t.filter(f=>f[0]!==f[1])))},[t]),l.useEffect(()=>{r==null||r(a)},[a]);function v(){c([]),h(void 0)}const m=(f,g)=>{e&&h([f,g,n])},p=[...a,...s];return{arrows:p,newArrow:u,clearArrows:v,drawNewArrow:m,setArrows:c,onArrowDrawEnd:(f,g)=>{if(f===g||!e)return;let y;const D=[f,g,n];p.every(([S,T])=>!(S===f&&T===g))?y=[...a,D]:y=a.filter(([S,T])=>!(S===f&&T===g)),h(void 0),c(y)}}},Lt=l.createContext({}),B=()=>l.useContext(Lt),kr=l.forwardRef(({allowDragOutsideBoard:t=!0,animationDuration:e=300,areArrowsAllowed:r=!0,arePiecesDraggable:n=!0,arePremovesAllowed:s=!1,autoPromoteToQueen:i=!1,boardOrientation:a="white",boardWidth:c,children:u,clearPremovesOnRightClick:h=!0,customArrows:v,customArrowColor:m="rgb(255,170,0)",customBoardStyle:p,customNotationStyle:d,customDarkSquareStyle:f={backgroundColor:"#B58863"},customDropSquareStyle:g={boxShadow:"inset 0 0 1px 6px rgba(255,255,255,0.75)"},customLightSquareStyle:y={backgroundColor:"#F0D9B5"},customPieces:D,customPremoveDarkSquareStyle:O={backgroundColor:"#A42323"},customPremoveLightSquareStyle:S={backgroundColor:"#BD2828"},customSquare:T="div",customSquareStyles:I,dropOffBoardAction:k="snapback",id:G=0,isDraggablePiece:X=()=>!0,getPositionObject:$=()=>{},onArrowsChange:re=()=>{},onDragOverSquare:J=()=>{},onMouseOutSquare:j=()=>{},onMouseOverSquare:M=()=>{},onPieceClick:Y=()=>{},onPieceDragBegin:W=()=>{},onPieceDragEnd:z=()=>{},onPieceDrop:H=()=>!0,onPieceDropOffBoard:ne=()=>{},onPromotionCheck:je=(L,P,fe)=>(fe==="wP"&&L[1]==="7"&&P[1]==="8"||fe==="bP"&&L[1]==="2"&&P[1]==="1")&&Math.abs(L.charCodeAt(0)-P.charCodeAt(0))<=1,onPromotionPieceSelect:Ie=()=>!0,onSparePieceDrop:de=()=>!0,onSquareClick:Le=()=>{},onSquareRightClick:ke=()=>{},position:se="start",promotionDialogVariant:Me="default",promotionToSquare:ie=null,showBoardNotation:C=!0,showPromotionDialog:F=!1,snapToCursor:Z=!0},oe)=>{const[L,P]=l.useState(dt(se)),[fe,Jt]=l.useState({removed:{},added:{}}),[Pe,ee]=l.useState(void 0),[Zt,Re]=l.useState(F&&!i),[er,at]=l.useState(null),[tr,Ne]=l.useState(ie),[ct,Ae]=l.useState([]),U=l.useRef(ct),[_e,he]=l.useState(),[rr,nr]=l.useState(Object.assign(Object.assign({},ut),D)),[sr,ge]=l.useState(!1),[He,ir]=l.useState(),[pe,ve]=l.useState(!1),[or,ar]=l.useState(null);l.useImperativeHandle(oe,()=>({clearPremoves(w=!0){me(w)}})),l.useEffect(()=>{nr(Object.assign(Object.assign({},ut),D))},[D]),l.useEffect(()=>{Re(F),Ne(ie)},[ie,F]),l.useEffect(()=>{var w,x,R;Fe();const E=dt(se),q=Tr(L,E),_=((w=Object.keys(q.added))===null||w===void 0?void 0:w.length)<=2?(R=(x=Object.entries(q.added))===null||x===void 0?void 0:x[0])===null||R===void 0?void 0:R[1][0]:void 0;if(pe)P(E),ve(!1),s&&ze(_),He&&clearTimeout(He);else if(sr)P(E),ve(!1),s&&ze(_);else{lt(E)&&Pe!==void 0?ee(_):lt(E)?ee(void 0):ee("b"),Jt(q),ve(!0);const br=setTimeout(()=>{P(E),ve(!1),s&&ze(_)},e);ir(br)}return ge(!1),$(E),We(),()=>{clearTimeout(He)}},[se]);const{arrows:cr,newArrow:ur,clearArrows:We,drawNewArrow:lr,onArrowDrawEnd:dr}=Lr(v,r,re,m);function fr(w,x,R,E){if(w===x)return;if(We(),s&&pe||s&&(Pe===R[0]||U.current.filter(_=>_.piece[0]===R[0]).length>0)){const _=[...U.current];_.push({sourceSq:w,targetSq:x,piece:R}),U.current=_,Ae([..._]),Fe();return}if(!s&&pe)return;const q=Object.assign({},L);ge(!!E),ee(R[0]),H.length?H(w,x,R)||(me(),ge(!1)):(delete q[w],q[x]=R,P(q)),Fe(),$(q)}function hr(w){const x=Object.assign({},L);delete x[w],P(x),$(x)}function ze(w){if(U.current.length===0)return;const x=U.current[0];if(x.piece[0]!==void 0&&x.piece[0]!==w&&H.length)if(ee(x.piece[0]),ge(!0),H(x.sourceSq,x.targetSq,x.piece)){const E=[...U.current];E.shift(),U.current=E,Ae([...E])}else me()}function gr(w,x){if(!de(w,x))return;const E=Object.assign({},L);E[x]=w,P(E),$(E)}function me(w=!0){w&&ee(void 0),U.current=[],Ae([])}function Fe(){at(null),Ne(null),Re(!1)}function pr(w){he(w)}function vr(w){if(_e){if(_e===w){he(void 0),h&&me(!1),ke(w);return}}else he(void 0)}function mr(){he(void 0)}const yr={allowDragOutsideBoard:t,animationDuration:e,arePiecesDraggable:n,arePremovesAllowed:s,arrows:cr,autoPromoteToQueen:i,boardOrientation:a,boardWidth:c,chessPieces:rr,clearArrows:We,clearCurrentRightClickDown:mr,currentPosition:L,currentRightClickDown:_e,customArrowColor:m,customBoardStyle:p,customDarkSquareStyle:f,customDropSquareStyle:g,customLightSquareStyle:y,customNotationStyle:d,customPremoveDarkSquareStyle:O,customPremoveLightSquareStyle:S,customSquare:T,customSquareStyles:I,deletePieceFromSquare:hr,drawNewArrow:lr,dropOffBoardAction:k,handleSetPosition:fr,handleSparePieceDrop:gr,id:G,isDraggablePiece:X,isWaitingForAnimation:pe,lastPieceColour:Pe,lastSquareDraggedOver:or,newArrow:ur,onArrowDrawEnd:dr,onDragOverSquare:J,onMouseOutSquare:j,onMouseOverSquare:M,onPieceClick:Y,onPieceDragBegin:W,onPieceDragEnd:z,onPieceDrop:H,onPieceDropOffBoard:ne,onPromotionCheck:je,onPromotionPieceSelect:Ie,onRightClickDown:pr,onRightClickUp:vr,onSparePieceDrop:de,onSquareClick:Le,positionDifferences:fe,premoves:ct,promoteFromSquare:er,promoteToSquare:tr,promotionDialogVariant:Me,setLastSquareDraggedOver:ar,setPromoteFromSquare:at,setPromoteToSquare:Ne,setShowPromoteDialog:Re,showBoardNotation:C,showPromoteDialog:Zt,snapToCursor:Z};return o.jsx(Lt.Provider,Object.assign({value:yr},{children:u}))});function Mr({row:t,col:e}){const{boardOrientation:r,boardWidth:n,customDarkSquareStyle:s,customLightSquareStyle:i,customNotationStyle:a}=B(),c=i.backgroundColor,u=s.backgroundColor,h=e===0,v=t===7,m=h&&v;function p(){return r==="white"?8-t:t+1}function d(){return r==="black"?le[7-e]:le[e]}function f(){return o.jsxs(o.Fragment,{children:[o.jsx("div",Object.assign({style:Object.assign(Object.assign({zIndex:3,position:"absolute"},{color:c}),ht(n,a))},{children:p()})),o.jsx("div",Object.assign({style:Object.assign(Object.assign({zIndex:3,position:"absolute"},{color:c}),ft(n,a))},{children:d()}))]})}function g(){return o.jsx("div",Object.assign({style:Object.assign(Object.assign({userSelect:"none",zIndex:3,position:"absolute"},{color:e%2!==0?u:c}),ft(n,a))},{children:d()}))}function y(){return o.jsx("div",Object.assign({style:Object.assign(Object.assign({userSelect:"none",zIndex:3,position:"absolute"},r==="black"?{color:t%2===0?u:c}:{color:t%2===0?u:c}),ht(n,a))},{children:p()}))}return m?f():v?g():h?y():null}const ft=(t,e)=>Object.assign({alignSelf:"flex-end",paddingLeft:t/8-t/48,fontSize:t/48},e),ht=(t,e)=>Object.assign({alignSelf:"flex-start",paddingRight:t/8-t/48,fontSize:t/48},e),kt=l.createContext({dragDropManager:void 0});function N(t){return"Minified Redux error #"+t+"; visit https://redux.js.org/Errors?code="+t+" for the full message or use the non-minified dev environment for full errors. "}var gt=function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"}(),Be=function(){return Math.random().toString(36).substring(7).split("").join(".")},pt={INIT:"@@redux/INIT"+Be(),REPLACE:"@@redux/REPLACE"+Be(),PROBE_UNKNOWN_ACTION:function(){return"@@redux/PROBE_UNKNOWN_ACTION"+Be()}};function Pr(t){if(typeof t!="object"||t===null)return!1;for(var e=t;Object.getPrototypeOf(e)!==null;)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(t)===e}function Mt(t,e,r){var n;if(typeof e=="function"&&typeof r=="function"||typeof r=="function"&&typeof arguments[3]=="function")throw new Error(N(0));if(typeof e=="function"&&typeof r>"u"&&(r=e,e=void 0),typeof r<"u"){if(typeof r!="function")throw new Error(N(1));return r(Mt)(t,e)}if(typeof t!="function")throw new Error(N(2));var s=t,i=e,a=[],c=a,u=!1;function h(){c===a&&(c=a.slice())}function v(){if(u)throw new Error(N(3));return i}function m(g){if(typeof g!="function")throw new Error(N(4));if(u)throw new Error(N(5));var y=!0;return h(),c.push(g),function(){if(y){if(u)throw new Error(N(6));y=!1,h();var O=c.indexOf(g);c.splice(O,1),a=null}}}function p(g){if(!Pr(g))throw new Error(N(7));if(typeof g.type>"u")throw new Error(N(8));if(u)throw new Error(N(9));try{u=!0,i=s(i,g)}finally{u=!1}for(var y=a=c,D=0;D<y.length;D++){var O=y[D];O()}return g}function d(g){if(typeof g!="function")throw new Error(N(10));s=g,p({type:pt.REPLACE})}function f(){var g,y=m;return g={subscribe:function(O){if(typeof O!="object"||O===null)throw new Error(N(11));function S(){O.next&&O.next(v())}S();var T=y(S);return{unsubscribe:T}}},g[gt]=function(){return this},g}return p({type:pt.INIT}),n={dispatch:p,subscribe:m,getState:v,replaceReducer:d},n[gt]=f,n}function b(t,e,...r){if(Rr()&&e===void 0)throw new Error("invariant requires an error message argument");if(!t){let n;if(e===void 0)n=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{let s=0;n=new Error(e.replace(/%s/g,function(){return r[s++]})),n.name="Invariant Violation"}throw n.framesToPop=1,n}}function Rr(){return typeof process<"u"&&!0}function Nr(t,e,r){return e.split(".").reduce((n,s)=>n&&n[s]?n[s]:r,t)}function Ar(t,e){return t.filter(r=>r!==e)}function Pt(t){return typeof t=="object"}function _r(t,e){const r=new Map,n=i=>{r.set(i,r.has(i)?r.get(i)+1:1)};t.forEach(n),e.forEach(n);const s=[];return r.forEach((i,a)=>{i===1&&s.push(a)}),s}function Hr(t,e){return t.filter(r=>e.indexOf(r)>-1)}const tt="dnd-core/INIT_COORDS",Ce="dnd-core/BEGIN_DRAG",rt="dnd-core/PUBLISH_DRAG_SOURCE",we="dnd-core/HOVER",Te="dnd-core/DROP",xe="dnd-core/END_DRAG";function vt(t,e){return{type:tt,payload:{sourceClientOffset:e||null,clientOffset:t||null}}}const Wr={type:tt,payload:{clientOffset:null,sourceClientOffset:null}};function zr(t){return function(r=[],n={publishSource:!0}){const{publishSource:s=!0,clientOffset:i,getSourceClientOffset:a}=n,c=t.getMonitor(),u=t.getRegistry();t.dispatch(vt(i)),Fr(r,c,u);const h=Ur(r,c);if(h==null){t.dispatch(Wr);return}let v=null;if(i){if(!a)throw new Error("getSourceClientOffset must be defined");Br(a),v=a(h)}t.dispatch(vt(i,v));const p=u.getSource(h).beginDrag(c,h);if(p==null)return;$r(p),u.pinSource(h);const d=u.getSourceType(h);return{type:Ce,payload:{itemType:d,item:p,sourceId:h,clientOffset:i||null,sourceClientOffset:v||null,isSourcePublic:!!s}}}}function Fr(t,e,r){b(!e.isDragging(),"Cannot call beginDrag while dragging."),t.forEach(function(n){b(r.getSource(n),"Expected sourceIds to be registered.")})}function Br(t){b(typeof t=="function","When clientOffset is provided, getSourceClientOffset must be a function.")}function $r(t){b(Pt(t),"Item must be an object.")}function Ur(t,e){let r=null;for(let n=t.length-1;n>=0;n--)if(e.canDragSource(t[n])){r=t[n];break}return r}function qr(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Vr(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{},n=Object.keys(r);typeof Object.getOwnPropertySymbols=="function"&&(n=n.concat(Object.getOwnPropertySymbols(r).filter(function(s){return Object.getOwnPropertyDescriptor(r,s).enumerable}))),n.forEach(function(s){qr(t,s,r[s])})}return t}function Gr(t){return function(r={}){const n=t.getMonitor(),s=t.getRegistry();Xr(n),Qr(n).forEach((a,c)=>{const u=Yr(a,c,s,n),h={type:Te,payload:{dropResult:Vr({},r,u)}};t.dispatch(h)})}}function Xr(t){b(t.isDragging(),"Cannot call drop while not dragging."),b(!t.didDrop(),"Cannot call drop twice during one drag operation.")}function Yr(t,e,r,n){const s=r.getTarget(t);let i=s?s.drop(n,t):void 0;return Kr(i),typeof i>"u"&&(i=e===0?{}:n.getDropResult()),i}function Kr(t){b(typeof t>"u"||Pt(t),"Drop result must either be an object or undefined.")}function Qr(t){const e=t.getTargetIds().filter(t.canDropOnTarget,t);return e.reverse(),e}function Jr(t){return function(){const r=t.getMonitor(),n=t.getRegistry();Zr(r);const s=r.getSourceId();return s!=null&&(n.getSource(s,!0).endDrag(r,s),n.unpinSource()),{type:xe}}}function Zr(t){b(t.isDragging(),"Cannot call endDrag while not dragging.")}function Ke(t,e){return e===null?t===null:Array.isArray(t)?t.some(r=>r===e):t===e}function en(t){return function(r,{clientOffset:n}={}){tn(r);const s=r.slice(0),i=t.getMonitor(),a=t.getRegistry(),c=i.getItemType();return nn(s,a,c),rn(s,i,a),sn(s,i,a),{type:we,payload:{targetIds:s,clientOffset:n||null}}}}function tn(t){b(Array.isArray(t),"Expected targetIds to be an array.")}function rn(t,e,r){b(e.isDragging(),"Cannot call hover while not dragging."),b(!e.didDrop(),"Cannot call hover after drop.");for(let n=0;n<t.length;n++){const s=t[n];b(t.lastIndexOf(s)===n,"Expected targetIds to be unique in the passed array.");const i=r.getTarget(s);b(i,"Expected targetIds to be registered.")}}function nn(t,e,r){for(let n=t.length-1;n>=0;n--){const s=t[n],i=e.getTargetType(s);Ke(i,r)||t.splice(n,1)}}function sn(t,e,r){t.forEach(function(n){r.getTarget(n).hover(e,n)})}function on(t){return function(){if(t.getMonitor().isDragging())return{type:rt}}}function an(t){return{beginDrag:zr(t),publishDragSource:on(t),hover:en(t),drop:Gr(t),endDrag:Jr(t)}}class cn{receiveBackend(e){this.backend=e}getMonitor(){return this.monitor}getBackend(){return this.backend}getRegistry(){return this.monitor.registry}getActions(){const e=this,{dispatch:r}=this.store;function n(i){return(...a)=>{const c=i.apply(e,a);typeof c<"u"&&r(c)}}const s=an(this);return Object.keys(s).reduce((i,a)=>{const c=s[a];return i[a]=n(c),i},{})}dispatch(e){this.store.dispatch(e)}constructor(e,r){this.isSetUp=!1,this.handleRefCountChange=()=>{const n=this.store.getState().refCount>0;this.backend&&(n&&!this.isSetUp?(this.backend.setup(),this.isSetUp=!0):!n&&this.isSetUp&&(this.backend.teardown(),this.isSetUp=!1))},this.store=e,this.monitor=r,e.subscribe(this.handleRefCountChange)}}function un(t,e){return{x:t.x+e.x,y:t.y+e.y}}function Rt(t,e){return{x:t.x-e.x,y:t.y-e.y}}function ln(t){const{clientOffset:e,initialClientOffset:r,initialSourceClientOffset:n}=t;return!e||!r||!n?null:Rt(un(e,n),r)}function dn(t){const{clientOffset:e,initialClientOffset:r}=t;return!e||!r?null:Rt(e,r)}const ce=[],nt=[];ce.__IS_NONE__=!0;nt.__IS_ALL__=!0;function fn(t,e){return t===ce?!1:t===nt||typeof e>"u"?!0:Hr(e,t).length>0}class hn{subscribeToStateChange(e,r={}){const{handlerIds:n}=r;b(typeof e=="function","listener must be a function."),b(typeof n>"u"||Array.isArray(n),"handlerIds, when specified, must be an array of strings.");let s=this.store.getState().stateId;const i=()=>{const a=this.store.getState(),c=a.stateId;try{c===s||c===s+1&&!fn(a.dirtyHandlerIds,n)||e()}finally{s=c}};return this.store.subscribe(i)}subscribeToOffsetChange(e){b(typeof e=="function","listener must be a function.");let r=this.store.getState().dragOffset;const n=()=>{const s=this.store.getState().dragOffset;s!==r&&(r=s,e())};return this.store.subscribe(n)}canDragSource(e){if(!e)return!1;const r=this.registry.getSource(e);return b(r,`Expected to find a valid source. sourceId=${e}`),this.isDragging()?!1:r.canDrag(this,e)}canDropOnTarget(e){if(!e)return!1;const r=this.registry.getTarget(e);if(b(r,`Expected to find a valid target. targetId=${e}`),!this.isDragging()||this.didDrop())return!1;const n=this.registry.getTargetType(e),s=this.getItemType();return Ke(n,s)&&r.canDrop(this,e)}isDragging(){return!!this.getItemType()}isDraggingSource(e){if(!e)return!1;const r=this.registry.getSource(e,!0);if(b(r,`Expected to find a valid source. sourceId=${e}`),!this.isDragging()||!this.isSourcePublic())return!1;const n=this.registry.getSourceType(e),s=this.getItemType();return n!==s?!1:r.isDragging(this,e)}isOverTarget(e,r={shallow:!1}){if(!e)return!1;const{shallow:n}=r;if(!this.isDragging())return!1;const s=this.registry.getTargetType(e),i=this.getItemType();if(i&&!Ke(s,i))return!1;const a=this.getTargetIds();if(!a.length)return!1;const c=a.indexOf(e);return n?c===a.length-1:c>-1}getItemType(){return this.store.getState().dragOperation.itemType}getItem(){return this.store.getState().dragOperation.item}getSourceId(){return this.store.getState().dragOperation.sourceId}getTargetIds(){return this.store.getState().dragOperation.targetIds}getDropResult(){return this.store.getState().dragOperation.dropResult}didDrop(){return this.store.getState().dragOperation.didDrop}isSourcePublic(){return!!this.store.getState().dragOperation.isSourcePublic}getInitialClientOffset(){return this.store.getState().dragOffset.initialClientOffset}getInitialSourceClientOffset(){return this.store.getState().dragOffset.initialSourceClientOffset}getClientOffset(){return this.store.getState().dragOffset.clientOffset}getSourceClientOffset(){return ln(this.store.getState().dragOffset)}getDifferenceFromInitialOffset(){return dn(this.store.getState().dragOffset)}constructor(e,r){this.store=e,this.registry=r}}const mt=typeof global<"u"?global:self,Nt=mt.MutationObserver||mt.WebKitMutationObserver;function At(t){return function(){const r=setTimeout(s,0),n=setInterval(s,50);function s(){clearTimeout(r),clearInterval(n),t()}}}function gn(t){let e=1;const r=new Nt(t),n=document.createTextNode("");return r.observe(n,{characterData:!0}),function(){e=-e,n.data=e}}const pn=typeof Nt=="function"?gn:At;class vn{enqueueTask(e){const{queue:r,requestFlush:n}=this;r.length||(n(),this.flushing=!0),r[r.length]=e}constructor(){this.queue=[],this.pendingErrors=[],this.flushing=!1,this.index=0,this.capacity=1024,this.flush=()=>{const{queue:e}=this;for(;this.index<e.length;){const r=this.index;if(this.index++,e[r].call(),this.index>this.capacity){for(let n=0,s=e.length-this.index;n<s;n++)e[n]=e[n+this.index];e.length-=this.index,this.index=0}}e.length=0,this.index=0,this.flushing=!1},this.registerPendingError=e=>{this.pendingErrors.push(e),this.requestErrorThrow()},this.requestFlush=pn(this.flush),this.requestErrorThrow=At(()=>{if(this.pendingErrors.length)throw this.pendingErrors.shift()})}}class mn{call(){try{this.task&&this.task()}catch(e){this.onError(e)}finally{this.task=null,this.release(this)}}constructor(e,r){this.onError=e,this.release=r,this.task=null}}class yn{create(e){const r=this.freeTasks,n=r.length?r.pop():new mn(this.onError,s=>r[r.length]=s);return n.task=e,n}constructor(e){this.onError=e,this.freeTasks=[]}}const _t=new vn,bn=new yn(_t.registerPendingError);function On(t){_t.enqueueTask(bn.create(t))}const st="dnd-core/ADD_SOURCE",it="dnd-core/ADD_TARGET",ot="dnd-core/REMOVE_SOURCE",Ee="dnd-core/REMOVE_TARGET";function Dn(t){return{type:st,payload:{sourceId:t}}}function Sn(t){return{type:it,payload:{targetId:t}}}function Cn(t){return{type:ot,payload:{sourceId:t}}}function wn(t){return{type:Ee,payload:{targetId:t}}}function Tn(t){b(typeof t.canDrag=="function","Expected canDrag to be a function."),b(typeof t.beginDrag=="function","Expected beginDrag to be a function."),b(typeof t.endDrag=="function","Expected endDrag to be a function.")}function xn(t){b(typeof t.canDrop=="function","Expected canDrop to be a function."),b(typeof t.hover=="function","Expected hover to be a function."),b(typeof t.drop=="function","Expected beginDrag to be a function.")}function Qe(t,e){if(e&&Array.isArray(t)){t.forEach(r=>Qe(r,!1));return}b(typeof t=="string"||typeof t=="symbol",e?"Type can only be a string, a symbol, or an array of either.":"Type can only be a string or a symbol.")}var A;(function(t){t.SOURCE="SOURCE",t.TARGET="TARGET"})(A||(A={}));let En=0;function jn(){return En++}function In(t){const e=jn().toString();switch(t){case A.SOURCE:return`S${e}`;case A.TARGET:return`T${e}`;default:throw new Error(`Unknown Handler Role: ${t}`)}}function yt(t){switch(t[0]){case"S":return A.SOURCE;case"T":return A.TARGET;default:throw new Error(`Cannot parse handler ID: ${t}`)}}function bt(t,e){const r=t.entries();let n=!1;do{const{done:s,value:[,i]}=r.next();if(i===e)return!0;n=!!s}while(!n);return!1}class Ln{addSource(e,r){Qe(e),Tn(r);const n=this.addHandler(A.SOURCE,e,r);return this.store.dispatch(Dn(n)),n}addTarget(e,r){Qe(e,!0),xn(r);const n=this.addHandler(A.TARGET,e,r);return this.store.dispatch(Sn(n)),n}containsHandler(e){return bt(this.dragSources,e)||bt(this.dropTargets,e)}getSource(e,r=!1){return b(this.isSourceId(e),"Expected a valid source ID."),r&&e===this.pinnedSourceId?this.pinnedSource:this.dragSources.get(e)}getTarget(e){return b(this.isTargetId(e),"Expected a valid target ID."),this.dropTargets.get(e)}getSourceType(e){return b(this.isSourceId(e),"Expected a valid source ID."),this.types.get(e)}getTargetType(e){return b(this.isTargetId(e),"Expected a valid target ID."),this.types.get(e)}isSourceId(e){return yt(e)===A.SOURCE}isTargetId(e){return yt(e)===A.TARGET}removeSource(e){b(this.getSource(e),"Expected an existing source."),this.store.dispatch(Cn(e)),On(()=>{this.dragSources.delete(e),this.types.delete(e)})}removeTarget(e){b(this.getTarget(e),"Expected an existing target."),this.store.dispatch(wn(e)),this.dropTargets.delete(e),this.types.delete(e)}pinSource(e){const r=this.getSource(e);b(r,"Expected an existing source."),this.pinnedSourceId=e,this.pinnedSource=r}unpinSource(){b(this.pinnedSource,"No source is pinned at the time."),this.pinnedSourceId=null,this.pinnedSource=null}addHandler(e,r,n){const s=In(e);return this.types.set(s,r),e===A.SOURCE?this.dragSources.set(s,n):e===A.TARGET&&this.dropTargets.set(s,n),s}constructor(e){this.types=new Map,this.dragSources=new Map,this.dropTargets=new Map,this.pinnedSourceId=null,this.pinnedSource=null,this.store=e}}const kn=(t,e)=>t===e;function Mn(t,e){return!t&&!e?!0:!t||!e?!1:t.x===e.x&&t.y===e.y}function Pn(t,e,r=kn){if(t.length!==e.length)return!1;for(let n=0;n<t.length;++n)if(!r(t[n],e[n]))return!1;return!0}function Rn(t=ce,e){switch(e.type){case we:break;case st:case it:case Ee:case ot:return ce;case Ce:case rt:case xe:case Te:default:return nt}const{targetIds:r=[],prevTargetIds:n=[]}=e.payload,s=_r(r,n);if(!(s.length>0||!Pn(r,n)))return ce;const a=n[n.length-1],c=r[r.length-1];return a!==c&&(a&&s.push(a),c&&s.push(c)),s}function Nn(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function An(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{},n=Object.keys(r);typeof Object.getOwnPropertySymbols=="function"&&(n=n.concat(Object.getOwnPropertySymbols(r).filter(function(s){return Object.getOwnPropertyDescriptor(r,s).enumerable}))),n.forEach(function(s){Nn(t,s,r[s])})}return t}const Ot={initialSourceClientOffset:null,initialClientOffset:null,clientOffset:null};function _n(t=Ot,e){const{payload:r}=e;switch(e.type){case tt:case Ce:return{initialSourceClientOffset:r.sourceClientOffset,initialClientOffset:r.clientOffset,clientOffset:r.clientOffset};case we:return Mn(t.clientOffset,r.clientOffset)?t:An({},t,{clientOffset:r.clientOffset});case xe:case Te:return Ot;default:return t}}function Hn(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function te(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{},n=Object.keys(r);typeof Object.getOwnPropertySymbols=="function"&&(n=n.concat(Object.getOwnPropertySymbols(r).filter(function(s){return Object.getOwnPropertyDescriptor(r,s).enumerable}))),n.forEach(function(s){Hn(t,s,r[s])})}return t}const Wn={itemType:null,item:null,sourceId:null,targetIds:[],dropResult:null,didDrop:!1,isSourcePublic:null};function zn(t=Wn,e){const{payload:r}=e;switch(e.type){case Ce:return te({},t,{itemType:r.itemType,item:r.item,sourceId:r.sourceId,isSourcePublic:r.isSourcePublic,dropResult:null,didDrop:!1});case rt:return te({},t,{isSourcePublic:!0});case we:return te({},t,{targetIds:r.targetIds});case Ee:return t.targetIds.indexOf(r.targetId)===-1?t:te({},t,{targetIds:Ar(t.targetIds,r.targetId)});case Te:return te({},t,{dropResult:r.dropResult,didDrop:!0,targetIds:[]});case xe:return te({},t,{itemType:null,item:null,sourceId:null,dropResult:null,didDrop:!1,isSourcePublic:null,targetIds:[]});default:return t}}function Fn(t=0,e){switch(e.type){case st:case it:return t+1;case ot:case Ee:return t-1;default:return t}}function Bn(t=0){return t+1}function $n(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Un(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{},n=Object.keys(r);typeof Object.getOwnPropertySymbols=="function"&&(n=n.concat(Object.getOwnPropertySymbols(r).filter(function(s){return Object.getOwnPropertyDescriptor(r,s).enumerable}))),n.forEach(function(s){$n(t,s,r[s])})}return t}function qn(t={},e){return{dirtyHandlerIds:Rn(t.dirtyHandlerIds,{type:e.type,payload:Un({},e.payload,{prevTargetIds:Nr(t,"dragOperation.targetIds",[])})}),dragOffset:_n(t.dragOffset,e),refCount:Fn(t.refCount,e),dragOperation:zn(t.dragOperation,e),stateId:Bn(t.stateId)}}function Vn(t,e=void 0,r={},n=!1){const s=Gn(n),i=new hn(s,new Ln(s)),a=new cn(s,i),c=t(a,e,r);return a.receiveBackend(c),a}function Gn(t){const e=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION__;return Mt(qn,t&&e&&e({name:"dnd-core",instanceId:"dnd-core"}))}function Xn(t,e){if(t==null)return{};var r=Yn(t,e),n,s;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(s=0;s<i.length;s++)n=i[s],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function Yn(t,e){if(t==null)return{};var r={},n=Object.keys(t),s,i;for(i=0;i<n.length;i++)s=n[i],!(e.indexOf(s)>=0)&&(r[s]=t[s]);return r}let Dt=0;const De=Symbol.for("__REACT_DND_CONTEXT_INSTANCE__");var Kn=l.memo(function(e){var{children:r}=e,n=Xn(e,["children"]);const[s,i]=Qn(n);return l.useEffect(()=>{if(i){const a=Ht();return++Dt,()=>{--Dt===0&&(a[De]=null)}}},[]),o.jsx(kt.Provider,{value:s,children:r})});function Qn(t){if("manager"in t)return[{dragDropManager:t.manager},!1];const e=Jn(t.backend,t.context,t.options,t.debugMode),r=!t.context;return[e,r]}function Jn(t,e=Ht(),r,n){const s=e;return s[De]||(s[De]={dragDropManager:Vn(t,e,r,n)}),s[De]}function Ht(){return typeof global<"u"?global:window}var Zn=function t(e,r){if(e===r)return!0;if(e&&r&&typeof e=="object"&&typeof r=="object"){if(e.constructor!==r.constructor)return!1;var n,s,i;if(Array.isArray(e)){if(n=e.length,n!=r.length)return!1;for(s=n;s--!==0;)if(!t(e[s],r[s]))return!1;return!0}if(e.constructor===RegExp)return e.source===r.source&&e.flags===r.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===r.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===r.toString();if(i=Object.keys(e),n=i.length,n!==Object.keys(r).length)return!1;for(s=n;s--!==0;)if(!Object.prototype.hasOwnProperty.call(r,i[s]))return!1;for(s=n;s--!==0;){var a=i[s];if(!t(e[a],r[a]))return!1}return!0}return e!==e&&r!==r};const K=typeof window<"u"?l.useLayoutEffect:l.useEffect;function Wt(t,e,r){const[n,s]=l.useState(()=>e(t)),i=l.useCallback(()=>{const a=e(t);Zn(n,a)||(s(a),r&&r())},[n,t,r]);return K(i),[n,i]}function es(t,e,r){const[n,s]=Wt(t,e,r);return K(function(){const a=t.getHandlerId();if(a!=null)return t.subscribeToStateChange(s,{handlerIds:[a]})},[t,s]),n}function zt(t,e,r){return es(e,t||(()=>({})),()=>r.reconnect())}function Ft(t,e){const r=[...e||[]];return e==null&&typeof t!="function"&&r.push(t),l.useMemo(()=>typeof t=="function"?t():t,r)}function ts(t){return l.useMemo(()=>t.hooks.dragSource(),[t])}function rs(t){return l.useMemo(()=>t.hooks.dragPreview(),[t])}let $e=!1,Ue=!1;class ns{receiveHandlerId(e){this.sourceId=e}getHandlerId(){return this.sourceId}canDrag(){b(!$e,"You may not call monitor.canDrag() inside your canDrag() implementation. Read more: http://react-dnd.github.io/react-dnd/docs/api/drag-source-monitor");try{return $e=!0,this.internalMonitor.canDragSource(this.sourceId)}finally{$e=!1}}isDragging(){if(!this.sourceId)return!1;b(!Ue,"You may not call monitor.isDragging() inside your isDragging() implementation. Read more: http://react-dnd.github.io/react-dnd/docs/api/drag-source-monitor");try{return Ue=!0,this.internalMonitor.isDraggingSource(this.sourceId)}finally{Ue=!1}}subscribeToStateChange(e,r){return this.internalMonitor.subscribeToStateChange(e,r)}isDraggingSource(e){return this.internalMonitor.isDraggingSource(e)}isOverTarget(e,r){return this.internalMonitor.isOverTarget(e,r)}getTargetIds(){return this.internalMonitor.getTargetIds()}isSourcePublic(){return this.internalMonitor.isSourcePublic()}getSourceId(){return this.internalMonitor.getSourceId()}subscribeToOffsetChange(e){return this.internalMonitor.subscribeToOffsetChange(e)}canDragSource(e){return this.internalMonitor.canDragSource(e)}canDropOnTarget(e){return this.internalMonitor.canDropOnTarget(e)}getItemType(){return this.internalMonitor.getItemType()}getItem(){return this.internalMonitor.getItem()}getDropResult(){return this.internalMonitor.getDropResult()}didDrop(){return this.internalMonitor.didDrop()}getInitialClientOffset(){return this.internalMonitor.getInitialClientOffset()}getInitialSourceClientOffset(){return this.internalMonitor.getInitialSourceClientOffset()}getSourceClientOffset(){return this.internalMonitor.getSourceClientOffset()}getClientOffset(){return this.internalMonitor.getClientOffset()}getDifferenceFromInitialOffset(){return this.internalMonitor.getDifferenceFromInitialOffset()}constructor(e){this.sourceId=null,this.internalMonitor=e.getMonitor()}}let qe=!1;class ss{receiveHandlerId(e){this.targetId=e}getHandlerId(){return this.targetId}subscribeToStateChange(e,r){return this.internalMonitor.subscribeToStateChange(e,r)}canDrop(){if(!this.targetId)return!1;b(!qe,"You may not call monitor.canDrop() inside your canDrop() implementation. Read more: http://react-dnd.github.io/react-dnd/docs/api/drop-target-monitor");try{return qe=!0,this.internalMonitor.canDropOnTarget(this.targetId)}finally{qe=!1}}isOver(e){return this.targetId?this.internalMonitor.isOverTarget(this.targetId,e):!1}getItemType(){return this.internalMonitor.getItemType()}getItem(){return this.internalMonitor.getItem()}getDropResult(){return this.internalMonitor.getDropResult()}didDrop(){return this.internalMonitor.didDrop()}getInitialClientOffset(){return this.internalMonitor.getInitialClientOffset()}getInitialSourceClientOffset(){return this.internalMonitor.getInitialSourceClientOffset()}getSourceClientOffset(){return this.internalMonitor.getSourceClientOffset()}getClientOffset(){return this.internalMonitor.getClientOffset()}getDifferenceFromInitialOffset(){return this.internalMonitor.getDifferenceFromInitialOffset()}constructor(e){this.targetId=null,this.internalMonitor=e.getMonitor()}}function is(t,e,r){const n=r.getRegistry(),s=n.addTarget(t,e);return[s,()=>n.removeTarget(s)]}function os(t,e,r){const n=r.getRegistry(),s=n.addSource(t,e);return[s,()=>n.removeSource(s)]}function Je(t,e,r,n){let s;if(s!==void 0)return!!s;if(t===e)return!0;if(typeof t!="object"||!t||typeof e!="object"||!e)return!1;const i=Object.keys(t),a=Object.keys(e);if(i.length!==a.length)return!1;const c=Object.prototype.hasOwnProperty.bind(e);for(let u=0;u<i.length;u++){const h=i[u];if(!c(h))return!1;const v=t[h],m=e[h];if(s=void 0,s===!1||s===void 0&&v!==m)return!1}return!0}function Ze(t){return t!==null&&typeof t=="object"&&Object.prototype.hasOwnProperty.call(t,"current")}function as(t){if(typeof t.type=="string")return;const e=t.type.displayName||t.type.name||"the component";throw new Error(`Only native element nodes can now be passed to React DnD connectors.You can either wrap ${e} into a <div>, or turn it into a drag source or a drop target itself.`)}function cs(t){return(e=null,r=null)=>{if(!l.isValidElement(e)){const i=e;return t(i,r),i}const n=e;return as(n),us(n,r?i=>t(i,r):t)}}function Bt(t){const e={};return Object.keys(t).forEach(r=>{const n=t[r];if(r.endsWith("Ref"))e[r]=t[r];else{const s=cs(n);e[r]=()=>s}}),e}function St(t,e){typeof t=="function"?t(e):t.current=e}function us(t,e){const r=t.ref;return b(typeof r!="string","Cannot connect React DnD to an element with an existing string ref. Please convert it to use a callback ref instead, or wrap it into a <span> or <div>. Read more: https://reactjs.org/docs/refs-and-the-dom.html#callback-refs"),r?l.cloneElement(t,{ref:n=>{St(r,n),St(e,n)}}):l.cloneElement(t,{ref:e})}class ls{receiveHandlerId(e){this.handlerId!==e&&(this.handlerId=e,this.reconnect())}get connectTarget(){return this.dragSource}get dragSourceOptions(){return this.dragSourceOptionsInternal}set dragSourceOptions(e){this.dragSourceOptionsInternal=e}get dragPreviewOptions(){return this.dragPreviewOptionsInternal}set dragPreviewOptions(e){this.dragPreviewOptionsInternal=e}reconnect(){const e=this.reconnectDragSource();this.reconnectDragPreview(e)}reconnectDragSource(){const e=this.dragSource,r=this.didHandlerIdChange()||this.didConnectedDragSourceChange()||this.didDragSourceOptionsChange();return r&&this.disconnectDragSource(),this.handlerId?e?(r&&(this.lastConnectedHandlerId=this.handlerId,this.lastConnectedDragSource=e,this.lastConnectedDragSourceOptions=this.dragSourceOptions,this.dragSourceUnsubscribe=this.backend.connectDragSource(this.handlerId,e,this.dragSourceOptions)),r):(this.lastConnectedDragSource=e,r):r}reconnectDragPreview(e=!1){const r=this.dragPreview,n=e||this.didHandlerIdChange()||this.didConnectedDragPreviewChange()||this.didDragPreviewOptionsChange();if(n&&this.disconnectDragPreview(),!!this.handlerId){if(!r){this.lastConnectedDragPreview=r;return}n&&(this.lastConnectedHandlerId=this.handlerId,this.lastConnectedDragPreview=r,this.lastConnectedDragPreviewOptions=this.dragPreviewOptions,this.dragPreviewUnsubscribe=this.backend.connectDragPreview(this.handlerId,r,this.dragPreviewOptions))}}didHandlerIdChange(){return this.lastConnectedHandlerId!==this.handlerId}didConnectedDragSourceChange(){return this.lastConnectedDragSource!==this.dragSource}didConnectedDragPreviewChange(){return this.lastConnectedDragPreview!==this.dragPreview}didDragSourceOptionsChange(){return!Je(this.lastConnectedDragSourceOptions,this.dragSourceOptions)}didDragPreviewOptionsChange(){return!Je(this.lastConnectedDragPreviewOptions,this.dragPreviewOptions)}disconnectDragSource(){this.dragSourceUnsubscribe&&(this.dragSourceUnsubscribe(),this.dragSourceUnsubscribe=void 0)}disconnectDragPreview(){this.dragPreviewUnsubscribe&&(this.dragPreviewUnsubscribe(),this.dragPreviewUnsubscribe=void 0,this.dragPreviewNode=null,this.dragPreviewRef=null)}get dragSource(){return this.dragSourceNode||this.dragSourceRef&&this.dragSourceRef.current}get dragPreview(){return this.dragPreviewNode||this.dragPreviewRef&&this.dragPreviewRef.current}clearDragSource(){this.dragSourceNode=null,this.dragSourceRef=null}clearDragPreview(){this.dragPreviewNode=null,this.dragPreviewRef=null}constructor(e){this.hooks=Bt({dragSource:(r,n)=>{this.clearDragSource(),this.dragSourceOptions=n||null,Ze(r)?this.dragSourceRef=r:this.dragSourceNode=r,this.reconnectDragSource()},dragPreview:(r,n)=>{this.clearDragPreview(),this.dragPreviewOptions=n||null,Ze(r)?this.dragPreviewRef=r:this.dragPreviewNode=r,this.reconnectDragPreview()}}),this.handlerId=null,this.dragSourceRef=null,this.dragSourceOptionsInternal=null,this.dragPreviewRef=null,this.dragPreviewOptionsInternal=null,this.lastConnectedHandlerId=null,this.lastConnectedDragSource=null,this.lastConnectedDragSourceOptions=null,this.lastConnectedDragPreview=null,this.lastConnectedDragPreviewOptions=null,this.backend=e}}class ds{get connectTarget(){return this.dropTarget}reconnect(){const e=this.didHandlerIdChange()||this.didDropTargetChange()||this.didOptionsChange();e&&this.disconnectDropTarget();const r=this.dropTarget;if(this.handlerId){if(!r){this.lastConnectedDropTarget=r;return}e&&(this.lastConnectedHandlerId=this.handlerId,this.lastConnectedDropTarget=r,this.lastConnectedDropTargetOptions=this.dropTargetOptions,this.unsubscribeDropTarget=this.backend.connectDropTarget(this.handlerId,r,this.dropTargetOptions))}}receiveHandlerId(e){e!==this.handlerId&&(this.handlerId=e,this.reconnect())}get dropTargetOptions(){return this.dropTargetOptionsInternal}set dropTargetOptions(e){this.dropTargetOptionsInternal=e}didHandlerIdChange(){return this.lastConnectedHandlerId!==this.handlerId}didDropTargetChange(){return this.lastConnectedDropTarget!==this.dropTarget}didOptionsChange(){return!Je(this.lastConnectedDropTargetOptions,this.dropTargetOptions)}disconnectDropTarget(){this.unsubscribeDropTarget&&(this.unsubscribeDropTarget(),this.unsubscribeDropTarget=void 0)}get dropTarget(){return this.dropTargetNode||this.dropTargetRef&&this.dropTargetRef.current}clearDropTarget(){this.dropTargetRef=null,this.dropTargetNode=null}constructor(e){this.hooks=Bt({dropTarget:(r,n)=>{this.clearDropTarget(),this.dropTargetOptions=n,Ze(r)?this.dropTargetRef=r:this.dropTargetNode=r,this.reconnect()}}),this.handlerId=null,this.dropTargetRef=null,this.dropTargetOptionsInternal=null,this.lastConnectedHandlerId=null,this.lastConnectedDropTarget=null,this.lastConnectedDropTargetOptions=null,this.backend=e}}function Q(){const{dragDropManager:t}=l.useContext(kt);return b(t!=null,"Expected drag drop context"),t}function fs(t,e){const r=Q(),n=l.useMemo(()=>new ls(r.getBackend()),[r]);return K(()=>(n.dragSourceOptions=t||null,n.reconnect(),()=>n.disconnectDragSource()),[n,t]),K(()=>(n.dragPreviewOptions=e||null,n.reconnect(),()=>n.disconnectDragPreview()),[n,e]),n}function hs(){const t=Q();return l.useMemo(()=>new ns(t),[t])}class gs{beginDrag(){const e=this.spec,r=this.monitor;let n=null;return typeof e.item=="object"?n=e.item:typeof e.item=="function"?n=e.item(r):n={},n??null}canDrag(){const e=this.spec,r=this.monitor;return typeof e.canDrag=="boolean"?e.canDrag:typeof e.canDrag=="function"?e.canDrag(r):!0}isDragging(e,r){const n=this.spec,s=this.monitor,{isDragging:i}=n;return i?i(s):r===e.getSourceId()}endDrag(){const e=this.spec,r=this.monitor,n=this.connector,{end:s}=e;s&&s(r.getItem(),r),n.reconnect()}constructor(e,r,n){this.spec=e,this.monitor=r,this.connector=n}}function ps(t,e,r){const n=l.useMemo(()=>new gs(t,e,r),[e,r]);return l.useEffect(()=>{n.spec=t},[t]),n}function vs(t){return l.useMemo(()=>{const e=t.type;return b(e!=null,"spec.type must be defined"),e},[t])}function ms(t,e,r){const n=Q(),s=ps(t,e,r),i=vs(t);K(function(){if(i!=null){const[c,u]=os(i,s,n);return e.receiveHandlerId(c),r.receiveHandlerId(c),u}},[n,e,r,s,i])}function ys(t,e){const r=Ft(t,e);b(!r.begin,"useDrag::spec.begin was deprecated in v14. Replace spec.begin() with spec.item(). (see more here - https://react-dnd.github.io/react-dnd/docs/api/use-drag)");const n=hs(),s=fs(r.options,r.previewOptions);return ms(r,n,s),[zt(r.collect,n,s),ts(s),rs(s)]}function bs(t){const r=Q().getMonitor(),[n,s]=Wt(r,t);return l.useEffect(()=>r.subscribeToOffsetChange(s)),l.useEffect(()=>r.subscribeToStateChange(s)),n}function Os(t){return l.useMemo(()=>t.hooks.dropTarget(),[t])}function Ds(t){const e=Q(),r=l.useMemo(()=>new ds(e.getBackend()),[e]);return K(()=>(r.dropTargetOptions=t||null,r.reconnect(),()=>r.disconnectDropTarget()),[t]),r}function Ss(){const t=Q();return l.useMemo(()=>new ss(t),[t])}function Cs(t){const{accept:e}=t;return l.useMemo(()=>(b(t.accept!=null,"accept must be defined"),Array.isArray(e)?e:[e]),[e])}class ws{canDrop(){const e=this.spec,r=this.monitor;return e.canDrop?e.canDrop(r.getItem(),r):!0}hover(){const e=this.spec,r=this.monitor;e.hover&&e.hover(r.getItem(),r)}drop(){const e=this.spec,r=this.monitor;if(e.drop)return e.drop(r.getItem(),r)}constructor(e,r){this.spec=e,this.monitor=r}}function Ts(t,e){const r=l.useMemo(()=>new ws(t,e),[e]);return l.useEffect(()=>{r.spec=t},[t]),r}function xs(t,e,r){const n=Q(),s=Ts(t,e),i=Cs(t);K(function(){const[c,u]=is(i,s,n);return e.receiveHandlerId(c),r.receiveHandlerId(c),u},[n,e,s,r,i.map(a=>a.toString()).join("|")])}function Es(t,e){const r=Ft(t,e),n=Ss(),s=Ds(r.options);return xs(r,n,s),[zt(r.collect,n,s),Os(s)]}function $t(t){let e=null;return()=>(e==null&&(e=t()),e)}function js(t,e){return t.filter(r=>r!==e)}function Is(t,e){const r=new Set,n=i=>r.add(i);t.forEach(n),e.forEach(n);const s=[];return r.forEach(i=>s.push(i)),s}class Ls{enter(e){const r=this.entered.length,n=s=>this.isNodeInDocument(s)&&(!s.contains||s.contains(e));return this.entered=Is(this.entered.filter(n),[e]),r===0&&this.entered.length>0}leave(e){const r=this.entered.length;return this.entered=js(this.entered.filter(this.isNodeInDocument),e),r>0&&this.entered.length===0}reset(){this.entered=[]}constructor(e){this.entered=[],this.isNodeInDocument=e}}class ks{initializeExposedProperties(){Object.keys(this.config.exposeProperties).forEach(e=>{Object.defineProperty(this.item,e,{configurable:!0,enumerable:!0,get(){return console.warn(`Browser doesn't allow reading "${e}" until the drop event.`),null}})})}loadDataTransfer(e){if(e){const r={};Object.keys(this.config.exposeProperties).forEach(n=>{const s=this.config.exposeProperties[n];s!=null&&(r[n]={value:s(e,this.config.matchesTypes),configurable:!0,enumerable:!0})}),Object.defineProperties(this.item,r)}}canDrag(){return!0}beginDrag(){return this.item}isDragging(e,r){return r===e.getSourceId()}endDrag(){}constructor(e){this.config=e,this.item={},this.initializeExposedProperties()}}const Ut="__NATIVE_FILE__",qt="__NATIVE_URL__",Vt="__NATIVE_TEXT__",Gt="__NATIVE_HTML__";var Ct=Object.freeze({__proto__:null,FILE:Ut,HTML:Gt,TEXT:Vt,URL:qt});function Ve(t,e,r){const n=e.reduce((s,i)=>s||t.getData(i),"");return n??r}const et={[Ut]:{exposeProperties:{files:t=>Array.prototype.slice.call(t.files),items:t=>t.items,dataTransfer:t=>t},matchesTypes:["Files"]},[Gt]:{exposeProperties:{html:(t,e)=>Ve(t,e,""),dataTransfer:t=>t},matchesTypes:["Html","text/html"]},[qt]:{exposeProperties:{urls:(t,e)=>Ve(t,e,"").split(`
`),dataTransfer:t=>t},matchesTypes:["Url","text/uri-list"]},[Vt]:{exposeProperties:{text:(t,e)=>Ve(t,e,""),dataTransfer:t=>t},matchesTypes:["Text","text/plain"]}};function Ms(t,e){const r=et[t];if(!r)throw new Error(`native type ${t} has no configuration`);const n=new ks(r);return n.loadDataTransfer(e),n}function Ge(t){if(!t)return null;const e=Array.prototype.slice.call(t.types||[]);return Object.keys(et).filter(r=>{const n=et[r];return n!=null&&n.matchesTypes?n.matchesTypes.some(s=>e.indexOf(s)>-1):!1})[0]||null}const Ps=$t(()=>/firefox/i.test(navigator.userAgent)),Xt=$t(()=>!!window.safari);class wt{interpolate(e){const{xs:r,ys:n,c1s:s,c2s:i,c3s:a}=this;let c=r.length-1;if(e===r[c])return n[c];let u=0,h=a.length-1,v;for(;u<=h;){v=Math.floor(.5*(u+h));const d=r[v];if(d<e)u=v+1;else if(d>e)h=v-1;else return n[v]}c=Math.max(0,h);const m=e-r[c],p=m*m;return n[c]+s[c]*m+i[c]*p+a[c]*m*p}constructor(e,r){const{length:n}=e,s=[];for(let d=0;d<n;d++)s.push(d);s.sort((d,f)=>e[d]<e[f]?-1:1);const i=[],a=[];let c,u;for(let d=0;d<n-1;d++)c=e[d+1]-e[d],u=r[d+1]-r[d],i.push(c),a.push(u/c);const h=[a[0]];for(let d=0;d<i.length-1;d++){const f=a[d],g=a[d+1];if(f*g<=0)h.push(0);else{c=i[d];const y=i[d+1],D=c+y;h.push(3*D/((D+y)/f+(D+c)/g))}}h.push(a[a.length-1]);const v=[],m=[];let p;for(let d=0;d<h.length-1;d++){p=a[d];const f=h[d],g=1/i[d],y=f+h[d+1]-p-p;v.push((p-f-y)*g),m.push(y*g*g)}this.xs=e,this.ys=r,this.c1s=h,this.c2s=v,this.c3s=m}}const Rs=1;function Yt(t){const e=t.nodeType===Rs?t:t.parentElement;if(!e)return null;const{top:r,left:n}=e.getBoundingClientRect();return{x:n,y:r}}function ye(t){return{x:t.clientX,y:t.clientY}}function Ns(t){var e;return t.nodeName==="IMG"&&(Ps()||!(!((e=document.documentElement)===null||e===void 0)&&e.contains(t)))}function As(t,e,r,n){let s=t?e.width:r,i=t?e.height:n;return Xt()&&t&&(i/=window.devicePixelRatio,s/=window.devicePixelRatio),{dragPreviewWidth:s,dragPreviewHeight:i}}function _s(t,e,r,n,s){const i=Ns(e),c=Yt(i?t:e),u={x:r.x-c.x,y:r.y-c.y},{offsetWidth:h,offsetHeight:v}=t,{anchorX:m,anchorY:p}=n,{dragPreviewWidth:d,dragPreviewHeight:f}=As(i,e,h,v),g=()=>{let k=new wt([0,.5,1],[u.y,u.y/v*f,u.y+f-v]).interpolate(p);return Xt()&&i&&(k+=(window.devicePixelRatio-1)*f),k},y=()=>new wt([0,.5,1],[u.x,u.x/h*d,u.x+d-h]).interpolate(m),{offsetX:D,offsetY:O}=s,S=D===0||D,T=O===0||O;return{x:S?D:y(),y:T?O:g()}}let Hs=class{get window(){if(this.globalContext)return this.globalContext;if(typeof window<"u")return window}get document(){var e;return!((e=this.globalContext)===null||e===void 0)&&e.document?this.globalContext.document:this.window?this.window.document:void 0}get rootElement(){var e;return((e=this.optionsArgs)===null||e===void 0?void 0:e.rootElement)||this.window}constructor(e,r){this.ownerDocument=null,this.globalContext=e,this.optionsArgs=r}};function Ws(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Tt(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{},n=Object.keys(r);typeof Object.getOwnPropertySymbols=="function"&&(n=n.concat(Object.getOwnPropertySymbols(r).filter(function(s){return Object.getOwnPropertyDescriptor(r,s).enumerable}))),n.forEach(function(s){Ws(t,s,r[s])})}return t}class zs{profile(){var e,r;return{sourcePreviewNodes:this.sourcePreviewNodes.size,sourcePreviewNodeOptions:this.sourcePreviewNodeOptions.size,sourceNodeOptions:this.sourceNodeOptions.size,sourceNodes:this.sourceNodes.size,dragStartSourceIds:((e=this.dragStartSourceIds)===null||e===void 0?void 0:e.length)||0,dropTargetIds:this.dropTargetIds.length,dragEnterTargetIds:this.dragEnterTargetIds.length,dragOverTargetIds:((r=this.dragOverTargetIds)===null||r===void 0?void 0:r.length)||0}}get window(){return this.options.window}get document(){return this.options.document}get rootElement(){return this.options.rootElement}setup(){const e=this.rootElement;if(e!==void 0){if(e.__isReactDndBackendSetUp)throw new Error("Cannot have two HTML5 backends at the same time.");e.__isReactDndBackendSetUp=!0,this.addEventListeners(e)}}teardown(){const e=this.rootElement;if(e!==void 0&&(e.__isReactDndBackendSetUp=!1,this.removeEventListeners(this.rootElement),this.clearCurrentDragSourceNode(),this.asyncEndDragFrameId)){var r;(r=this.window)===null||r===void 0||r.cancelAnimationFrame(this.asyncEndDragFrameId)}}connectDragPreview(e,r,n){return this.sourcePreviewNodeOptions.set(e,n),this.sourcePreviewNodes.set(e,r),()=>{this.sourcePreviewNodes.delete(e),this.sourcePreviewNodeOptions.delete(e)}}connectDragSource(e,r,n){this.sourceNodes.set(e,r),this.sourceNodeOptions.set(e,n);const s=a=>this.handleDragStart(a,e),i=a=>this.handleSelectStart(a);return r.setAttribute("draggable","true"),r.addEventListener("dragstart",s),r.addEventListener("selectstart",i),()=>{this.sourceNodes.delete(e),this.sourceNodeOptions.delete(e),r.removeEventListener("dragstart",s),r.removeEventListener("selectstart",i),r.setAttribute("draggable","false")}}connectDropTarget(e,r){const n=a=>this.handleDragEnter(a,e),s=a=>this.handleDragOver(a,e),i=a=>this.handleDrop(a,e);return r.addEventListener("dragenter",n),r.addEventListener("dragover",s),r.addEventListener("drop",i),()=>{r.removeEventListener("dragenter",n),r.removeEventListener("dragover",s),r.removeEventListener("drop",i)}}addEventListeners(e){e.addEventListener&&(e.addEventListener("dragstart",this.handleTopDragStart),e.addEventListener("dragstart",this.handleTopDragStartCapture,!0),e.addEventListener("dragend",this.handleTopDragEndCapture,!0),e.addEventListener("dragenter",this.handleTopDragEnter),e.addEventListener("dragenter",this.handleTopDragEnterCapture,!0),e.addEventListener("dragleave",this.handleTopDragLeaveCapture,!0),e.addEventListener("dragover",this.handleTopDragOver),e.addEventListener("dragover",this.handleTopDragOverCapture,!0),e.addEventListener("drop",this.handleTopDrop),e.addEventListener("drop",this.handleTopDropCapture,!0))}removeEventListeners(e){e.removeEventListener&&(e.removeEventListener("dragstart",this.handleTopDragStart),e.removeEventListener("dragstart",this.handleTopDragStartCapture,!0),e.removeEventListener("dragend",this.handleTopDragEndCapture,!0),e.removeEventListener("dragenter",this.handleTopDragEnter),e.removeEventListener("dragenter",this.handleTopDragEnterCapture,!0),e.removeEventListener("dragleave",this.handleTopDragLeaveCapture,!0),e.removeEventListener("dragover",this.handleTopDragOver),e.removeEventListener("dragover",this.handleTopDragOverCapture,!0),e.removeEventListener("drop",this.handleTopDrop),e.removeEventListener("drop",this.handleTopDropCapture,!0))}getCurrentSourceNodeOptions(){const e=this.monitor.getSourceId(),r=this.sourceNodeOptions.get(e);return Tt({dropEffect:this.altKeyPressed?"copy":"move"},r||{})}getCurrentDropEffect(){return this.isDraggingNativeItem()?"copy":this.getCurrentSourceNodeOptions().dropEffect}getCurrentSourcePreviewNodeOptions(){const e=this.monitor.getSourceId(),r=this.sourcePreviewNodeOptions.get(e);return Tt({anchorX:.5,anchorY:.5,captureDraggingState:!1},r||{})}isDraggingNativeItem(){const e=this.monitor.getItemType();return Object.keys(Ct).some(r=>Ct[r]===e)}beginDragNativeItem(e,r){this.clearCurrentDragSourceNode(),this.currentNativeSource=Ms(e,r),this.currentNativeHandle=this.registry.addSource(e,this.currentNativeSource),this.actions.beginDrag([this.currentNativeHandle])}setCurrentDragSourceNode(e){this.clearCurrentDragSourceNode(),this.currentDragSourceNode=e;const r=1e3;this.mouseMoveTimeoutTimer=setTimeout(()=>{var n;return(n=this.rootElement)===null||n===void 0?void 0:n.addEventListener("mousemove",this.endDragIfSourceWasRemovedFromDOM,!0)},r)}clearCurrentDragSourceNode(){if(this.currentDragSourceNode){if(this.currentDragSourceNode=null,this.rootElement){var e;(e=this.window)===null||e===void 0||e.clearTimeout(this.mouseMoveTimeoutTimer||void 0),this.rootElement.removeEventListener("mousemove",this.endDragIfSourceWasRemovedFromDOM,!0)}return this.mouseMoveTimeoutTimer=null,!0}return!1}handleDragStart(e,r){e.defaultPrevented||(this.dragStartSourceIds||(this.dragStartSourceIds=[]),this.dragStartSourceIds.unshift(r))}handleDragEnter(e,r){this.dragEnterTargetIds.unshift(r)}handleDragOver(e,r){this.dragOverTargetIds===null&&(this.dragOverTargetIds=[]),this.dragOverTargetIds.unshift(r)}handleDrop(e,r){this.dropTargetIds.unshift(r)}constructor(e,r,n){this.sourcePreviewNodes=new Map,this.sourcePreviewNodeOptions=new Map,this.sourceNodes=new Map,this.sourceNodeOptions=new Map,this.dragStartSourceIds=null,this.dropTargetIds=[],this.dragEnterTargetIds=[],this.currentNativeSource=null,this.currentNativeHandle=null,this.currentDragSourceNode=null,this.altKeyPressed=!1,this.mouseMoveTimeoutTimer=null,this.asyncEndDragFrameId=null,this.dragOverTargetIds=null,this.lastClientOffset=null,this.hoverRafId=null,this.getSourceClientOffset=s=>{const i=this.sourceNodes.get(s);return i&&Yt(i)||null},this.endDragNativeItem=()=>{this.isDraggingNativeItem()&&(this.actions.endDrag(),this.currentNativeHandle&&this.registry.removeSource(this.currentNativeHandle),this.currentNativeHandle=null,this.currentNativeSource=null)},this.isNodeInDocument=s=>!!(s&&this.document&&this.document.body&&this.document.body.contains(s)),this.endDragIfSourceWasRemovedFromDOM=()=>{const s=this.currentDragSourceNode;s==null||this.isNodeInDocument(s)||(this.clearCurrentDragSourceNode()&&this.monitor.isDragging()&&this.actions.endDrag(),this.cancelHover())},this.scheduleHover=s=>{this.hoverRafId===null&&typeof requestAnimationFrame<"u"&&(this.hoverRafId=requestAnimationFrame(()=>{this.monitor.isDragging()&&this.actions.hover(s||[],{clientOffset:this.lastClientOffset}),this.hoverRafId=null}))},this.cancelHover=()=>{this.hoverRafId!==null&&typeof cancelAnimationFrame<"u"&&(cancelAnimationFrame(this.hoverRafId),this.hoverRafId=null)},this.handleTopDragStartCapture=()=>{this.clearCurrentDragSourceNode(),this.dragStartSourceIds=[]},this.handleTopDragStart=s=>{if(s.defaultPrevented)return;const{dragStartSourceIds:i}=this;this.dragStartSourceIds=null;const a=ye(s);this.monitor.isDragging()&&(this.actions.endDrag(),this.cancelHover()),this.actions.beginDrag(i||[],{publishSource:!1,getSourceClientOffset:this.getSourceClientOffset,clientOffset:a});const{dataTransfer:c}=s,u=Ge(c);if(this.monitor.isDragging()){if(c&&typeof c.setDragImage=="function"){const v=this.monitor.getSourceId(),m=this.sourceNodes.get(v),p=this.sourcePreviewNodes.get(v)||m;if(p){const{anchorX:d,anchorY:f,offsetX:g,offsetY:y}=this.getCurrentSourcePreviewNodeOptions(),S=_s(m,p,a,{anchorX:d,anchorY:f},{offsetX:g,offsetY:y});c.setDragImage(p,S.x,S.y)}}try{c==null||c.setData("application/json",{})}catch{}this.setCurrentDragSourceNode(s.target);const{captureDraggingState:h}=this.getCurrentSourcePreviewNodeOptions();h?this.actions.publishDragSource():setTimeout(()=>this.actions.publishDragSource(),0)}else if(u)this.beginDragNativeItem(u);else{if(c&&!c.types&&(s.target&&!s.target.hasAttribute||!s.target.hasAttribute("draggable")))return;s.preventDefault()}},this.handleTopDragEndCapture=()=>{this.clearCurrentDragSourceNode()&&this.monitor.isDragging()&&this.actions.endDrag(),this.cancelHover()},this.handleTopDragEnterCapture=s=>{if(this.dragEnterTargetIds=[],this.isDraggingNativeItem()){var i;(i=this.currentNativeSource)===null||i===void 0||i.loadDataTransfer(s.dataTransfer)}if(!this.enterLeaveCounter.enter(s.target)||this.monitor.isDragging())return;const{dataTransfer:c}=s,u=Ge(c);u&&this.beginDragNativeItem(u,c)},this.handleTopDragEnter=s=>{const{dragEnterTargetIds:i}=this;if(this.dragEnterTargetIds=[],!this.monitor.isDragging())return;this.altKeyPressed=s.altKey,i.length>0&&this.actions.hover(i,{clientOffset:ye(s)}),i.some(c=>this.monitor.canDropOnTarget(c))&&(s.preventDefault(),s.dataTransfer&&(s.dataTransfer.dropEffect=this.getCurrentDropEffect()))},this.handleTopDragOverCapture=s=>{if(this.dragOverTargetIds=[],this.isDraggingNativeItem()){var i;(i=this.currentNativeSource)===null||i===void 0||i.loadDataTransfer(s.dataTransfer)}},this.handleTopDragOver=s=>{const{dragOverTargetIds:i}=this;if(this.dragOverTargetIds=[],!this.monitor.isDragging()){s.preventDefault(),s.dataTransfer&&(s.dataTransfer.dropEffect="none");return}this.altKeyPressed=s.altKey,this.lastClientOffset=ye(s),this.scheduleHover(i),(i||[]).some(c=>this.monitor.canDropOnTarget(c))?(s.preventDefault(),s.dataTransfer&&(s.dataTransfer.dropEffect=this.getCurrentDropEffect())):this.isDraggingNativeItem()?s.preventDefault():(s.preventDefault(),s.dataTransfer&&(s.dataTransfer.dropEffect="none"))},this.handleTopDragLeaveCapture=s=>{this.isDraggingNativeItem()&&s.preventDefault(),this.enterLeaveCounter.leave(s.target)&&(this.isDraggingNativeItem()&&setTimeout(()=>this.endDragNativeItem(),0),this.cancelHover())},this.handleTopDropCapture=s=>{if(this.dropTargetIds=[],this.isDraggingNativeItem()){var i;s.preventDefault(),(i=this.currentNativeSource)===null||i===void 0||i.loadDataTransfer(s.dataTransfer)}else Ge(s.dataTransfer)&&s.preventDefault();this.enterLeaveCounter.reset()},this.handleTopDrop=s=>{const{dropTargetIds:i}=this;this.dropTargetIds=[],this.actions.hover(i,{clientOffset:ye(s)}),this.actions.drop({dropEffect:this.getCurrentDropEffect()}),this.isDraggingNativeItem()?this.endDragNativeItem():this.monitor.isDragging()&&this.actions.endDrag(),this.cancelHover()},this.handleSelectStart=s=>{const i=s.target;typeof i.dragDrop=="function"&&(i.tagName==="INPUT"||i.tagName==="SELECT"||i.tagName==="TEXTAREA"||i.isContentEditable||(s.preventDefault(),i.dragDrop()))},this.options=new Hs(r,n),this.actions=e.getActions(),this.monitor=e.getMonitor(),this.registry=e.getRegistry(),this.enterLeaveCounter=new Ls(this.isNodeInDocument)}}let be;function Fs(){return be||(be=new Image,be.src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="),be}const Bs=function(e,r,n){return new zs(e,r,n)};function xt({isPremovedPiece:t=!1,piece:e,square:r,squares:n}){const{animationDuration:s,arePiecesDraggable:i,boardWidth:a,boardOrientation:c,chessPieces:u,currentPosition:h,deletePieceFromSquare:v,dropOffBoardAction:m,id:p,isDraggablePiece:d,isWaitingForAnimation:f,onPieceClick:g,onPieceDragBegin:y,onPieceDragEnd:D,onPieceDropOffBoard:O,onPromotionCheck:S,positionDifferences:T}=B(),[I,k]=l.useState({opacity:1,zIndex:5,touchAction:"none",cursor:i&&d({piece:e,sourceSquare:r})?"-webkit-grab":"default"}),[{canDrag:G,isDragging:X},$,re]=ys(()=>({type:"piece",item:()=>(y(e,r),{piece:e,square:r,id:p}),end:(j,M)=>{D(e,r),!M.didDrop()&&(m==="trash"&&v(r),O==null||O(r,e))},collect:j=>({canDrag:d({piece:e,sourceSquare:r}),isDragging:!!j.isDragging()})}),[e,r,h,p]);re(Fs(),{captureDraggingState:!0}),l.useEffect(()=>{k(j=>Object.assign(Object.assign({},j),{opacity:X?0:1}))},[X]),l.useEffect(()=>{var j;const M=(j=T.removed)===null||j===void 0?void 0:j[r];if(!T.added||!M)return;const Y=Object.entries(T.added).find(([W,z])=>z===M||S(r,W,M));if(f&&M&&Y&&!t){const W=r,z=Y[0];if(W&&z){const H=a/8;k(ne=>Object.assign(Object.assign({},ne),{transform:`translate(${(c==="black"?-1:1)*(z.charCodeAt(0)-W.charCodeAt(0))*H}px, ${(c==="black"?-1:1)*(Number(W[1])-Number(z[1]))*H}px)`,transition:`transform ${s}ms`,zIndex:6}))}}},[T]),l.useEffect(()=>{const{sourceSq:j}=J();j&&k(M=>Object.assign(Object.assign({},M),{transform:"translate(0px, 0px)",transition:"transform 0ms"}))},[h]),l.useEffect(()=>{k(j=>Object.assign(Object.assign({},j),{cursor:i&&d({piece:e,sourceSquare:r})?"-webkit-grab":"default"}))},[r,h,i]);function J(){return{sourceSq:n[r]}}return o.jsx("div",Object.assign({ref:i&&G?$:null,onClick:()=>g(e,r),"data-piece":e,style:I},{children:typeof u[e]=="function"?u[e]({squareWidth:a/8,isDragging:X,square:r}):o.jsx("svg",Object.assign({viewBox:"1 1 43 43",width:a/8,height:a/8,style:{display:"block"}},{children:o.jsx("g",{children:u[e]})}))}))}function $s({square:t,squareColor:e,setSquares:r,squareHasPremove:n,children:s}){const i=l.useRef(null),{autoPromoteToQueen:a,boardWidth:c,boardOrientation:u,clearArrows:h,currentPosition:v,currentRightClickDown:m,customBoardStyle:p,customDarkSquareStyle:d,customDropSquareStyle:f,customLightSquareStyle:g,customPremoveDarkSquareStyle:y,customPremoveLightSquareStyle:D,customSquare:O,customSquareStyles:S,drawNewArrow:T,handleSetPosition:I,handleSparePieceDrop:k,isWaitingForAnimation:G,lastPieceColour:X,lastSquareDraggedOver:$,onArrowDrawEnd:re,onDragOverSquare:J,onMouseOutSquare:j,onMouseOverSquare:M,onPieceDrop:Y,onPromotionCheck:W,onRightClickDown:z,onRightClickUp:H,onSquareClick:ne,setLastSquareDraggedOver:je,setPromoteFromSquare:Ie,setPromoteToSquare:de,setShowPromoteDialog:Le}=B(),[{isOver:ke},se]=Es(()=>({accept:"piece",drop:Me,collect:C=>({isOver:!!C.isOver()})}),[t,v,Y,G,X]);function Me(C){if(C.isSpare){k(C.piece,t);return}W(C.square,t,C.piece)?a?I(C.square,t,C.piece[0]==="w"?"wQ":"bQ"):(Ie(C.square),de(t),Le(!0)):I(C.square,t,C.piece,!0)}l.useEffect(()=>{if(i.current){const{x:C,y:F}=i.current.getBoundingClientRect();r(Z=>Object.assign(Object.assign({},Z),{[t]:{x:C,y:F}}))}},[c,u]);const ie=Object.assign(Object.assign(Object.assign(Object.assign({},Us(t,u,p)),e==="black"?d:g),n&&(e==="black"?y:D)),ke&&f);return o.jsx("div",Object.assign({ref:se,style:ie,"data-square-color":e,"data-square":t,onTouchMove:C=>{var F;const Z=C.touches[0],oe=document.elementsFromPoint(Z.clientX,Z.clientY),L=(F=oe==null?void 0:oe.find(P=>P.getAttribute("data-square")))===null||F===void 0?void 0:F.getAttribute("data-square");L&&L!==$&&(je(L),J(L))},onMouseOver:C=>{C.buttons===2&&m&&T(m,t),!(C.relatedTarget&&C.currentTarget.contains(C.relatedTarget))&&M(t)},onMouseOut:C=>{C.relatedTarget&&C.currentTarget.contains(C.relatedTarget)||j(t)},onMouseDown:C=>{C.button===2&&z(t)},onMouseUp:C=>{C.button===2&&(m&&re(m,t),H(t))},onDragEnter:()=>J(t),onClick:()=>{const C=v[t];ne(t,C),h()},onContextMenu:C=>{C.preventDefault()}},{children:typeof O=="string"?o.jsx(O,Object.assign({ref:i,style:Object.assign(Object.assign(Object.assign({},jt(c)),Et),!n&&(S==null?void 0:S[t]))},{children:s})):o.jsx(O,Object.assign({ref:i,square:t,squareColor:e,style:Object.assign(Object.assign(Object.assign({},jt(c)),Et),!n&&(S==null?void 0:S[t]))},{children:s}))}))}const Et={display:"flex",justifyContent:"center"},jt=t=>({width:t/8,height:t/8}),Us=(t,e,r)=>r!=null&&r.borderRadius?t==="a1"?e==="white"?{borderBottomLeftRadius:r.borderRadius}:{borderTopRightRadius:r.borderRadius}:t==="a8"?e==="white"?{borderTopLeftRadius:r.borderRadius}:{borderBottomRightRadius:r.borderRadius}:t==="h1"?e==="white"?{borderBottomRightRadius:r.borderRadius}:{borderTopLeftRadius:r.borderRadius}:t==="h8"?e==="white"?{borderTopRightRadius:r.borderRadius}:{borderBottomLeftRadius:r.borderRadius}:{}:{};function qs(){const[t,e]=l.useState({}),{arePremovesAllowed:r,boardOrientation:n,boardWidth:s,currentPosition:i,id:a,premoves:c,showBoardNotation:u}=B(),h=l.useMemo(()=>{const v=[];return r?(c.forEach((m,p)=>{const{sourceSq:d,targetSq:f,piece:g}=m,y=v.find(D=>{var O;return D.piece===g&&((O=D.premovesRoute.at(-1))===null||O===void 0?void 0:O.targetSq)===d});y?y.premovesRoute.push({sourceSq:d,targetSq:f,index:p}):v.push({piece:g,premovesRoute:[{sourceSq:d,targetSq:f,index:p}]})}),v):[]},[c]);return o.jsx("div",Object.assign({"data-boardid":a},{children:[...Array(8)].map((v,m)=>o.jsx("div",Object.assign({style:{display:"flex",flexWrap:"nowrap",width:s}},{children:[...Array(8)].map((p,d)=>{const f=n==="black"?le[7-d]+(m+1):le[d]+(8-m),g=d%2===m%2?"white":"black",y=c.find(O=>O.sourceSq===f||O.targetSq===f),D=h.filter(({premovesRoute:O})=>{var S;return((S=O.at(-1))===null||S===void 0?void 0:S.targetSq)===f}).sort((O,S)=>{var T,I;return((T=S.premovesRoute.at(-1))===null||T===void 0?void 0:T.index)-((I=O.premovesRoute.at(-1))===null||I===void 0?void 0:I.index)}).at(0);return o.jsxs($s,Object.assign({square:f,squareColor:g,setSquares:e,squareHasPremove:!!y},{children:[!y&&i[f]&&o.jsx(xt,{piece:i[f],square:f,squares:t}),D&&o.jsx(xt,{isPremovedPiece:!0,piece:D.piece,square:f,squares:t}),u&&o.jsx(Mr,{row:m,col:d})]}),`${d}${m}`)})}),m.toString()))}))}const Vs=()=>{const{arrows:t,newArrow:e,boardOrientation:r,boardWidth:n,customArrowColor:s}=B(),i=[...t,e].filter(Boolean);return o.jsx("svg",Object.assign({width:n,height:n,style:{position:"absolute",top:"0",left:"0",pointerEvents:"none",zIndex:"10"}},{children:i.map((a,c)=>{const[u,h,v]=a;if(u===h)return null;const m=Ye(r,n,u),p=Ye(r,n,h);let d=n/32;const f=c===t.length;t.some(S=>S[0]!==u&&S[1]===h)&&!f&&(d=n/16);const g=p.x-m.x,y=p.y-m.y,D=Math.hypot(y,g),O={x:m.x+g*(D-d)/D,y:m.y+y*(D-d)/D};return o.jsxs(l.Fragment,{children:[o.jsx("marker",Object.assign({id:`arrowhead-${c}`,markerWidth:"2",markerHeight:"2.5",refX:"1.25",refY:"1.25",orient:"auto"},{children:o.jsx("polygon",{points:"0.3 0, 2 1.25, 0.3 2.5",fill:v??s})})),o.jsx("line",{x1:m.x,y1:m.y,x2:O.x,y2:O.y,opacity:f?"0.5":"0.65",stroke:v??s,strokeWidth:f?.9*n/40:n/40,markerEnd:`url(#arrowhead-${c})`})]},`${u}-${h}${f?"-active":""}`)})}))};function Gs({option:t}){const[e,r]=l.useState(!1),{boardWidth:n,chessPieces:s,customDarkSquareStyle:i,customLightSquareStyle:a,handleSetPosition:c,onPromotionPieceSelect:u,promoteFromSquare:h,promoteToSquare:v,promotionDialogVariant:m}=B(),p=()=>{switch(t[1]){case"Q":return i.backgroundColor;case"R":return a.backgroundColor;case"N":return m==="default"?a.backgroundColor:i.backgroundColor;case"B":return m==="default"?i.backgroundColor:a.backgroundColor}};return o.jsx("div",Object.assign({onClick:()=>{u(t,h??void 0,v??void 0)&&c(h,v,t,!0)},onMouseOver:()=>r(!0),onMouseOut:()=>r(!1),"data-piece":t,style:{cursor:"pointer",backgroundColor:e?p():`${p()}aa`,borderRadius:"4px",transition:"all 0.1s ease-out"}},{children:typeof s[t]=="function"?o.jsx("div",Object.assign({style:{transition:"all 0.1s ease-out",transform:e?"scale(1)":"scale(0.85)"}},{children:s[t]({squareWidth:n/8,isDragging:!1})})):o.jsx("svg",Object.assign({viewBox:"1 1 43 43",width:n/8,height:n/8,style:{transition:"all 0.1s ease-out",transform:e?"scale(1)":"scale(0.85)"}},{children:o.jsx("g",{children:s[t]})}))}))}function Xs(){const{boardOrientation:t,boardWidth:e,promotionDialogVariant:r,promoteToSquare:n}=B(),s=(n==null?void 0:n[1])==="1"?"b":"w",i=[`${s??"w"}Q`,`${s??"w"}R`,`${s??"w"}N`,`${s??"w"}B`],a={default:{display:"grid",gridTemplateColumns:"1fr 1fr",transform:`translate(${-e/8}px, ${-e/8}px)`},vertical:{transform:`translate(${-e/16}px, ${-e/16}px)`},modal:{display:"flex",justifyContent:"center",alignItems:"center",transform:`translate(0px, ${3*e/8}px)`,width:"100%",height:`${e/4}px`,top:0,backgroundColor:"white",left:0}},c=Ye(t,e,n||"a8");return o.jsx("div",Object.assign({style:Object.assign({position:"absolute",top:`${c==null?void 0:c.y}px`,left:`${c==null?void 0:c.x}px`,zIndex:1e3},a[r]),title:"Choose promotion piece"},{children:i.map(u=>o.jsx(Gs,{option:u},u))}))}const Ys={whiteKing:o.jsx("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",version:"1.1",style:{shapeRendering:"geometricPrecision",textRendering:"geometricPrecision",imageRendering:"crisp-edges"},viewBox:"0 0 4210 12970",x:"0px",y:"0px",fillRule:"evenodd",clipRule:"evenodd",width:"250",height:"250"},{children:o.jsx("g",{children:o.jsx("path",{style:{fill:"black",fillRule:"nonzero"},d:"M2105 0c169,0 286,160 249,315l200 0c-172,266 -231,479 -256,792 315,-24 530,-86 792,-255l0 897c-265,-171 -479,-231 -792,-256 18,234 75,495 185,682l339 0c233,0 369,269 225,456l545 0 -595 1916c130,94 158,275 59,402 465,0 416,568 51,568l-334 0 465 2867 332 0c250,0 381,306 199,485 162,63 273,220 273,399l0 633 168 0 0 475c-1403,0 -2807,0 -4210,0l0 -475 167 0 0 -633c0,-179 112,-336 274,-399 -181,-178 -52,-485 199,-485l332 0 465 -2867 -335 0c-353,0 -418,-568 51,-568 -98,-127 -70,-308 59,-402l-594 -1916c181,0 363,0 545,0 -144,-187 -9,-456 225,-456l339 0c110,-187 167,-448 185,-682 -315,25 -530,87 -793,256l0 -897c266,171 480,231 793,255 -25,-315 -87,-529 -256,-792l199 0c-36,-155 81,-315 250,-315zm-1994 10012l0 253 3988 0 0 -253c-1330,0 -2659,0 -3988,0zm484 -1060c-174,0 -316,142 -316,316l0 633 3652 0 0 -633c0,-174 -142,-316 -316,-316 -1007,0 -2013,0 -3020,0zm45 -457c-230,0 -225,345 0,345l2930 0c230,0 225,-345 0,-345 -977,0 -1953,0 -2930,0zm2020 -2978l-1111 0 -465 2867 2041 0 -465 -2867zm-1558 -456c-229,0 -224,345 0,345 669,0 1337,0 2005,0 230,0 225,-345 0,-345 -668,0 -1336,0 -2005,0zm1730 -457l-1454 0c-229,0 -224,345 0,345l1454 0c229,0 224,-345 0,-345zm-2064 -1862l544 1751c529,0 1057,0 1586,0l544 -1751c-892,0 -1783,0 -2674,0zm1085 -567l504 0c-126,-247 -163,-526 -177,-800 273,15 553,52 800,177l0 -504c-247,126 -527,163 -800,177 14,-273 51,-552 177,-799 -168,0 -336,0 -504,0 125,247 162,526 177,799 -274,-14 -553,-51 -800,-177l0 504c247,-125 527,-162 800,-177 -15,274 -52,553 -177,800zm969 111l-1434 0c-230,0 -225,345 0,345l1434 0c230,0 225,-345 0,-345zm-717 -2175c-105,0 -175,109 -133,204l266 0c42,-96 -30,-205 -133,-204z"})})}))};function Ks({children:t}){try{return o.jsx(o.Fragment,{children:t})}catch(e){return console.log(e),o.jsx(Kt,{showError:!0})}}function Kt({showError:t=!1}){return o.jsxs("div",Object.assign({style:{display:"flex",justifyContent:"center",alignItems:"center",flexDirection:"column"}},{children:[o.jsx("div",Object.assign({style:{width:250,height:250,transform:"rotate(90deg)"}},{children:Ys.whiteKing})),t&&o.jsx("h1",{children:"Something went wrong"})]}))}function Qs(){const t=l.useRef(null),{boardWidth:e,clearCurrentRightClickDown:r,onPromotionPieceSelect:n,setShowPromoteDialog:s,showPromoteDialog:i,customBoardStyle:a}=B();return l.useEffect(()=>{function c(u){t.current&&!t.current.contains(u.target)&&r()}return document.addEventListener("mouseup",c),()=>{document.removeEventListener("mouseup",c)}},[]),e?o.jsx("div",Object.assign({style:{perspective:"1000px"}},{children:o.jsxs("div",Object.assign({ref:t,style:Object.assign(Object.assign({position:"relative"},Js(e)),a)},{children:[o.jsx(qs,{}),o.jsx(Vs,{}),i&&o.jsxs(o.Fragment,{children:[o.jsx("div",{onClick:()=>{s(!1),n==null||n()},style:{position:"absolute",top:"0",left:"0",zIndex:"100",backgroundColor:"rgba(22,21,18,.7)",width:e,height:e}}),o.jsx(Xs,{})]})]}))})):o.jsx(Kt,{})}const Js=t=>({cursor:"default",height:t,width:t});var V;(function(t){t.mouse="mouse",t.touch="touch",t.keyboard="keyboard"})(V||(V={}));class Zs{get delay(){var e;return(e=this.args.delay)!==null&&e!==void 0?e:0}get scrollAngleRanges(){return this.args.scrollAngleRanges}get getDropTargetElementsAtPoint(){return this.args.getDropTargetElementsAtPoint}get ignoreContextMenu(){var e;return(e=this.args.ignoreContextMenu)!==null&&e!==void 0?e:!1}get enableHoverOutsideTarget(){var e;return(e=this.args.enableHoverOutsideTarget)!==null&&e!==void 0?e:!1}get enableKeyboardEvents(){var e;return(e=this.args.enableKeyboardEvents)!==null&&e!==void 0?e:!1}get enableMouseEvents(){var e;return(e=this.args.enableMouseEvents)!==null&&e!==void 0?e:!1}get enableTouchEvents(){var e;return(e=this.args.enableTouchEvents)!==null&&e!==void 0?e:!0}get touchSlop(){return this.args.touchSlop||0}get delayTouchStart(){var e,r,n,s;return(s=(n=(e=this.args)===null||e===void 0?void 0:e.delayTouchStart)!==null&&n!==void 0?n:(r=this.args)===null||r===void 0?void 0:r.delay)!==null&&s!==void 0?s:0}get delayMouseStart(){var e,r,n,s;return(s=(n=(e=this.args)===null||e===void 0?void 0:e.delayMouseStart)!==null&&n!==void 0?n:(r=this.args)===null||r===void 0?void 0:r.delay)!==null&&s!==void 0?s:0}get window(){if(this.context&&this.context.window)return this.context.window;if(typeof window<"u")return window}get document(){var e;if(!((e=this.context)===null||e===void 0)&&e.document)return this.context.document;if(this.window)return this.window.document}get rootElement(){var e;return((e=this.args)===null||e===void 0?void 0:e.rootElement)||this.document}constructor(e,r){this.args=e,this.context=r}}function ei(t,e,r,n){return Math.sqrt(Math.pow(Math.abs(r-t),2)+Math.pow(Math.abs(n-e),2))}function ti(t,e,r,n,s){if(!s)return!1;const i=Math.atan2(n-e,r-t)*180/Math.PI+180;for(let a=0;a<s.length;++a){const c=s[a];if(c&&(c.start==null||i>=c.start)&&(c.end==null||i<=c.end))return!0}return!1}const ri={Left:1,Right:2,Center:4},ni={Left:0,Center:1,Right:2};function Xe(t){return t.button===void 0||t.button===ni.Left}function si(t){return t.buttons===void 0||(t.buttons&ri.Left)===0}function Qt(t){return!!t.targetTouches}const ii=1;function oi(t){const e=t.nodeType===ii?t:t.parentElement;if(!e)return;const{top:r,left:n}=e.getBoundingClientRect();return{x:n,y:r}}function ai(t,e){if(t.targetTouches.length===1)return Se(t.targetTouches[0]);if(e&&t.touches.length===1&&t.touches[0].target===e.target)return Se(t.touches[0])}function Se(t,e){return Qt(t)?ai(t,e):{x:t.clientX,y:t.clientY}}const It=(()=>{let t=!1;try{addEventListener("test",()=>{},Object.defineProperty({},"passive",{get(){return t=!0,!0}}))}catch{}return t})(),ae={[V.mouse]:{start:"mousedown",move:"mousemove",end:"mouseup",contextmenu:"contextmenu"},[V.touch]:{start:"touchstart",move:"touchmove",end:"touchend"},[V.keyboard]:{keydown:"keydown"}};class ue{profile(){var e;return{sourceNodes:this.sourceNodes.size,sourcePreviewNodes:this.sourcePreviewNodes.size,sourcePreviewNodeOptions:this.sourcePreviewNodeOptions.size,targetNodes:this.targetNodes.size,dragOverTargetIds:((e=this.dragOverTargetIds)===null||e===void 0?void 0:e.length)||0}}get document(){return this.options.document}setup(){const e=this.options.rootElement;e&&(b(!ue.isSetUp,"Cannot have two Touch backends at the same time."),ue.isSetUp=!0,this.addEventListener(e,"start",this.getTopMoveStartHandler()),this.addEventListener(e,"start",this.handleTopMoveStartCapture,!0),this.addEventListener(e,"move",this.handleTopMove),this.addEventListener(e,"move",this.handleTopMoveCapture,!0),this.addEventListener(e,"end",this.handleTopMoveEndCapture,!0),this.options.enableMouseEvents&&!this.options.ignoreContextMenu&&this.addEventListener(e,"contextmenu",this.handleTopMoveEndCapture),this.options.enableKeyboardEvents&&this.addEventListener(e,"keydown",this.handleCancelOnEscape,!0))}teardown(){const e=this.options.rootElement;e&&(ue.isSetUp=!1,this._mouseClientOffset={},this.removeEventListener(e,"start",this.handleTopMoveStartCapture,!0),this.removeEventListener(e,"start",this.handleTopMoveStart),this.removeEventListener(e,"move",this.handleTopMoveCapture,!0),this.removeEventListener(e,"move",this.handleTopMove),this.removeEventListener(e,"end",this.handleTopMoveEndCapture,!0),this.options.enableMouseEvents&&!this.options.ignoreContextMenu&&this.removeEventListener(e,"contextmenu",this.handleTopMoveEndCapture),this.options.enableKeyboardEvents&&this.removeEventListener(e,"keydown",this.handleCancelOnEscape,!0),this.uninstallSourceNodeRemovalObserver())}addEventListener(e,r,n,s=!1){const i=It?{capture:s,passive:!1}:s;this.listenerTypes.forEach(function(a){const c=ae[a][r];c&&e.addEventListener(c,n,i)})}removeEventListener(e,r,n,s=!1){const i=It?{capture:s,passive:!1}:s;this.listenerTypes.forEach(function(a){const c=ae[a][r];c&&e.removeEventListener(c,n,i)})}connectDragSource(e,r){const n=this.handleMoveStart.bind(this,e);return this.sourceNodes.set(e,r),this.addEventListener(r,"start",n),()=>{this.sourceNodes.delete(e),this.removeEventListener(r,"start",n)}}connectDragPreview(e,r,n){return this.sourcePreviewNodeOptions.set(e,n),this.sourcePreviewNodes.set(e,r),()=>{this.sourcePreviewNodes.delete(e),this.sourcePreviewNodeOptions.delete(e)}}connectDropTarget(e,r){const n=this.options.rootElement;if(!this.document||!n)return()=>{};const s=i=>{if(!this.document||!n||!this.monitor.isDragging())return;let a;switch(i.type){case ae.mouse.move:a={x:i.clientX,y:i.clientY};break;case ae.touch.move:var c,u;a={x:((c=i.touches[0])===null||c===void 0?void 0:c.clientX)||0,y:((u=i.touches[0])===null||u===void 0?void 0:u.clientY)||0};break}const h=a!=null?this.document.elementFromPoint(a.x,a.y):void 0,v=h&&r.contains(h);if(h===r||v)return this.handleMove(i,e)};return this.addEventListener(this.document.body,"move",s),this.targetNodes.set(e,r),()=>{this.document&&(this.targetNodes.delete(e),this.removeEventListener(this.document.body,"move",s))}}getTopMoveStartHandler(){return!this.options.delayTouchStart&&!this.options.delayMouseStart?this.handleTopMoveStart:this.handleTopMoveStartDelay}installSourceNodeRemovalObserver(e){this.uninstallSourceNodeRemovalObserver(),this.draggedSourceNode=e,this.draggedSourceNodeRemovalObserver=new MutationObserver(()=>{e&&!e.parentElement&&(this.resurrectSourceNode(),this.uninstallSourceNodeRemovalObserver())}),!(!e||!e.parentElement)&&this.draggedSourceNodeRemovalObserver.observe(e.parentElement,{childList:!0})}resurrectSourceNode(){this.document&&this.draggedSourceNode&&(this.draggedSourceNode.style.display="none",this.draggedSourceNode.removeAttribute("data-reactid"),this.document.body.appendChild(this.draggedSourceNode))}uninstallSourceNodeRemovalObserver(){this.draggedSourceNodeRemovalObserver&&this.draggedSourceNodeRemovalObserver.disconnect(),this.draggedSourceNodeRemovalObserver=void 0,this.draggedSourceNode=void 0}constructor(e,r,n){this.getSourceClientOffset=s=>{const i=this.sourceNodes.get(s);return i&&oi(i)},this.handleTopMoveStartCapture=s=>{Xe(s)&&(this.moveStartSourceIds=[])},this.handleMoveStart=s=>{Array.isArray(this.moveStartSourceIds)&&this.moveStartSourceIds.unshift(s)},this.handleTopMoveStart=s=>{if(!Xe(s))return;const i=Se(s);i&&(Qt(s)&&(this.lastTargetTouchFallback=s.targetTouches[0]),this._mouseClientOffset=i),this.waitingForDelay=!1},this.handleTopMoveStartDelay=s=>{if(!Xe(s))return;const i=s.type===ae.touch.start?this.options.delayTouchStart:this.options.delayMouseStart;this.timeout=setTimeout(this.handleTopMoveStart.bind(this,s),i),this.waitingForDelay=!0},this.handleTopMoveCapture=()=>{this.dragOverTargetIds=[]},this.handleMove=(s,i)=>{this.dragOverTargetIds&&this.dragOverTargetIds.unshift(i)},this.handleTopMove=s=>{if(this.timeout&&clearTimeout(this.timeout),!this.document||this.waitingForDelay)return;const{moveStartSourceIds:i,dragOverTargetIds:a}=this,c=this.options.enableHoverOutsideTarget,u=Se(s,this.lastTargetTouchFallback);if(!u)return;if(this._isScrolling||!this.monitor.isDragging()&&ti(this._mouseClientOffset.x||0,this._mouseClientOffset.y||0,u.x,u.y,this.options.scrollAngleRanges)){this._isScrolling=!0;return}if(!this.monitor.isDragging()&&this._mouseClientOffset.hasOwnProperty("x")&&i&&ei(this._mouseClientOffset.x||0,this._mouseClientOffset.y||0,u.x,u.y)>(this.options.touchSlop?this.options.touchSlop:0)&&(this.moveStartSourceIds=void 0,this.actions.beginDrag(i,{clientOffset:this._mouseClientOffset,getSourceClientOffset:this.getSourceClientOffset,publishSource:!1})),!this.monitor.isDragging())return;const h=this.sourceNodes.get(this.monitor.getSourceId());this.installSourceNodeRemovalObserver(h),this.actions.publishDragSource(),s.cancelable&&s.preventDefault();const v=(a||[]).map(f=>this.targetNodes.get(f)).filter(f=>!!f),m=this.options.getDropTargetElementsAtPoint?this.options.getDropTargetElementsAtPoint(u.x,u.y,v):this.document.elementsFromPoint(u.x,u.y),p=[];for(const f in m){if(!m.hasOwnProperty(f))continue;let g=m[f];for(g!=null&&p.push(g);g;)g=g.parentElement,g&&p.indexOf(g)===-1&&p.push(g)}const d=p.filter(f=>v.indexOf(f)>-1).map(f=>this._getDropTargetId(f)).filter(f=>!!f).filter((f,g,y)=>y.indexOf(f)===g);if(c)for(const f in this.targetNodes){const g=this.targetNodes.get(f);if(h&&g&&g.contains(h)&&d.indexOf(f)===-1){d.unshift(f);break}}d.reverse(),this.actions.hover(d,{clientOffset:u})},this._getDropTargetId=s=>{const i=this.targetNodes.keys();let a=i.next();for(;a.done===!1;){const c=a.value;if(s===this.targetNodes.get(c))return c;a=i.next()}},this.handleTopMoveEndCapture=s=>{if(this._isScrolling=!1,this.lastTargetTouchFallback=void 0,!!si(s)){if(!this.monitor.isDragging()||this.monitor.didDrop()){this.moveStartSourceIds=void 0;return}s.cancelable&&s.preventDefault(),this._mouseClientOffset={},this.uninstallSourceNodeRemovalObserver(),this.actions.drop(),this.actions.endDrag()}},this.handleCancelOnEscape=s=>{s.key==="Escape"&&this.monitor.isDragging()&&(this._mouseClientOffset={},this.uninstallSourceNodeRemovalObserver(),this.actions.endDrag())},this.options=new Zs(n,r),this.actions=e.getActions(),this.monitor=e.getMonitor(),this.sourceNodes=new Map,this.sourcePreviewNodes=new Map,this.sourcePreviewNodeOptions=new Map,this.targetNodes=new Map,this.listenerTypes=[],this._mouseClientOffset={},this._isScrolling=!1,this.options.enableMouseEvents&&this.listenerTypes.push(V.mouse),this.options.enableTouchEvents&&this.listenerTypes.push(V.touch),this.options.enableKeyboardEvents&&this.listenerTypes.push(V.keyboard)}}const ci=function(e,r={},n={}){return new ue(e,r,n)},ui=l.createContext({isCustomDndProviderSet:!1}),li=({children:t})=>o.jsx(o.Fragment,{children:t}),di=({customDndBackend:t,customDndBackendOptions:e,children:r})=>{const[n,s]=l.useState(),[i,a]=l.useState(!1),[c,u]=l.useState(!1),{isCustomDndProviderSet:h}=l.useContext(ui);l.useEffect(()=>{u("ontouchstart"in window),a(!0),s(window)},[]);const v=h?li:Kn;return i?n?o.jsx(v,Object.assign({backend:t||(c?ci:Bs),context:n,options:t?e:void 0},{children:r})):o.jsx(o.Fragment,{children:r}):null};function fi({boardContainer:t}){const{boardWidth:e,chessPieces:r,id:n,snapToCursor:s,allowDragOutsideBoard:i}=B(),a=bs(p=>({item:p.getItem(),clientOffset:p.getClientOffset(),sourceClientOffset:p.getSourceClientOffset(),isDragging:p.isDragging()})),{isDragging:c,item:u,clientOffset:h,sourceClientOffset:v}=a,m=l.useCallback((p,d)=>{if(!p||!d)return{display:"none"};let{x:f,y:g}=s?p:d;const y=e/8/2;if(s&&(f-=y,g-=y),!i){const{left:O,top:S}=t,T=O-y,I=S-y,k=O+e-y,G=S+e-y;f=Math.max(T,Math.min(f,k)),g=Math.max(I,Math.min(g,G))}const D=`translate(${f}px, ${g}px)`;return{transform:D,WebkitTransform:D,touchAction:"none"}},[e,i,s,t]);return c&&u.id===n?o.jsx("div",Object.assign({style:{position:"fixed",pointerEvents:"none",zIndex:10,left:0,top:0}},{children:o.jsx("div",Object.assign({style:m(h,v)},{children:typeof r[u.piece]=="function"?r[u.piece]({squareWidth:e/8,isDragging:!0}):o.jsx("svg",Object.assign({viewBox:"1 1 43 43",width:e/8,height:e/8},{children:o.jsx("g",{children:r[u.piece]})}))}))})):null}const pi=l.forwardRef((t,e)=>{const{customDndBackend:r,customDndBackendOptions:n,onBoardWidthChange:s}=t,i=Or(t,["customDndBackend","customDndBackendOptions","onBoardWidthChange"]),[a,c]=l.useState(t.boardWidth),u=l.useRef(null),h=l.useRef(null),[v,m]=l.useState({left:0,top:0}),p=l.useMemo(()=>{var d;return(d=u.current)===null||d===void 0?void 0:d.getBoundingClientRect()},[u.current]);return l.useEffect(()=>{a&&(s==null||s(a))},[a]),l.useEffect(()=>{m({left:p!=null&&p.left?p==null?void 0:p.left:0,top:p!=null&&p.top?p==null?void 0:p.top:0})},[p]),l.useEffect(()=>{var d;if(t.boardWidth===void 0&&(!((d=u.current)===null||d===void 0)&&d.offsetWidth)){const f=new ResizeObserver(()=>{var g;c((g=u.current)===null||g===void 0?void 0:g.offsetWidth)});return f.observe(u.current),()=>{f.disconnect()}}},[u.current]),o.jsx(Ks,{children:o.jsxs("div",Object.assign({ref:h,style:{display:"flex",flexDirection:"column",width:"100%"}},{children:[o.jsx("div",{ref:u,style:{width:"100%"}}),o.jsx(di,Object.assign({customDndBackend:r,customDndBackendOptions:n},{children:a&&o.jsxs(kr,Object.assign({boardWidth:a},i,{ref:e},{children:[o.jsx(fi,{boardContainer:v}),o.jsx(Qs,{})]}))}))]}))})});export{pi as C};
