var Vt=Object.defineProperty;var Jt=(t,s,r)=>s in t?Vt(t,s,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[s]=r;var Ae=(t,s,r)=>Jt(t,typeof s!="symbol"?s+"":s,r);import{r as i,j as e,a as Ge}from"./react-CvHEjaVo.js";import{c as Xt}from"./react-dom-D1dbQIcV.js";import{a as Qt}from"./axios-DGDcxXwr.js";import{i as xt}from"./i18next-D9VJDghF.js";import{B as Zt}from"./i18next-http-backend-BfZSjpC0.js";import{i as es,u as B}from"./react-i18next-CkKBCMHl.js";import{s as _,T as Ue,F as xe,I as Ce,B as ts}from"./antd-vw_2xf0X.js";import{F as ss}from"./react-icons-C3dNpHPf.js";import{u as oe,a as Le,O as gt,N as pt,L as ft,b as jt,R as rs,c as H,B as ns}from"./react-router-Dl3PYC8W.js";import{S as Fe,M as J,I as V,B as os,N as as,a as is,b as p,T as c,L as G,c as ls,D as Te,d as X,A as Ve,e as Je,C as se,f as N,g as cs,h as ds,i as bt,j as ee,k as te,G as E,l as vt,m as yt,n as St,o as hs,p as q,P as W,q as us,r as ms,s as M,t as xs,u as ce,v as be,H as fe,w as ze,x as de,y as he,z as ue,E as $e,F as $,J as we,K as me,O as He,Q as _e,R as gs,U as wt,V as Pe,W as ps,X as Ct,Y as Be,Z as ne,_ as fs,$ as kt,a0 as It,a1 as ge,a2 as Y,a3 as Nt,a4 as js,a5 as Xe,a6 as Oe,a7 as qe,a8 as bs,a9 as vs,aa as Pt,ab as ys,ac as Ss,ad as _t,ae as Ft,af as Et,ag as Dt,ah as At,ai as le,aj as ws,ak as Cs,al as ks,am as Is,an as Ns,ao as Ps,ap as _s,aq as Fs,ar as ke,as as Es,at as Qe,au as Ds,av as As,aw as Rs,ax as Ms,ay as Ws,az as Ls,aA as Ts}from"./@mui-D847rJGD.js";import{f as zs,x as $s,y as Hs,z as Bs,A as Ie,B as Os,C as qs,D as Ks,E as Ys}from"./@ant-design-Bks4O0NN.js";import{S as Ze,C as et}from"./react-transition-group-CwyNQDxX.js";import{h as U}from"./moment-C5S46NFB.js";import{m as Rt,C as Mt}from"./react-big-calendar-D6ss7NAI.js";import{C as pe}from"./chess.js-D61LfqgS.js";import{C as Wt}from"./react-chessboard-D79mwW4A.js";import"./classnames-D3cBJY9G.js";import"./scheduler-CKyTKYc2.js";import"./rc-util-SZQLh1vV.js";import"./@babel-DlrNZQSW.js";import"./rc-resize-observer-MNGAtJ6Y.js";import"./resize-observer-polyfill-B1PUzC5B.js";import"./rc-motion-csAWsXJs.js";import"./@rc-component-COpoWvuY.js";import"./dayjs-QiaqYO4y.js";import"./rc-input-Byq_4lnI.js";import"./rc-field-form-Zk3m5T-Z.js";import"./scroll-into-view-if-needed-BZeNfFF0.js";import"./compute-scroll-into-view-DWa9QgjM.js";import"./rc-notification-DFa78zIu.js";import"./rc-pagination-DP2MtHOE.js";import"./rc-picker-CirFycse.js";import"./rc-tooltip-CR8cfE2b.js";import"./rc-textarea-CTz5dyJK.js";import"./copy-to-clipboard-CfLLryBf.js";import"./toggle-selection-DGa8lynz.js";import"./cookie--_YQFYBD.js";import"./clsx-B-dksMZM.js";import"./@emotion-M6yQISDD.js";import"./hoist-non-react-statics-C-Qo8PK8.js";import"./stylis-YPZU7XtI.js";import"./@popperjs-B2yVk2E7.js";import"./dom-helpers-CYz2yaWn.js";import"./invariant-CtPH8gXt.js";import"./uncontrollable-BvgrQciZ.js";import"./react-lifecycles-compat-AfN2QaV3.js";import"./prop-types-C2eHv_HJ.js";import"./date-arithmetic-DrY26MJF.js";import"./lodash-CuwxRx_k.js";import"./react-overlays-pU_wA3Zj.js";import"./@restart-DNSoxZk-.js";import"./warning-pKr2A9xR.js";import"./memoize-one-BdPwpGay.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))o(n);new MutationObserver(n=>{for(const a of n)if(a.type==="childList")for(const d of a.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&o(d)}).observe(document,{childList:!0,subtree:!0});function r(n){const a={};return n.integrity&&(a.integrity=n.integrity),n.referrerPolicy&&(a.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?a.credentials="include":n.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function o(n){if(n.ep)return;n.ep=!0;const a=r(n);fetch(n.href,a)}})();xt.use(Zt).use(es).init({backend:{loadPath:"/locales/{{lng}}/{{ns}}.json"},lng:"en",fallbackLng:"en",interpolation:{escapeValue:!1},debug:!0});const Gs="http://localhost:3000/api",A=Qt.create({baseURL:Gs,withCredentials:!0}),tt=t=>t==null?void 0:t.reduce((s,r)=>s+=r,""),ye=(t,s)=>(_.error({message:"Ошибка",description:s}),Promise.reject(t));A.interceptors.request.use(t=>{const s=localStorage.getItem("token");s&&(t.headers.Authorization=`Bearer ${s}`);const r=xt.language;return r&&(t.headers["Accept-Language"]=r),t},t=>Promise.reject(t));A.interceptors.response.use(t=>t,t=>{var s,r,o,n,a;if(((s=t.response)==null?void 0:s.status)===401)return _.error({message:"Сессия истекла",description:((o=(r=t.response)==null?void 0:r.data)==null?void 0:o.message)||"Пожалуйста, войдите в систему снова."}),localStorage.removeItem("token"),localStorage.removeItem("user"),window.location.href="/login",new Promise(()=>{});if(((n=t.response)==null?void 0:n.status)!==504){if(t.message==="Network Error"||!t.response)return ye(t,"Ошибка сети или сервер недоступен. Попробуйте позже.");const d=(a=t.response)==null?void 0:a.data;let m=typeof d=="string"?d:"";if(Array.isArray(d))return ye(t,tt(d));if(Array.isArray(d==null?void 0:d.data))return ye(t,tt(d.data));if(d!=null&&d.detail)return ye(t,d.detail);if(d instanceof Object){const u=d.msg||Object.keys(d).reduce((f,v)=>{var b;return f+=`${v}: ${((b=d[v])==null?void 0:b[0])||d[v]} `},"");return ye(t,u)}_.error({message:"Ошибка",description:m||t.message})}return Promise.reject(t)});const We=async()=>(await A.get("/auth/profile")).data,st=async t=>{const s=new FormData;return Object.keys(t).forEach(o=>{const n=t[o];n&&s.append(o,n)}),(await A.put("/auth/profile",s)).data},Lt=t=>{const s=A.defaults.baseURL;return s?`${s}/auth/avatar/${t}`:"/default-avatar.png"},Tt=async t=>(await A.get(`/auth/profile/${t}`)).data,ve=i.createContext(void 0),Us=({children:t})=>{const[s,r]=i.useState(!1),[o,n]=i.useState(null),[a,d]=i.useState(!0);i.useEffect(()=>{(async()=>{if(localStorage.getItem("token"))try{const l=await We();n(l),r(!0)}catch(l){console.error("Session token is invalid, logging out.",l),u()}d(!1)})()},[]);const m=(b,x)=>{localStorage.setItem("token",b),localStorage.setItem("user",JSON.stringify(x)),r(!0)},u=()=>{localStorage.removeItem("token"),localStorage.removeItem("user"),n(null),r(!1)},v={isAuthenticated:s,user:o,loading:a,login:m,logout:u,refetchUser:async()=>{d(!0);try{const b=await We();n(b)}catch(b){console.error("Failed to refetch user data",b),u()}finally{d(!1)}}};return e.jsx(ve.Provider,{value:v,children:t})},Vs=async t=>(await A.post("/auth/login",t)).data,Js=async t=>{try{return(await A.post("/auth/register",t)).data}catch(s){throw console.error("Registration failed",s),s}},rt=t=>[{required:!0,message:t("validation.required")},{validator:(s,r)=>r&&r.length>=2?Promise.resolve():Promise.reject(new Error(t("validation.name_length")))}],Xs=t=>[{required:!0,message:t("validation.required")},{type:"email",message:t("validation.invalid_email")}],Qs=t=>[{required:!0,message:t("validation.required")},{min:6,message:t("validation.password_length")}],Zs=({mode:t})=>{const{t:s}=B(),r=oe(),o=i.useContext(ve);if(!o)throw new Error("AuthForm must be used within an AuthProvider");const{login:n}=o,a=t==="login",d=async u=>{var f,v;try{const{token:b,user:x}=await Vs(u);n(b,x),r(`/profile-test/${x._id}`,{replace:!0}),_.success({message:s("auth.success.login_title"),description:s("auth.success.welcome_back",{name:x.firstName})})}catch(b){_.error({message:s("auth.errors.login"),description:((v=(f=b.response)==null?void 0:f.data)==null?void 0:v.msg)||s("auth.errors.invalid_credentials")})}},m=async u=>{var f,v;try{const x=(await Js(u)).email;r("/verify-email",{replace:!0,state:{email:x,firstName:u.firstName,lastName:u.lastName}}),_.success({message:s("register.success.title"),description:s("register.success.description")})}catch(b){_.error({message:s("register.error.title"),description:((v=(f=b.response)==null?void 0:f.data)==null?void 0:v.msg)||s("register.error.description")})}};return e.jsxs("div",{className:"auth-form-container",children:[e.jsxs("div",{className:"auth-header",onClick:()=>r("/"),children:[e.jsx(ss,{className:"auth-header__icon"}),e.jsx(Ue.Title,{level:4,className:"auth-header__brand",children:s("common.brand")})]}),e.jsx(Ue.Title,{level:3,className:"auth-header__title",children:s(a?"auth.sign_in":"register.title")}),e.jsxs(xe,{name:t,onFinish:a?d:m,layout:"vertical",className:"auth-form-body",size:"large",autoComplete:"off",children:[!a&&e.jsxs(e.Fragment,{children:[e.jsx(xe.Item,{label:e.jsx("span",{className:"auth-form-label",children:s("register.name")}),name:"firstName",rules:rt(s),children:e.jsx(Ce,{placeholder:s("register.placeholder.name")})}),e.jsx(xe.Item,{label:e.jsx("span",{className:"auth-form-label",children:s("register.lastName")}),name:"lastName",rules:rt(s),children:e.jsx(Ce,{placeholder:s("register.placeholder.lastName")})})]}),e.jsx(xe.Item,{label:e.jsx("span",{className:"auth-form-label",children:s("common.email")}),name:"email",rules:Xs(s),children:e.jsx(Ce,{placeholder:s("common.placeholder.email")})}),e.jsx(xe.Item,{label:e.jsx("span",{className:"auth-form-label",children:s("common.password")}),name:"password",rules:Qs(s),children:e.jsx(Ce.Password,{placeholder:s("common.placeholder.password")})}),e.jsx(xe.Item,{children:e.jsx(ts,{type:"primary",htmlType:"submit",className:"auth-form-button",block:!0,children:s(a?"auth.sign_in":"register.submit")})})]}),e.jsx("div",{className:"auth-form-footer",children:a?e.jsxs(e.Fragment,{children:[s("auth.no_account")," ",e.jsx("a",{className:"auth-form-link",onClick:()=>r("/register"),children:s("auth.sign_up")})]}):e.jsxs(e.Fragment,{children:[s("register.haveAccount")," ",e.jsx("a",{className:"auth-form-link",onClick:()=>r("/login"),children:s("register.login")})]})})]})},nt=()=>{const s=Le().pathname.includes("register")?"register":"login";return e.jsx("div",{className:"auth-page-wrapper",children:e.jsx(Zs,{mode:s})})},er=({className:t})=>{const{i18n:s}=B(),r=o=>{const n=o.target.value;s.changeLanguage(n)};return e.jsxs(Fe,{value:s.language,onChange:r,size:"small",className:t,style:{color:"black",borderColor:"black"},children:[e.jsx(J,{value:"en",children:"EN"}),e.jsx(J,{value:"pl",children:"PL"}),e.jsx(J,{value:"uk",children:"UA"})]})},Ke=async t=>(await A.post("/notifications",t)).data,tr=async()=>(await A.get("/notifications")).data,sr=async t=>(await A.patch("/notifications",{},{params:{notification_id:t}})).data,rr=async t=>(await A.delete("/notifications",{params:{notification_id:t}})).data,nr=({navigateToRequests:t})=>{const[s,r]=i.useState([]),[o,n]=i.useState(null),a=!!o,d=s.filter(l=>!l.read).length,m=async()=>{try{const l=await tr();r(Array.isArray(l)?l:[])}catch(l){console.error("Ошибка при получении уведомлений:",l)}};i.useEffect(()=>{m();const l=setInterval(m,3e4);return()=>clearInterval(l)},[]);const u=l=>{n(l.currentTarget),m()},f=()=>{n(null)},v=async(l,g)=>{l.stopPropagation();try{await rr(g),r(j=>j.filter(k=>k._id!==g))}catch(j){console.error("Ошибка при удалении уведомления:",j)}},b=l=>{l.read||(sr(l._id),r(g=>g.map(j=>j._id===l._id?{...j,read:!0}:j))),(l.type==="request"||l.type==="homework_submission")&&t(),f()},x=()=>{t(),f()};return e.jsxs("div",{children:[e.jsx(V,{color:"inherit",onClick:u,children:e.jsx(os,{badgeContent:d,color:"error",children:e.jsx(as,{})})}),e.jsxs(is,{anchorEl:o,open:a,onClose:f,PaperProps:{style:{maxHeight:300,width:"400px"}},children:[e.jsx(p,{sx:{p:2,borderBottom:"1px solid #eee"},children:e.jsx(c,{variant:"h6",children:"Уведомления"})}),s.length===0?e.jsx(J,{disabled:!0,children:"Уведомлений нет"}):s.map(l=>e.jsxs(J,{onClick:()=>b(l),sx:{bgcolor:l.read?"transparent":"action.hover",whiteSpace:"normal",alignItems:"flex-start"},children:[e.jsx(G,{primary:l.content,secondary:new Date(l.createdAt).toLocaleString()}),e.jsx(ls,{children:e.jsx(V,{edge:"end","aria-label":"delete",onClick:g=>v(g,l._id),children:e.jsx(Te,{fontSize:"small"})})})]},l._id)),e.jsx(X,{}),e.jsx(J,{onClick:x,children:e.jsx(G,{primary:"Посмотреть все во 'Входящих'",sx:{textAlign:"center"}})})]})]})},or=()=>{var k,F,D;const[t,s]=i.useState(!1),r=oe(),{t:o}=B(),n=i.useContext(ve);if(!n||n.loading)return e.jsx(Ve,{position:"static",className:"navbar-appbar",children:e.jsxs(Je,{className:"navbar-toolbar",sx:{justifyContent:"space-between"},children:[e.jsx(c,{variant:"h6",className:"navbar-title",children:o("navbar.chessSchool")}),e.jsx(se,{color:"inherit",size:24})]})});const{isAuthenticated:a,user:d,logout:m}=n,u=(k=d==null?void 0:d.roles)==null?void 0:k.includes("admin"),f=(F=d==null?void 0:d.roles)==null?void 0:F.includes("coach"),v=(D=d==null?void 0:d.roles)==null?void 0:D.includes("student"),b=()=>{m&&m(),s(!1),r("/login")},x=()=>{s(!1),r("/register")},l=()=>{r("/inbox")},g=C=>()=>{s(C)},j=C=>{s(!1),C==="/profile"&&(d!=null&&d._id)?r(`/profile/${d._id}`):r(C)};return e.jsxs(e.Fragment,{children:[e.jsx(Ve,{position:"static",className:"navbar-appbar",children:e.jsxs(Je,{className:"navbar-toolbar",children:[e.jsx(c,{variant:"h6",className:"navbar-title",onClick:()=>r("/"),children:o("navbar.chessSchool")}),e.jsxs(p,{className:"navbar-controls",children:[!a&&e.jsxs(p,{sx:{display:{xs:"none",md:"flex"},alignItems:"center"},children:[e.jsx(N,{color:"inherit",onClick:()=>r("/login"),children:o("navbar.login")}),e.jsx(N,{variant:"contained",color:"secondary",onClick:()=>r("/register"),sx:{ml:1},children:o("navbar.register")})]}),a&&e.jsx(nr,{navigateToRequests:l}),e.jsx(V,{edge:"end",color:"inherit","aria-label":"menu",onClick:g(!0),className:"navbar-menu-button",children:e.jsx(cs,{})})]})]})}),e.jsx(ds,{anchor:"right",open:t,onClose:g(!1),children:e.jsxs(p,{className:"navbar-drawer",children:[e.jsx(p,{className:"drawer-header",children:e.jsx(V,{onClick:g(!1),className:"close-button",children:e.jsx(zs,{className:"close-icon"})})}),e.jsxs(bt,{className:"menu-list",children:[e.jsxs(ee,{onClick:()=>j("/"),className:"menu-item",children:[e.jsx(te,{children:e.jsx($s,{})}),e.jsx(G,{primary:o("navbar.home")})]}),e.jsxs(ee,{onClick:()=>j("/about"),className:"menu-item",children:[e.jsx(te,{children:e.jsx(Hs,{})}),e.jsx(G,{primary:o("navbar.aboutUs")})]}),e.jsxs(ee,{onClick:()=>j("/achievements"),className:"menu-item",children:[e.jsx(te,{children:e.jsx(Bs,{})}),e.jsx(G,{primary:o("navbar.achievements")})]}),e.jsxs(ee,{onClick:()=>j("/coaches"),className:"menu-item",children:[e.jsx(te,{children:e.jsx(Ie,{})}),e.jsx(G,{primary:o("navbar.coaches")})]}),a&&e.jsx(X,{sx:{borderColor:"rgba(255, 255, 255, 0.12)"}}),a&&e.jsxs(e.Fragment,{children:[e.jsxs(ee,{onClick:()=>j("/analysis"),className:"menu-item",children:[e.jsx(te,{children:e.jsx(Os,{})}),e.jsx(G,{primary:o("navbar.chessGame")})]}),e.jsxs(ee,{onClick:()=>j("/profile"),className:"menu-item",children:[e.jsx(te,{children:e.jsx(qs,{})}),e.jsx(G,{primary:o("navbar.profile")})]})]}),(f||u||v)&&e.jsx(X,{sx:{borderColor:"rgba(255, 255, 255, 0.12)"}}),(f||u)&&e.jsxs(ee,{onClick:()=>j("/students"),className:"menu-item",children:[e.jsx(te,{children:e.jsx(Ie,{})}),e.jsx(G,{primary:o("navbar.students")})]}),(f||u||v)&&e.jsxs(ee,{onClick:()=>j("/students-shedule"),className:"menu-item",children:[e.jsx(te,{children:e.jsx(Ie,{})}),e.jsx(G,{primary:o("navbar.students-shedule")})]}),u&&e.jsxs(ee,{onClick:()=>j("/users"),className:"menu-item",children:[e.jsx(te,{children:e.jsx(Ie,{})}),e.jsx(G,{primary:o("navbar.users")})]})]}),e.jsxs(p,{className:"drawer-bottom-actions",children:[a?e.jsxs(N,{onClick:b,className:"logout-button",children:[e.jsx(Ks,{}),o("navbar.logout")]}):e.jsxs(N,{onClick:x,className:"get-started-button",variant:"contained",color:"secondary",children:[e.jsx(Ys,{style:{marginRight:"8px"}}),o("navbar.getStarted")]}),e.jsx(er,{className:"language-switcher"})]})]})})]})},ar=async()=>(await A.get("/coaches")).data,zt=async t=>(await A.get(`/coach/${t}`)).data,ir=async t=>(await A.post("/auth/coaches-by-email",{emails:t})).data,lr=async(t,s)=>(await A.get("/trainer/student",{params:{coachEmail:t,studentId:s}})).data,cr=async t=>(await A.get("/trainer/students",{params:{coachEmail:t}})).data,dr=async(t,s)=>{await A.delete("/trainer/remove-student",{params:{coachEmail:t,studentId:s}})},hr=()=>{const{t}=B(),s=oe(),[r,o]=i.useState([]);return i.useEffect(()=>{(async()=>{const a=await ir(["ad3@example.com","ad7@example.com"]);o(a)})()},[]),e.jsxs(p,{py:10,px:2,sx:{backgroundColor:"#111"},children:[e.jsx(c,{variant:"h4",fontWeight:"bold",textAlign:"center",mb:6,children:t("homePage.coaches.title")}),e.jsx(E,{container:!0,spacing:4,justifyContent:"center",children:r.map(n=>e.jsx(E,{item:!0,xs:12,sm:6,md:3,children:e.jsxs(vt,{sx:{backgroundColor:"#1a1a1a",color:"white",borderRadius:3,boxShadow:4,position:"relative","&:hover .hoverAction":{opacity:1}},children:[e.jsx(yt,{component:"img",height:"200",image:n.photoUrl||"/images/default-avatar.png",alt:`${n.firstName} ${n.lastName}`}),e.jsxs(St,{children:[e.jsxs(c,{variant:"h6",children:[n.firstName," ",n.lastName]}),e.jsx(c,{variant:"body2",color:"gray"}),e.jsx(p,{mt:1,children:[...Array(5)].map((a,d)=>e.jsx(hs,{sx:{color:"#FFD700",fontSize:20}},d))})]}),e.jsx(p,{className:"hoverAction",sx:{position:"absolute",bottom:16,left:0,right:0,textAlign:"center",opacity:0,transition:"0.3s"},children:e.jsx(N,{variant:"contained",onClick:()=>s("/coaches",{state:{coach:n}}),sx:{backgroundColor:"#FFD700",color:"black"},children:t("homePage.coaches.selectCoach")})})]})},n._id))})]})},ur=()=>{const{t}=B(),s=oe(),r=new Date().getFullYear(),o=[{icon:"🎯",key:"analytics",descKey:"descAnalytics"},{icon:"🧠",key:"memory",descKey:"descMemory"},{icon:"🏆",key:"spirit",descKey:"descSpirit"}],n=[{num:"1",titleKey:"step1Title",descKey:"step1Desc"},{num:"2",titleKey:"step2Title",descKey:"step2Desc"},{num:"3",titleKey:"step3Title",descKey:"step3Desc"}],a=[{type:"individual",icon:e.jsx(us,{sx:{fontSize:40,mb:2,color:"#FFD700"}}),descKey:"descIndividual",buttonKey:"schedule",path:"/coaches"},{type:"group",icon:e.jsx(ms,{sx:{fontSize:40,mb:2,color:"#FFD700"}}),descKey:"descGroup",buttonKey:"learnMore",path:"/classes"}];return e.jsxs(p,{sx:{backgroundColor:"#0e0e0e",color:"white",fontFamily:"'Inter', sans-serif"},children:[e.jsx(p,{sx:{backgroundImage:{xs:'url("/images/chess-cinematic-mb.jpg")',sm:'url("/images/chess-cinematic-tablet.jpg")',lg:'url("/images/chess-cinematic-lg.jpg")'},backgroundSize:"cover",backgroundPosition:"center",py:{xs:10,md:20},textAlign:"center",display:"flex",flexDirection:"column",alignItems:"center",px:2},children:e.jsxs(q,{maxWidth:"md",children:[e.jsx(c,{variant:"h2",component:"h1",fontWeight:"bold",children:t("homePage.hero.title")}),e.jsx(c,{variant:"h5",mt:2,sx:{color:"rgba(255, 255, 255, 0.9)"},children:t("homePage.hero.subtitle")}),e.jsx(N,{variant:"contained",size:"large",onClick:()=>s("/coaches"),sx:{mt:4,px:5,py:1.5,borderRadius:"30px",boxShadow:"0px 8px 20px rgba(255, 215, 0, 0.3)",backgroundColor:"#FFD700",color:"black",fontWeight:"bold","&:hover":{backgroundColor:"#FFC107",transform:"translateY(-2px)",boxShadow:"0px 10px 25px rgba(255, 215, 0, 0.4)"},transition:"all 0.3s ease"},startIcon:e.jsx("span",{style:{fontSize:"1.5rem"},children:"♟️"}),children:t("homePage.hero.start")})]})}),e.jsxs(q,{maxWidth:"lg",sx:{py:10},children:[e.jsx(c,{variant:"h3",component:"h2",fontWeight:"bold",textAlign:"center",mb:8,children:t("homePage.why.title")}),e.jsx(E,{container:!0,spacing:4,justifyContent:"center",children:o.map(({icon:d,key:m,descKey:u})=>e.jsx(E,{item:!0,xs:12,sm:6,md:4,children:e.jsxs(W,{elevation:6,sx:{p:4,textAlign:"center",borderRadius:4,backgroundColor:"rgba(255,255,255,0.05)",backdropFilter:"blur(10px)",transition:"all 0.3s ease",color:"white",height:"100%","&:hover":{transform:"translateY(-10px)",backgroundColor:"rgba(255,255,255,0.1)"}},children:[e.jsx(p,{fontSize:"3.5rem",children:d}),e.jsx(c,{variant:"h5",component:"h3",mt:2,fontWeight:"bold",children:t(`homePage.why.${m}`)}),e.jsx(c,{mt:1.5,sx:{color:"rgba(255, 255, 255, 0.7)"},children:t(`homePage.why.${u}`)})]})},m))})]}),e.jsx(p,{sx:{py:5},children:e.jsx(hr,{})}),e.jsx(p,{sx:{py:10,backgroundColor:"#121212"},children:e.jsxs(q,{maxWidth:"lg",children:[e.jsx(c,{variant:"h3",component:"h2",fontWeight:"bold",textAlign:"center",mb:8,children:t("homePage.howItWorks.title")}),e.jsx(E,{container:!0,spacing:5,children:n.map(({num:d,titleKey:m,descKey:u})=>e.jsx(E,{item:!0,xs:12,md:4,children:e.jsxs(p,{sx:{textAlign:{xs:"center",md:"left"}},children:[e.jsx(c,{variant:"h1",component:"div",fontWeight:"bold",sx:{color:"#FFD700",opacity:.5},children:d}),e.jsx(c,{variant:"h5",component:"h3",fontWeight:"bold",mt:1,children:t(`homePage.howItWorks.${m}`)}),e.jsx(c,{mt:1.5,sx:{color:"rgba(255, 255, 255, 0.7)"},children:t(`homePage.howItWorks.${u}`)})]})},d))})]})}),e.jsxs(q,{maxWidth:"lg",sx:{py:10},children:[e.jsx(c,{variant:"h3",component:"h2",fontWeight:"bold",textAlign:"center",mb:8,children:t("homePage.formats.title")}),e.jsx(E,{container:!0,spacing:4,justifyContent:"center",children:a.map(({type:d,icon:m,descKey:u,buttonKey:f,path:v})=>e.jsx(E,{item:!0,xs:12,md:5,children:e.jsxs(W,{elevation:6,sx:{p:4,backgroundColor:"#1c1c1c",color:"white",borderRadius:4,textAlign:"center",transition:"background-color 0.3s ease",display:"flex",flexDirection:"column",alignItems:"center",height:"100%","&:hover":{backgroundColor:"#2a2a2a"}},children:[m,e.jsx(c,{variant:"h5",component:"h3",fontWeight:"bold",children:t(`homePage.formats.${d}`)}),e.jsx(c,{mt:1.5,sx:{color:"rgba(255, 255, 255, 0.7)",flexGrow:1},children:t(`homePage.formats.${u}`)}),e.jsxs(N,{variant:"outlined",onClick:()=>s(v),sx:{mt:3,color:"#FFD700",borderColor:"#FFD700",borderRadius:"20px","&:hover":{borderColor:"#FFC107",backgroundColor:"rgba(255, 215, 0, 0.1)"}},children:[t(`homePage.formats.${f}`)," →"]})]})},d))})]}),e.jsx(p,{component:"footer",py:6,px:2,sx:{backgroundColor:"#0b0b0b",color:"gray"},children:e.jsxs(q,{maxWidth:"lg",children:[e.jsxs(E,{container:!0,spacing:5,children:[e.jsxs(E,{item:!0,xs:12,sm:4,children:[e.jsx(c,{variant:"h6",fontWeight:"bold",sx:{color:"white"},children:t("homePage.footer.name")}),e.jsx(c,{variant:"body2",sx:{mt:1,color:"rgba(255,255,255,0.5)"},children:t("homePage.footer.desc")})]}),e.jsxs(E,{item:!0,xs:6,sm:2,children:[e.jsx(c,{fontWeight:"bold",sx:{color:"white"},children:t("homePage.footer.company")}),e.jsx(N,{size:"small",sx:{color:"gray",display:"block",p:"6px 0"},children:t("homePage.footer.about")}),e.jsx(N,{size:"small",sx:{color:"gray",display:"block",p:"6px 0"},children:t("homePage.footer.blog")}),e.jsx(N,{size:"small",sx:{color:"gray",display:"block",p:"6px 0"},children:t("homePage.footer.coaches")})]}),e.jsxs(E,{item:!0,xs:6,sm:2,children:[e.jsx(c,{fontWeight:"bold",sx:{color:"white"},children:t("homePage.footer.resources")}),e.jsx(N,{size:"small",sx:{color:"gray",display:"block",p:"6px 0"},children:t("homePage.footer.faq")}),e.jsx(N,{size:"small",sx:{color:"gray",display:"block",p:"6px 0"},children:t("homePage.footer.contact")})]}),e.jsxs(E,{item:!0,xs:6,sm:2,children:[e.jsx(c,{fontWeight:"bold",sx:{color:"white"},children:t("homePage.footer.legal")}),e.jsx(N,{size:"small",sx:{color:"gray",display:"block",p:"6px 0"},children:t("homePage.footer.privacy")}),e.jsx(N,{size:"small",sx:{color:"gray",display:"block",p:"6px 0"},children:t("homePage.footer.terms")})]})]}),e.jsx(X,{sx:{my:4,borderColor:"rgba(255, 255, 255, 0.1)"}}),e.jsx(c,{variant:"body2",textAlign:"center",sx:{color:"rgba(255,255,255,0.4)"},children:t("homePage.footer.copyright",{year:r})})]})})]})},mr=()=>{const{t}=B(),s=oe(),r=i.useMemo(()=>t("aboutPage.phrases",{returnObjects:!0})||[],[t]),o=i.useMemo(()=>t("aboutPage.testimonials.reviews",{returnObjects:!0})||[],[t]),n=i.useMemo(()=>t("aboutPage.ourCoaches.coaches",{returnObjects:!0})||[],[t]),a=i.useMemo(()=>t("aboutPage.whyUs.cards",{returnObjects:!0})||[],[t]),d=i.useMemo(()=>t("aboutPage.howItWorks.steps",{returnObjects:!0})||[],[t]),m=i.useMemo(()=>t("aboutPage.mission.points",{returnObjects:!0})||[],[t]),[u,f]=i.useState(0),[v,b]=i.useState(0);return i.useEffect(()=>{if(r.length===0||o.length===0)return;const x=setInterval(()=>{f(g=>(g+1)%r.length)},4e3),l=setInterval(()=>{b(g=>(g+1)%o.length)},5e3);return()=>{clearInterval(x),clearInterval(l)}},[r.length,o.length]),e.jsxs(p,{sx:{bgcolor:"#0e0e0e",color:"white"},children:[e.jsx(p,{sx:{position:"relative",py:{xs:10,md:15},textAlign:"center",backgroundImage:'linear-gradient(rgba(0,0,0,0.7), rgba(0,0,0,0.8)), url("/images/chess-cinematic-lg.jpg")',backgroundSize:"cover",backgroundPosition:"center",backgroundAttachment:"fixed"},children:e.jsxs(q,{maxWidth:"md",children:[e.jsx(c,{variant:"h2",component:"h1",fontWeight:"bold",sx:{textTransform:"uppercase",letterSpacing:"2px"},children:t("aboutPage.mainTitle")}),e.jsx(p,{sx:{height:"2.5em",my:2},children:e.jsx(Ze,{mode:"out-in",children:e.jsx(et,{timeout:300,classNames:"fade",children:e.jsx(c,{variant:"h5",sx:{color:"#FFD700",fontStyle:"italic"},children:r.length>0?r[u]:""})},u)})}),e.jsxs(M,{direction:{xs:"column",sm:"row"},justifyContent:"center",spacing:2,mt:4,children:[e.jsx(N,{variant:"contained",onClick:()=>s("/register"),size:"large",sx:{bgcolor:"#FFD700",color:"black",borderRadius:"30px",px:5,"&:hover":{bgcolor:"#FFC107"}},children:t("aboutPage.ctaStudent")}),e.jsx(N,{variant:"outlined",onClick:()=>s("/coaches"),size:"large",sx:{color:"white",borderColor:"rgba(255,255,255,0.5)",borderRadius:"30px",px:5,"&:hover":{borderColor:"white",bgcolor:"rgba(255,255,255,0.1)"}},children:t("aboutPage.ctaCoaches")})]})]})}),e.jsxs(q,{maxWidth:"lg",sx:{py:8},children:[e.jsxs(p,{sx:{textAlign:"center",my:8},children:[e.jsxs(M,{direction:"row",spacing:2,justifyContent:"center",alignItems:"center",sx:{color:"#FFD700",mb:1},children:[e.jsx(xs,{fontSize:"large"}),e.jsx(c,{variant:"h4",component:"h2",fontWeight:"bold",children:t("aboutPage.mission.title")})]}),e.jsx(c,{variant:"h6",sx:{maxWidth:720,mx:"auto",color:"rgba(255,255,255,0.7)",mb:3},children:t("aboutPage.mission.subtitle")}),e.jsx(M,{direction:{xs:"column",sm:"row"},spacing:2,justifyContent:"center",children:m.map((x,l)=>e.jsxs(M,{direction:"row",alignItems:"center",spacing:1,children:[e.jsx(ce,{sx:{color:"success.main"}}),e.jsx(c,{children:x})]},l))})]}),e.jsx(X,{sx:{my:8,borderColor:"rgba(255,255,255,0.2)"}}),e.jsxs(p,{sx:{my:8},children:[e.jsx(c,{variant:"h4",component:"h2",fontWeight:"bold",align:"center",sx:{mb:6},children:t("aboutPage.whyUs.title")}),e.jsx(E,{container:!0,spacing:4,children:a.map((x,l)=>e.jsx(E,{item:!0,xs:12,md:4,children:e.jsxs(W,{sx:{p:4,bgcolor:"#1c1c1c",borderRadius:4,textAlign:"center",height:"100%",transition:"all 0.3s ease","&:hover":{transform:"translateY(-10px)",boxShadow:"0 10px 20px rgba(255,215,0,0.15)"}},children:[e.jsx(c,{fontSize:"3rem",children:x.icon}),e.jsx(c,{variant:"h6",fontWeight:"bold",my:1,children:x.title}),e.jsx(c,{sx:{color:"rgba(255,255,255,0.6)"},children:x.description})]})},l))})]}),e.jsxs(p,{sx:{my:8,py:6,bgcolor:"#1c1c1c",borderRadius:4},children:[e.jsx(c,{variant:"h4",component:"h2",fontWeight:"bold",align:"center",sx:{mb:6},children:t("aboutPage.howItWorks.title")}),e.jsx(E,{container:!0,spacing:4,sx:{px:4},children:d.map((x,l)=>e.jsx(E,{item:!0,xs:12,md:4,children:e.jsxs(M,{direction:"row",spacing:2,alignItems:"center",children:[e.jsx(c,{variant:"h2",fontWeight:"bold",sx:{color:"#FFD700",opacity:.5},children:`0${l+1}`}),e.jsxs(p,{children:[e.jsx(c,{variant:"h6",fontWeight:"bold",children:x.step}),e.jsx(c,{sx:{color:"rgba(255,255,255,0.6)"},children:x.desc})]})]})},l))})]}),e.jsxs(E,{container:!0,spacing:8,sx:{my:8},children:[e.jsxs(E,{item:!0,xs:12,md:6,children:[e.jsx(c,{variant:"h4",component:"h2",fontWeight:"bold",sx:{mb:3},children:t("aboutPage.testimonials.title")}),e.jsx(W,{sx:{p:4,bgcolor:"#1c1c1c",borderRadius:4,minHeight:180},children:e.jsx(Ze,{children:e.jsx(et,{timeout:300,classNames:"fade",children:e.jsx(p,{children:o.length>0?e.jsxs(e.Fragment,{children:[e.jsxs(c,{fontStyle:"italic",fontSize:"1.1rem",sx:{color:"rgba(255,255,255,0.8)"},children:["“",o[v].quote,"”"]}),e.jsxs(c,{fontWeight:"bold",mt:2,sx:{color:"#FFD700"},children:["— ",o[v].name]})]}):null})},v)})})]}),e.jsxs(E,{item:!0,xs:12,md:6,children:[e.jsx(c,{variant:"h4",component:"h2",fontWeight:"bold",sx:{mb:3},children:t("aboutPage.ourCoaches.title")}),e.jsxs(M,{spacing:2,children:[n.map((x,l)=>e.jsxs(W,{sx:{p:2,bgcolor:"#1c1c1c",borderRadius:2},children:[e.jsx(c,{variant:"h6",fontWeight:"bold",children:x.name}),e.jsx(c,{variant:"body2",fontStyle:"italic",sx:{color:"rgba(255,255,255,0.6)"},children:x.quote})]},l)),e.jsxs(N,{variant:"text",onClick:()=>s("/coaches"),sx:{color:"#FFD700",alignSelf:"flex-start"},children:[t("aboutPage.ourCoaches.viewAll")," →"]})]})]})]}),e.jsx(X,{sx:{my:8,borderColor:"rgba(255,255,255,0.2)"}}),e.jsx(c,{align:"center",fontWeight:"bold",variant:"h5",component:"p",sx:{fontStyle:"italic"},children:t("aboutPage.finalSlogan")})]})]})},xr=()=>e.jsx(q,{children:e.jsx(c,{variant:"h3",gutterBottom:!0,children:"Achievments"})}),gr=()=>!!localStorage.getItem("token"),pr=()=>gr()?e.jsx(gt,{}):e.jsx(pt,{to:"/login"}),Ee=async t=>(await A.get(`/schedule/student/${t}`)).data,fr=async t=>(await A.post("/schedule/create",t)).data,jr=async(t,s)=>(await A.put(`/schedule/${t}`,s)).data,br=async t=>{await A.delete(`/schedule/${t}`)},Ye=async t=>{const s=new FormData;s.append("studentId",t.studentId),s.append("scheduleId",t.scheduleId),t.homeworkText&&s.append("homeworkText",t.homeworkText),t.screenshot&&s.append("screenshot",t.screenshot),await A.post("/homework/send",s)},vr=async(t,s)=>(await A.put(`/homework/${t}/review`,s)).data,yr=async()=>(await A.get("/homework/coach")).data,Sr=async t=>(await A.get(`/homework/${t}/screenshot`,{responseType:"blob"})).data,ot={scheduled:{icon:e.jsx(fe,{fontSize:"small"}),color:"info",labelKey:"status.scheduled"},pending:{icon:e.jsx(fe,{fontSize:"small"}),color:"warning",labelKey:"status.pending"},completed:{icon:e.jsx(ce,{fontSize:"small"}),color:"success",labelKey:"status.completed"},approved:{icon:e.jsx(ce,{fontSize:"small"}),color:"success",labelKey:"status.approved"},rejected:{icon:e.jsx(ze,{fontSize:"small"}),color:"error",labelKey:"status.rejected"}},$t=({event:t,variant:s="light",onSelect:r})=>{const{t:o}=B(),n=t.status,a=ot[n]||ot.scheduled,d=s==="dark"?{bgcolor:"#2a2a2a",color:"white"}:{bgcolor:"white",color:"black"};return e.jsxs(W,{onClick:r?()=>r(t):void 0,sx:{...d,p:2,borderRadius:2,cursor:r?"pointer":"default",transition:"box-shadow 0.3s, transform 0.2s","&:hover":r?{boxShadow:6,transform:"translateY(-2px)"}:{}},children:[e.jsxs(p,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:1},children:[e.jsx(c,{variant:"h6",fontWeight:500,noWrap:!0,children:t.title}),e.jsx(be,{icon:a.icon,label:o(a.labelKey),color:a.color,size:"small"})]}),e.jsx(c,{variant:"body2",color:s==="dark"?"grey.400":"text.secondary",children:U(t.date).format("MMMM Do, YYYY [at] HH:mm")}),t.description&&e.jsx(c,{variant:"body2",sx:{mt:1,color:s==="dark"?"grey.500":"text.secondary"},children:t.description})]})},Ht=({user:t,onClose:s})=>{const{t:r}=B(),[o,n]=i.useState(t.firstName),[a,d]=i.useState(t.lastName),[m,u]=i.useState(t.email),[f,v]=i.useState(""),[b,x]=i.useState(""),[l,g]=i.useState(""),[j,k]=i.useState(!1),[F,D]=i.useState(null),[C,P]=i.useState(t.photoUrl),h=I=>{var K;const R=(K=I.target.files)==null?void 0:K[0];R&&(D(R),P(URL.createObjectURL(R)))},y=async()=>{try{if(!j)await st({firstName:o,lastName:a,email:m,avatar:F||void 0}),_.success({message:r("profile_edit.updated"),description:void 0});else{if(!f||b!==l){_.error({message:r("profile_edit.passwordMismatch"),description:void 0});return}await st({currentPassword:f,newPassword:b,avatar:F||void 0}),_.success({message:r("profile_edit.passwordChanged"),description:void 0})}s(),window.location.reload()}catch(I){console.error(I),_.error({message:r("profile_edit.updateFailed"),description:void 0})}};return e.jsxs(de,{open:!0,onClose:s,fullWidth:!0,maxWidth:"sm",children:[e.jsx(he,{children:r("profile_edit.editTitle")}),e.jsxs(ue,{children:[e.jsxs(p,{display:"flex",alignItems:"center",flexDirection:"column",mb:2,children:[e.jsx($e,{src:C,sx:{width:96,height:96,mb:1}}),e.jsxs(N,{variant:"text",size:"small",component:"label",children:[r("profile_edit.uploadAvatar"),e.jsx("input",{hidden:!0,accept:"image/*",type:"file",onChange:h})]})]}),e.jsx($,{margin:"dense",label:r("profile_edit.firstName"),fullWidth:!0,value:o,onChange:I=>n(I.target.value)}),e.jsx($,{margin:"dense",label:r("profile_edit.lastName"),fullWidth:!0,value:a,onChange:I=>d(I.target.value)}),e.jsx($,{margin:"dense",label:r("profile_edit.email"),fullWidth:!0,value:m,onChange:I=>u(I.target.value)}),!j&&e.jsx(p,{mt:1,children:e.jsx(we,{component:"button",variant:"body2",onClick:()=>k(!0),children:r("profile_edit.changePassword")})}),j&&e.jsxs(p,{mt:2,children:[e.jsx($,{margin:"dense",label:r("profile_edit.currentPassword"),fullWidth:!0,type:"password",value:f,onChange:I=>v(I.target.value)}),e.jsx($,{margin:"dense",label:r("profile_edit.newPassword"),fullWidth:!0,type:"password",value:b,onChange:I=>x(I.target.value)}),e.jsx($,{margin:"dense",label:r("profile_edit.confirmPassword"),fullWidth:!0,type:"password",value:l,onChange:I=>g(I.target.value)})]})]}),e.jsxs(me,{children:[e.jsx(N,{onClick:s,children:r("profile_edit.cancel")}),e.jsx(N,{variant:"contained",onClick:y,children:r("profile_edit.save")})]})]})},at={admin:4,coach:3,student:2,user:1},wr=(t=[])=>t.length===0?"user":[...t].sort((s,r)=>(at[r]||0)-(at[s]||0))[0],Bt=({user:t,coach:s,avatarUrl:r,isMyProfile:o,onEdit:n,onLogout:a,t:d})=>{const m=wr(t.roles),u=t.roles.filter(v=>v!==m),f={admin:"secondary",coach:"primary",student:"success",user:"default"}[m];return e.jsx(W,{sx:{p:{xs:2,md:4},mb:4,bgcolor:"#1c1c1c",borderRadius:4,color:"white"},children:e.jsxs(M,{direction:{xs:"column",md:"row"},spacing:4,alignItems:"center",children:[e.jsx($e,{src:r,alt:`${t.firstName} ${t.lastName}`,sx:{width:120,height:120,border:"4px solid #FFD700"}}),e.jsxs(p,{sx:{flexGrow:1,textAlign:{xs:"center",md:"left"}},children:[e.jsxs(M,{direction:"row",spacing:2,alignItems:"center",justifyContent:{xs:"center",md:"flex-start"},children:[e.jsxs(c,{variant:"h4",fontWeight:"bold",children:[t.firstName," ",t.lastName]}),e.jsx(He,{title:u.length>0?`Also: ${u.join(", ")}`:"",arrow:!0,children:e.jsx(be,{label:m,color:f,size:"small",sx:{textTransform:"capitalize"}})})]}),s&&e.jsxs(c,{sx:{color:"rgba(255,255,255,0.7)",mt:1},children:["Coach: ",e.jsxs(we,{component:ft,to:`/profile/${s._id}`,color:"inherit",sx:{textDecoration:"underline"},children:[s.firstName," ",s.lastName]})]}),e.jsxs(c,{variant:"body2",sx:{color:"rgba(255, 255, 255, 0.5)",mt:.5},children:[d("profile.registrationDate"),": ",new Date(t.registrationDate).toLocaleDateString()]})]}),e.jsx(M,{direction:"row",spacing:2,sx:{mt:{xs:3,md:0}},children:o?e.jsxs(e.Fragment,{children:[e.jsx(N,{variant:"outlined",onClick:n,startIcon:e.jsx(_e,{}),sx:{color:"#FFD700",borderColor:"rgba(255, 215, 0, 0.5)","&:hover":{borderColor:"#FFD700"}},children:d("profile.editProfile")}),e.jsx(N,{variant:"contained",color:"error",onClick:a,startIcon:e.jsx(gs,{}),children:d("profile.logout")})]}):m==="coach"&&e.jsx(N,{variant:"contained",color:"primary",startIcon:e.jsx(wt,{}),children:"Send Request"})})]})})},Ot=({schedule:t,isLoading:s,onEventSelect:r})=>{if(s)return e.jsxs(M,{spacing:2,children:[e.jsx(Pe,{variant:"rectangular",height:118,sx:{borderRadius:2,bgcolor:"grey.800"}}),e.jsx(Pe,{variant:"rectangular",height:118,sx:{borderRadius:2,bgcolor:"grey.800"}}),e.jsx(Pe,{variant:"rectangular",height:118,sx:{borderRadius:2,bgcolor:"grey.800"}})]});if(t.length===0)return e.jsx(c,{sx:{color:"grey.500",textAlign:"center",p:4},children:"You have no scheduled lessons yet."});const o=[...t].sort((n,a)=>new Date(a.date).getTime()-new Date(n.date).getTime());return e.jsx(M,{spacing:2,children:o.map(n=>e.jsx($t,{event:n,onSelect:r},n._id))})},qt=({schedule:t,isLoading:s,onEventSelect:r})=>{if(s)return e.jsx(W,{sx:{p:2,bgcolor:"#2a2a2a",borderRadius:3},children:e.jsx(Pe,{variant:"rectangular",height:150,sx:{bgcolor:"grey.700",borderRadius:2}})});const o=t.filter(n=>new Date(n.date)>=new Date).sort((n,a)=>new Date(n.date).getTime()-new Date(a.date).getTime())[0];return e.jsxs(p,{children:[e.jsx(c,{variant:"h5",fontWeight:"bold",sx:{mb:2},children:"Next Up"}),o?e.jsx($t,{event:o,variant:"dark",onSelect:r}):e.jsx(W,{sx:{p:4,bgcolor:"#2a2a2a",color:"white",borderRadius:3,textAlign:"center"},children:e.jsx(c,{sx:{color:"grey.500"},children:"You have no upcoming lessons."})}),t.length>0&&e.jsx(N,{component:ft,to:"/students-shedule",fullWidth:!0,endIcon:e.jsx(ps,{}),sx:{mt:2,color:"#FFD700",justifyContent:"flex-start",p:1},children:"View Full Schedule"})]})},it={scheduled:{icon:e.jsx(fe,{fontSize:"small"}),color:"info",labelKey:"status.scheduled"},pending:{icon:e.jsx(fe,{fontSize:"small"}),color:"warning",labelKey:"status.pending"},completed:{icon:e.jsx(ce,{fontSize:"small"}),color:"success",labelKey:"status.completed"},approved:{icon:e.jsx(ce,{fontSize:"small"}),color:"success",labelKey:"status.approved"},rejected:{icon:e.jsx(ze,{fontSize:"small"}),color:"error",labelKey:"status.rejected"}},lt=5,Kt=({event:t,open:s,onClose:r,onSendHomework:o})=>{const{t:n}=B(),[a,d]=i.useState(""),[m,u]=i.useState(null),[f,v]=i.useState(!1);if(i.useEffect(()=>{s||(d(""),u(null),v(!1))},[s]),!t)return null;const b=j=>{var F;const k=(F=j.target.files)==null?void 0:F[0];if(k){if(k.size>lt*1024*1024){_.error({message:n("errors.fileTooLarge",{size:lt}),description:void 0});return}u(k)}},x=async()=>{if(!a.trim()&&!m){_.error({message:n("errors.emptyHomework"),description:void 0});return}v(!0);try{await o(a,m)}finally{v(!1)}},l=t.status,g=it[l]||it.scheduled;return e.jsxs(de,{open:s,onClose:r,fullWidth:!0,maxWidth:"sm",children:[e.jsx(he,{sx:{bgcolor:`${g.color}.main`,color:"white"},children:n("studentSchedule.eventDetails")}),e.jsxs(ue,{sx:{pt:3},children:[e.jsxs(p,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx(c,{variant:"h6",children:t.title}),e.jsx(be,{icon:g.icon,label:n(g.labelKey),color:g.color,size:"small"})]}),e.jsx(c,{variant:"body2",color:"text.secondary",children:U(t.date).format("dddd, MMMM Do, YYYY [at] HH:mm")}),t.description&&e.jsx(c,{variant:"body1",sx:{mt:2},children:t.description}),t.link&&e.jsxs(c,{variant:"body2",sx:{mt:1},children:[n("studentSchedule.form_link"),": ",e.jsx(we,{href:t.link,target:"_blank",rel:"noopener noreferrer",children:t.link})]}),t.type==="homework"&&e.jsxs(p,{sx:{mt:4},children:[e.jsx(c,{variant:"h6",sx:{mb:2},children:n("studentSchedule.sendHomeworkTitle")}),e.jsx($,{label:n("studentSchedule.form_description"),fullWidth:!0,multiline:!0,rows:4,value:a,onChange:j=>d(j.target.value),variant:"outlined",disabled:f}),e.jsxs(N,{sx:{mt:2},variant:"outlined",component:"label",startIcon:e.jsx(Ct,{}),disabled:f,children:[m?m.name:n("studentSchedule.uploadScreenshot"),e.jsx("input",{type:"file",hidden:!0,accept:"image/*",onChange:b})]})]})]}),e.jsxs(me,{sx:{p:2},children:[e.jsx(N,{onClick:r,disabled:f,children:n("common.close")}),t.type==="homework"&&e.jsx(N,{onClick:x,variant:"contained",color:"primary",disabled:f,children:n("studentSchedule.send")})]})]})};function Re(t){const{children:s,value:r,index:o,...n}=t;return e.jsx("div",{role:"tabpanel",hidden:r!==o,...n,children:r===o&&e.jsx(p,{sx:{pt:3},children:s})})}const ct=()=>{const{t}=B(),s=oe(),{userId:r}=jt(),o=i.useContext(ve);if(!o)throw new Error("AuthContext is not available");const{user:n,logout:a,loading:d,refetchUser:m}=o,[u,f]=i.useState(null),[v,b]=i.useState(null),[x,l]=i.useState([]),[g,j]=i.useState({profile:!0,coach:!1,schedule:!1}),[k,F]=i.useState(null),[D,C]=i.useState(!1),[P,h]=i.useState(0),[y,I]=i.useState(null);i.useEffect(()=>{if(d)return;if(!(r||(n==null?void 0:n._id))){F(t("profile.errorNoUser","Could not determine which profile to load.")),j({profile:!1,coach:!1,schedule:!1});return}f(null),b(null),l([]),(async()=>{j(T=>({...T,profile:!0}));try{const T=await(r?Tt(r):We());f(T)}catch{F(t("profile.errorLoadingProfile"))}finally{j(T=>({...T,profile:!1}))}})()},[t,r,n==null?void 0:n._id,d]),i.useEffect(()=>{if(u){const w=!r||(n==null?void 0:n._id)===u._id;u.trainer?(j(S=>({...S,coach:!0})),zt(u.trainer).then(b).catch(S=>console.error("Failed to fetch coach",S)).finally(()=>j(S=>({...S,coach:!1})))):b(null),w&&u.roles.some(S=>["student","user"].includes(S))?(j(S=>({...S,schedule:!0})),Ee(u._id).then(l).catch(S=>console.error("Failed to fetch schedule",S)).finally(()=>j(S=>({...S,schedule:!1})))):l([])}},[u,r,n==null?void 0:n._id]);const R=()=>{a(),s("/auth/login")},K=(w,S)=>h(S),z=!r||(n==null?void 0:n._id)===(u==null?void 0:u._id),O=async(w,S)=>{if(!(!n||!y))try{await Ye({studentId:n._id,scheduleId:y._id,homeworkText:w.trim()||void 0,screenshot:S||void 0}),y.coach&&await Ke({recipient:y.coach,type:"homework_submission",content:`New homework from ${n.firstName} for: "${y.title}"`,metadata:{scheduleId:y._id}}),_.success({message:t("studentSchedule.homeworkSentSuccess","Homework sent successfully!"),description:void 0}),I(null),l(T=>T.map(L=>L._id===y._id?{...L,status:"pending"}:L))}catch{_.error({message:t("errors.sendHomework","Failed to send homework."),description:void 0})}},re=i.useMemo(()=>u!=null&&u._id?Lt(u._id):"",[u]);return d||g.profile?e.jsx(p,{sx:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh",bgcolor:"#0e0e0e"},children:e.jsx(se,{sx:{color:"#FFD700"}})}):k||!u?e.jsx(p,{sx:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh",bgcolor:"#0e0e0e"},children:e.jsx(c,{color:"error",children:k||"User not found"})}):e.jsx(p,{sx:{bgcolor:"#0e0e0e",color:"white",minHeight:"100vh",py:5},children:e.jsxs(q,{maxWidth:"lg",children:[e.jsxs(p,{sx:{textAlign:"center",mb:5},children:[e.jsx(c,{variant:"h2",component:"h1",fontWeight:"bold",children:z?t("profile.title"):`${u.firstName}'s Profile`}),e.jsx(c,{variant:"h6",sx:{mt:1,color:"rgba(255, 255, 255, 0.7)"},children:z&&t("profile.subtitle")})]}),e.jsx(Bt,{user:u,coach:v,avatarUrl:re,isMyProfile:z,onEdit:()=>C(!0),onLogout:R,t}),e.jsx(p,{sx:{borderBottom:1,borderColor:"divider"},children:e.jsxs(Be,{value:P,onChange:K,textColor:"inherit",TabIndicatorProps:{sx:{backgroundColor:"#FFD700"}},children:[e.jsx(ne,{label:t("profile.tabs.overview","Overview")}),z&&u.roles.some(w=>["student","user"].includes(w))&&e.jsx(ne,{label:t("profile.tabs.lessons","All Lessons")}),e.jsx(ne,{label:t("profile.tabs.statistics","Statistics"),disabled:!0})]})}),e.jsx(Re,{value:P,index:0,children:z?e.jsx(qt,{schedule:x,isLoading:g.schedule,onEventSelect:I}):e.jsx(c,{sx:{color:"grey.500",textAlign:"center",p:4},children:"This is a public profile overview."})}),z&&u.roles.some(w=>["student","user"].includes(w))&&e.jsx(Re,{value:P,index:1,children:e.jsx(Ot,{schedule:x,isLoading:g.schedule,onEventSelect:I})}),e.jsx(Re,{value:P,index:z&&u.roles.some(w=>["student","user"].includes(w))?2:1,children:e.jsx(c,{sx:{color:"grey.500",textAlign:"center",p:4},children:"Game statistics and analytics are coming soon!"})}),z&&D&&e.jsx(Ht,{user:u,onClose:()=>{C(!1),m()}}),z&&e.jsx(Kt,{event:y,open:!!y,onClose:()=>I(null),onSendHomework:O})]})})},Cr=({columns:t,data:s})=>{const[r,o]=i.useState(""),[n,a]=i.useState(10),[d,m]=i.useState(0),u=x=>{o(x.target.value),m(0)},f=(x,l)=>{m(l)},v=x=>{a(parseInt(x.target.value,10)),m(0)},b=s.filter(x=>t.some(l=>{if(l.field==="actions")return!1;const g=x[l.field];return g==null?void 0:g.toString().toLowerCase().includes(r.toLowerCase())}));return e.jsxs(W,{children:[e.jsx($,{fullWidth:!0,label:"Поиск",variant:"outlined",value:r,onChange:u,style:{padding:"16px"}}),e.jsx(fs,{children:e.jsxs(kt,{children:[e.jsx(It,{children:e.jsx(ge,{children:t.map(x=>e.jsx(Y,{children:x.label},String(x.field)))})}),e.jsx(Nt,{children:b.slice(d*n,d*n+n).map(x=>e.jsx(ge,{children:t.map(l=>e.jsx(Y,{children:l.render?l.render(x):x[l.field]},String(l.field)))},x.id))})]})}),e.jsx(js,{rowsPerPageOptions:[10,20,50,100],component:"div",count:b.length,rowsPerPage:n,page:d,onPageChange:f,onRowsPerPageChange:v})]})},kr=()=>{const[t,s]=i.useState([]),[r,o]=i.useState(null),[n,a]=i.useState(""),[d,m]=i.useState("add"),[u,f]=i.useState(!1),[v,b]=i.useState(!1),[x,l]=i.useState({open:!1,message:"",severity:"success"});i.useEffect(()=>{(async()=>{try{const I=(await A.get("/users")).data.map(R=>({id:R._id,firstName:R.firstName,lastName:R.lastName,email:R.email,roles:R.roles,_id:R._id,registrationDate:new Date(R.registrationDate),firebaseUID:R.firebaseUID,students:R.students,trainer:R.trainer,trainerEmail:R.trainerEmail}));s(I)}catch(y){console.error("Ошибка при получении списка пользователей:",y)}})()},[]);const g=h=>{o(h),a(""),m("add"),f(!0)},j=()=>{o(null),f(!1)},k=h=>{o(h),b(!0)},F=()=>{b(!1),o(null)},D=async()=>{if(r)try{await A.put("/admin/update-role",{userEmail:r.email,role:n,action:d}),s(t.map(h=>h.id===r.id?{...h,roles:d==="add"?[...h.roles,n]:h.roles.filter(y=>y!==n)}:h)),l({open:!0,message:"Роль успешно изменена",severity:"success"}),j()}catch(h){console.error("Ошибка при изменении роли:",h),l({open:!0,message:"Ошибка при изменении роли",severity:"error"})}},C=async()=>{if(r)try{await A.delete(`/admin/delete-user/${r.id}`),s(t.filter(h=>h.id!==r.id)),l({open:!0,message:"Пользователь удалён",severity:"success"}),F()}catch(h){console.error("Ошибка при удалении пользователя:",h),l({open:!0,message:"Ошибка при удалении пользователя",severity:"error"})}},P=[{field:"firstName",label:"Имя"},{field:"lastName",label:"Фамилия"},{field:"email",label:"Email"},{field:"roles",label:"Роли",render:h=>h.roles.join(", ")},{field:"actions",label:"Действия",render:h=>e.jsxs(e.Fragment,{children:[e.jsx(V,{size:"small",onClick:()=>g(h),children:e.jsx(_e,{})}),e.jsx(V,{size:"small",color:"error",onClick:()=>k(h),children:e.jsx(Te,{})})]})}];return e.jsxs(q,{children:[e.jsx(c,{variant:"h4",gutterBottom:!0,children:"Список пользователей"}),e.jsx(Cr,{columns:P,data:t}),e.jsxs(de,{open:u,onClose:j,fullWidth:!0,maxWidth:"xs",children:[e.jsx(he,{children:"Управление ролями"}),e.jsxs(ue,{children:[e.jsxs(Xe,{children:["Пользователь: ",e.jsxs("strong",{children:[r==null?void 0:r.firstName," ",r==null?void 0:r.lastName]})]}),e.jsxs(Oe,{fullWidth:!0,sx:{marginTop:2},children:[e.jsx(qe,{children:"Роль"}),e.jsxs(Fe,{value:n,onChange:h=>a(h.target.value),label:"Роль",children:[e.jsx(J,{value:"student",children:"Студент"}),e.jsx(J,{value:"coach",children:"Тренер"})]})]})]}),e.jsxs(me,{children:[e.jsx(N,{onClick:j,children:"Отмена"}),e.jsx(N,{onClick:D,color:"primary",disabled:!n,children:"Сохранить"})]})]}),e.jsxs(de,{open:v,onClose:F,children:[e.jsx(he,{children:"Подтвердите удаление"}),e.jsx(ue,{children:e.jsxs(Xe,{children:["Вы уверены, что хотите удалить пользователя ",r==null?void 0:r.email,"? Это действие необратимо."]})}),e.jsxs(me,{children:[e.jsx(N,{onClick:F,children:"Нет"}),e.jsx(N,{onClick:C,color:"error",children:"Да, удалить"})]})]}),e.jsx(bs,{open:x.open,autoHideDuration:4e3,onClose:()=>l({...x,open:!1}),children:e.jsx(vs,{severity:x.severity,onClose:()=>l({...x,open:!1}),variant:"filled",children:x.message})})]})},Ir=Rt(U),Nr={individual_lesson:e.jsx(_t,{fontSize:"small"}),group_lesson:e.jsx(Ft,{fontSize:"small"}),homework:e.jsx(Et,{fontSize:"small"}),opening_study:e.jsx(Dt,{fontSize:"small"}),tournament_participation:e.jsx(At,{fontSize:"small"})},Pr=["individual_lesson","group_lesson","homework","opening_study","tournament_participation"],_r=({event:t})=>{const s=t.type;if(!s)return null;const r=Nr[s],o=`custom-event rbc-event--${s}`;return e.jsx(He,{title:t.description||t.title,placement:"top",children:e.jsxs("div",{className:o,children:[r,e.jsx(c,{variant:"caption",noWrap:!0,component:"span",children:t.title})]})})},Fr=({open:t,onClose:s,student:r})=>{const{t:o}=B(),[n,a]=i.useState([]),[d,m]=i.useState({}),[u,f]=i.useState(null);if(!r)return null;const v=`${r.firstName} ${r.lastName}`,b=i.useCallback(()=>{m({student:r._id,status:"scheduled",title:"",type:"individual_lesson",date:"",description:"",link:""}),f(null)},[r]),x=i.useCallback(async()=>{if(r._id)try{const h=await Ee(r._id);a(h)}catch(h){console.error("Failed to fetch schedule:",h),_.error({message:o("schedule.fetchError"),description:void 0})}},[r,o]),l=async()=>{const{date:h,type:y,title:I}=d;if(!h||!y||!I){_.error({message:o("schedule.fieldRequired"),description:void 0});return}const R={studentId:r._id,date:new Date(h).toISOString(),title:I,description:d.description||"",link:d.link||"",type:y,status:d.status||"scheduled"};try{const K=!!d._id;K?await jr(d._id,R):await fr(R),_.success({message:o(K?"schedule.updateSuccess":"schedule.createSuccess"),description:void 0}),await x(),b()}catch(K){console.error("Failed to save event:",K)}},g=async()=>{if(d._id)try{await br(d._id),_.success({message:o("schedule.deleteSuccess"),description:void 0}),await x(),b()}catch(h){console.error("Failed to delete event:",h)}};i.useEffect(()=>{t&&r&&(x(),b())},[t,r,x,b]);const j=i.useCallback(({start:h})=>{b(),f(h),m(y=>({...y,date:U(h).format("YYYY-MM-DDTHH:mm")}))},[b]),k=i.useCallback(h=>{f(h.date?new Date(h.date):null),m({...h,date:h.date?U(h.date).format("YYYY-MM-DDTHH:mm"):""})},[]),F=n.map(h=>({...h,id:h._id,start:new Date(h.date),end:U(h.date).add(1,"hour").toDate(),title:h.title})),D=i.useCallback(h=>({className:u&&U(h).isSame(u,"day")?"rbc-selected-slot-custom":""}),[u]),C=h=>{const{name:y,value:I}=h.target;m(R=>({...R,[y]:I}))},P=h=>{m(y=>({...y,type:h.target.value}))};return e.jsxs(de,{open:t,onClose:s,fullWidth:!0,maxWidth:"lg",className:"schedule-dialog",children:[e.jsx(he,{className:"schedule-dialog__header",children:e.jsxs(M,{direction:"row",justifyContent:"space-between",alignItems:"center",children:[e.jsx(c,{variant:"h6",component:"div",children:o("schedule.editScheduleTitle",{studentName:v})}),e.jsx(V,{"aria-label":"close",onClick:s,className:"schedule-dialog__close-btn",children:e.jsx(Pt,{})})]})}),e.jsx(ue,{dividers:!0,className:"schedule-dialog__content",children:e.jsxs(E,{container:!0,spacing:3,children:[e.jsx(E,{item:!0,xs:12,md:7,children:e.jsx(Mt,{localizer:Ir,events:F,startAccessor:"start",endAccessor:"end",selectable:!0,onSelectSlot:j,onSelectEvent:k,components:{event:_r},dayPropGetter:D,className:"schedule-calendar"})}),e.jsx(E,{item:!0,xs:12,md:5,children:e.jsxs(W,{component:"form",className:"event-form",onSubmit:h=>{h.preventDefault(),l()},children:[e.jsx(c,{variant:"h6",className:"event-form__header",children:d._id?o("schedule.eventDetails"):u?o("schedule.addEventForDate",{date:U(u).format("MMMM Do, YYYY")}):o("schedule.addEvent")}),e.jsxs(M,{spacing:2.5,className:"event-form__fields",children:[e.jsx($,{name:"title",label:o("schedule.form_title"),variant:"filled",fullWidth:!0,value:d.title||"",onChange:C,className:"event-form__field"}),e.jsxs(Oe,{variant:"filled",fullWidth:!0,className:"event-form__field",children:[e.jsx(qe,{children:o("schedule.form_type")}),e.jsx(Fe,{name:"type",value:d.type||"",onChange:P,children:Pr.map(h=>e.jsx(J,{value:h,children:o(`schedule.eventTypes.${h}`)},h))})]}),e.jsx($,{name:"description",label:o("schedule.form_description"),variant:"filled",fullWidth:!0,multiline:!0,rows:3,value:d.description||"",onChange:C,className:"event-form__field"}),e.jsx($,{name:"link",label:o("schedule.form_link"),variant:"filled",fullWidth:!0,value:d.link||"",onChange:C,className:"event-form__field"}),e.jsx($,{name:"date",label:o("schedule.form_date"),type:"datetime-local",variant:"filled",fullWidth:!0,value:d.date||"",onChange:C,InputLabelProps:{shrink:!0},className:"event-form__field"})]})]})})]})}),e.jsxs(me,{className:"schedule-dialog__actions",children:[e.jsx(N,{onClick:s,className:"action-button action-button--close",children:o("common.close")}),e.jsx(p,{sx:{flex:"1 1 auto"}}),d._id&&e.jsx(N,{onClick:g,variant:"outlined",startIcon:e.jsx(Te,{}),className:"action-button action-button--delete",children:o("common.delete")}),e.jsx(N,{onClick:l,variant:"contained",startIcon:d._id?e.jsx(ys,{}):e.jsx(Ss,{}),className:"action-button action-button--save",children:d._id?o("common.save"):o("common.add")})]})]})},Er=()=>{const{t}=B(),[s,r]=i.useState([]),[o,n]=i.useState(null),[a,d]=i.useState(!1),[m,u]=i.useState(!0),f=i.useMemo(()=>{const l=localStorage.getItem("user");return l?JSON.parse(l).email:null},[]),v=i.useCallback(async()=>{if(!f){u(!1);return}u(!0);try{const l=await cr(f);if(!Array.isArray(l)||l.length===0){r([]);return}const g=l.map(k=>lr(f,k)),j=await Promise.all(g);r(j.filter(k=>k!==null))}catch(l){console.error("Ошибка при получении списка учеников:",l),_.error({message:t("studentsPage.fetchError"),description:void 0}),r([])}finally{u(!1)}},[f,t]),b=async l=>{if(f)try{await dr(f,l),_.success({message:t("studentsPage.studentDeletedSuccess"),description:void 0}),r(g=>g.filter(j=>j._id!==l))}catch(g){console.error("Ошибка при удалении ученика:",g)}},x=l=>{n(l),d(!0)};return i.useEffect(()=>{v()},[v]),e.jsxs(q,{children:[e.jsx(c,{variant:"h4",gutterBottom:!0,children:t("studentsPage.studentsListTitle")}),e.jsx(W,{children:e.jsxs(kt,{children:[e.jsx(It,{children:e.jsxs(ge,{children:[e.jsx(Y,{children:t("studentsPage.firstName")}),e.jsx(Y,{children:t("studentsPage.lastName")}),e.jsx(Y,{children:t("studentsPage.email")}),e.jsx(Y,{align:"right",children:t("studentsPage.actions")})]})}),e.jsx(Nt,{children:m?e.jsx(ge,{children:e.jsxs(Y,{colSpan:4,align:"center",children:[e.jsx(se,{}),e.jsx(c,{sx:{mt:1},children:t("common.loading")})]})}):s.length>0?s.map(l=>e.jsxs(ge,{children:[e.jsx(Y,{children:l.firstName}),e.jsx(Y,{children:l.lastName}),e.jsx(Y,{children:l.email}),e.jsxs(Y,{align:"right",children:[e.jsx(N,{variant:"contained",color:"primary",onClick:()=>x(l),style:{marginRight:10},children:t("studentsPage.editSchedule")}),e.jsx(N,{variant:"contained",color:"secondary",onClick:()=>b(l._id),children:t("studentsPage.delete")})]})]},l._id)):e.jsx(ge,{children:e.jsx(Y,{colSpan:4,align:"center",children:t("studentsPage.noStudents")})})})]})}),o&&e.jsx(Fr,{open:a,onClose:()=>d(!1),student:o})]})};class Dr{constructor(s){Ae(this,"game");Ae(this,"fullHistory",[]);this.game=s?new pe(s):new pe,this.fullHistory=this.game.history()}getFen(){return this.game.fen()}getTurn(){return this.game.turn()}getHistory(){return this.fullHistory}getMovesForSquare(s){return this.game.moves({square:s,verbose:!0})}getStatus(){return{isCheckmate:this.game.isCheckmate(),isStalemate:this.game.isStalemate(),isThreefoldRepetition:this.game.isThreefoldRepetition(),isInsufficientMaterial:this.game.isInsufficientMaterial(),isDraw:this.game.isDraw(),turn:this.game.turn()}}handleMove(s,r){try{const o=this.game.move({from:s,to:r,promotion:"q"});return o&&(this.fullHistory=this.game.history()),o}catch{return null}}resetGame(){this.game.reset(),this.fullHistory=[]}loadPgn(s){try{return this.game.loadPgn(s),this.fullHistory=this.game.history(),!0}catch(r){return console.error("Invalid PGN:",r),!1}}goToMove(s){const r=new pe;for(let o=0;o<s;o++)this.fullHistory[o]&&r.move(this.fullHistory[o]);this.game=r}uciToSan(s){const r=this.game.move({from:s.substring(0,2),to:s.substring(2,4),promotion:s.length===5?s.substring(4):void 0});return r?(this.game.undo(),r.san):null}}const Ar=t=>{const s=i.useMemo(()=>new Dr(t),[t]),[r,o]=i.useState(s.getFen()),[n,a]=i.useState(s.getHistory()),[d,m]=i.useState(n.length),[u,f]=i.useState(null),[v,b]=i.useState({}),x=i.useRef(r);x.current=r;const l=i.useCallback(()=>{o(s.getFen());const P=s.getHistory();a(P),m(P.length)},[s]),g=i.useCallback(()=>{f(null),b({})},[]),j=i.useCallback((P,h)=>s.handleMove(P,h)?(l(),g(),!0):!1,[s,l,g]),k=i.useCallback(P=>{if(P===u){g();return}const h=s.getMovesForSquare(P);if(h.length===0){g();return}const y={};h.forEach(I=>{y[I.to]={background:I.flags.includes("c")?"radial-gradient(circle, rgba(0,0,0,0) 85%, rgba(0,0,0,0.2) 85%)":"radial-gradient(circle, rgba(0,0,0,0.2) 25%, transparent 30%)",borderRadius:"50%"}}),b(y),f(P)},[s,u,g]),F=i.useCallback(()=>{s.resetGame(),l(),g()},[s,l,g]),D=i.useCallback(P=>{const h=s.loadPgn(P.trim());return h&&(l(),g()),h},[s,l,g]),C=i.useCallback(P=>{s.goToMove(P),o(s.getFen()),m(P),g()},[s,g]);return{fen:r,history:n,currentMoveIndex:d,moveOptions:v,actions:{handleMove:j,onSquareClick:k,resetGame:F,loadPgn:D,goToMove:C}}},Rr=({fen:t,onPieceDrop:s,onSquareClick:r,squareStyles:o})=>e.jsx(Wt,{position:t,onPieceDrop:s,onSquareClick:r,customSquareStyles:o,customBoardStyle:{borderRadius:"4px",boxShadow:"0 5px 15px rgba(0, 0, 0, 0.5)"},customDarkSquareStyle:{backgroundColor:"#779952"},customLightSquareStyle:{backgroundColor:"#edeed1"}}),dt=t=>{if(t===void 0)return"";const s=Math.abs(t);return s<.4?" =":s<1?t>0?" += ":" -= ":s<2?t>0?" ±":" ∓":t>0?" +-":" -+"},ht=t=>t===void 0||Math.abs(t)<.4?"text.secondary":t>0?"success.light":"error.light",Mr=({history:t,currentMoveIndex:s,onMoveClick:r})=>{const o=Ge.useMemo(()=>{const n=[];for(let a=0;a<t.length;a+=2)n.push({white:t[a],black:t[a+1]||null});return n},[t]);return e.jsx(W,{variant:"outlined",sx:{p:1.5,height:"100%",overflowY:"auto",bgcolor:"#1c1c1c",borderColor:"rgba(255,255,255,0.2)"},children:e.jsx(E,{container:!0,rowSpacing:.5,columnSpacing:1,sx:{fontSize:"1rem",color:"white"},children:o.map((n,a)=>{const d=a*2+1,m=a*2+2;return e.jsxs(Ge.Fragment,{children:[e.jsxs(E,{item:!0,xs:2,sx:{color:"rgba(255, 255, 255, 0.6)",textAlign:"right",pt:"4px"},children:[a+1,"."]}),e.jsx(E,{item:!0,xs:5,children:e.jsxs(p,{onClick:()=>r(d),sx:{display:"flex",alignItems:"center",cursor:"pointer",p:"2px 5px",borderRadius:"4px",bgcolor:s===d?"rgba(255, 215, 0, 0.3)":"transparent","&:hover":{bgcolor:"rgba(255,255,255,0.1)"}},children:[e.jsx(c,{component:"span",children:n.white.san}),e.jsx(c,{component:"span",sx:{color:ht(n.white.evaluation),fontWeight:"bold",ml:.5},children:dt(n.white.evaluation)})]})}),e.jsx(E,{item:!0,xs:5,children:n.black&&e.jsxs(p,{onClick:()=>r(m),sx:{display:"flex",alignItems:"center",cursor:"pointer",p:"2px 5px",borderRadius:"4px",bgcolor:s===m?"rgba(255, 215, 0, 0.3)":"transparent","&:hover":{bgcolor:"rgba(255,255,255,0.1)"}},children:[e.jsx(c,{component:"span",children:n.black.san}),e.jsx(c,{component:"span",sx:{color:ht(n.black.evaluation),fontWeight:"bold",ml:.5},children:dt(n.black.evaluation)})]})})]},a)})})})},Wr=({evaluation:t,depth:s,principalVariation:r,isAnalyzing:o,isEngineOn:n,onToggleEngine:a})=>e.jsxs(W,{variant:"outlined",sx:{p:2,borderColor:"rgba(255,255,255,0.2)",borderRadius:2},children:[e.jsxs(M,{direction:"row",justifyContent:"space-between",alignItems:"center",children:[e.jsx(c,{variant:"h4",fontWeight:"bold",sx:{color:"#FFD700"},children:t??e.jsx(c,{component:"span",color:"text.secondary",children:"..."})}),e.jsxs(M,{direction:"row",alignItems:"center",spacing:1,children:[e.jsxs(M,{alignItems:"flex-end",children:[e.jsxs(c,{variant:"body2",color:"text.secondary",children:["Depth: ",s]}),e.jsx(c,{variant:"body2",color:"text.secondary",children:"SF 16"})]}),e.jsx(le,{control:e.jsx(ws,{checked:n,onChange:a,sx:{"& .MuiSwitch-switchBase.Mui-checked":{color:"#FFD700"},"& .MuiSwitch-switchBase.Mui-checked + .MuiSwitch-track":{backgroundColor:"#FFD700"}}}),label:"",sx:{mr:0}})]})]}),e.jsx(X,{sx:{my:1,borderColor:"rgba(255,255,255,0.2)"}}),e.jsx(p,{sx:{minHeight:"4em",overflowX:"auto",whiteSpace:"nowrap"},children:e.jsx(c,{variant:"body1",children:r||(o?"Analyzing...":e.jsx(c,{component:"span",color:"text.secondary",children:"-"}))})})]}),Lr=()=>{const{t}=B(),{fen:s,history:r,currentMoveIndex:o,moveOptions:n,actions:a}=Ar(),[d,m]=i.useState([]),[u,f]=i.useState(""),[v,b]=i.useState(null),[x,l]=i.useState(!1),[g,j]=i.useState(null),[k,F]=i.useState(0),[D,C]=i.useState(""),[P,h]=i.useState(!1),y=i.useRef(s);i.useEffect(()=>{y.current=s},[s]),i.useEffect(()=>{m(r.map(S=>({san:S})))},[r]);const I=()=>{j(null),F(0),C("")},R=()=>{a.loadPgn(u)?(I(),_.success({message:t("chessGame.pgnLoadSuccess"),description:void 0})):_.error({message:t("chessGame.pgnLoadError"),description:void 0})},K=()=>{a.resetGame(),I(),_.success({message:t("chessGame.resetSuccess"),description:void 0})},z=S=>{a.goToMove(S),I()},O=i.useCallback(()=>{v&&!x&&(l(!0),I(),v.postMessage(`position fen ${s}`),v.postMessage("go depth 18"))},[v,s,x]);i.useEffect(()=>{P?O():v&&(v.postMessage("stop"),l(!1))},[s,P,O,v]);const re=S=>{h(S.target.checked)},w=i.useCallback((S,T)=>{try{const L=new pe(T),ae=S.split(" ");let Q="";for(const Z of ae){const ie=L.move({from:Z.substring(0,2),to:Z.substring(2,4),promotion:Z.length===5?Z.substring(4):void 0});if(ie)L.turn()==="b"?Q+=`${L.moveNumber()}. ${ie.san} `:Q+=`${ie.san} `;else break}return Q.trim()}catch{return S}},[]);return i.useEffect(()=>{const S=new Worker("/workers/stockfish.js");return b(S),S.postMessage("uci"),S.onmessage=T=>{const L=T.data;if(L!=="uciok"){if(L.startsWith("info depth")){const ae=L.match(/depth (\d+)/),Q=L.match(/score (cp|mate) (-?\d+)/),Z=L.match(/ pv (.+)/);if(ae&&F(parseInt(ae[1],10)),Q){const ie=new pe(y.current).turn(),Gt=Q[1];let De=parseInt(Q[2],10);ie==="b"&&(De*=-1);const Ut=Gt==="cp"?(De/100).toFixed(2):`M${Math.abs(De)}`;j(Ut)}if(Z){const ie=w(Z[1],y.current);C(ie)}}L.startsWith("bestmove")&&l(!1)}},()=>S.terminate()},[w]),e.jsx(p,{sx:{bgcolor:"#0e0e0e",color:"white",minHeight:"100vh",py:{xs:2,md:5}},children:e.jsxs(q,{maxWidth:"xl",children:[e.jsxs(p,{sx:{textAlign:"center",mb:4},children:[e.jsx(c,{variant:"h2",component:"h1",fontWeight:"bold",children:t("chessGame.title")}),e.jsx(c,{variant:"h6",sx:{mt:1,color:"rgba(255, 255, 255, 0.7)"},children:t("chessGame.subtitle")})]}),e.jsxs(E,{container:!0,spacing:4,children:[e.jsx(E,{item:!0,xs:12,md:7,children:e.jsx(W,{sx:{p:2,bgcolor:"#1c1c1c",borderRadius:4,aspectRatio:"1 / 1",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(Rr,{fen:s,onPieceDrop:a.handleMove,onSquareClick:a.onSquareClick,squareStyles:n})})}),e.jsx(E,{item:!0,xs:12,md:5,children:e.jsx(W,{sx:{p:2,bgcolor:"#1c1c1c",borderRadius:4,height:"100%"},children:e.jsxs(M,{spacing:2,height:"100%",children:[e.jsx(Wr,{evaluation:g,depth:k,principalVariation:D,isAnalyzing:x,isEngineOn:P,onToggleEngine:re}),e.jsx(p,{sx:{flexGrow:1,height:"250px"},children:e.jsx(Mr,{history:d,currentMoveIndex:o,onMoveClick:z})}),e.jsxs(M,{direction:"row",spacing:1,justifyContent:"center",alignItems:"center",children:[e.jsx(V,{onClick:()=>z(0),disabled:o===0,children:e.jsx(Cs,{})}),e.jsx(V,{onClick:()=>z(o-1),disabled:o===0,children:e.jsx(ks,{})}),e.jsx(V,{onClick:()=>z(o+1),disabled:o===r.length,children:e.jsx(Is,{})}),e.jsx(V,{onClick:()=>z(r.length),disabled:o===r.length,children:e.jsx(Ns,{})})]}),e.jsxs(M,{spacing:1,children:[e.jsx($,{label:t("chessGame.pgnInputLabel"),fullWidth:!0,multiline:!0,rows:2,variant:"filled",value:u,onChange:S=>f(S.target.value),sx:{"& .MuiFilledInput-root":{backgroundColor:"rgba(255,255,255,0.1)"}}}),e.jsxs(M,{direction:"row",spacing:1,children:[e.jsx(N,{variant:"outlined",onClick:K,startIcon:e.jsx(Ps,{}),fullWidth:!0,children:t("chessGame.reset")}),e.jsx(N,{variant:"outlined",onClick:R,startIcon:e.jsx(_s,{}),fullWidth:!0,children:t("chessGame.loadPgn")})]})]})]})})})]})]})})},Tr=({position:t,onMove:s,onSquareClick:r,boardWidth:o=500})=>e.jsx(Wt,{position:t,boardWidth:o,onPieceDrop:s?(n,a)=>s(n,a):void 0,onSquareClick:r}),ut=({initialFen:t})=>{const s=t||"8/8/8/8/8/8/8/8 w - - 0 1",[r,o]=i.useState(!1),[n]=i.useState(()=>{const C=new pe;return C.clear(),C}),[a,d]=i.useState(s),[m,u]=i.useState(null),[f,v]=i.useState(null),b=[{type:"k",color:"b",icon:"♚"},{type:"q",color:"b",icon:"♛"},{type:"r",color:"b",icon:"♜"},{type:"b",color:"b",icon:"♝"},{type:"n",color:"b",icon:"♞"},{type:"p",color:"b",icon:"♟"},{type:"k",color:"w",icon:"♔"},{type:"q",color:"w",icon:"♕"},{type:"r",color:"w",icon:"♖"},{type:"b",color:"w",icon:"♗"},{type:"n",color:"w",icon:"♘"},{type:"p",color:"w",icon:"♙"}],x=i.useRef(null);i.useEffect(()=>{const C=P=>{if(!m||!r||!x.current)return;const h=x.current.getBoundingClientRect(),y=P.clientX-h.left,I=P.clientY-h.top;y>=0&&I>=0&&y<=h.width&&I<=h.height&&v({left:y,top:I})};return window.addEventListener("mousemove",C),()=>window.removeEventListener("mousemove",C)},[m,r]);const l=(C,P,h)=>{let y=a.split(" "),I=y[2]==="-"?"":y[2];P?I=(I+h).split("").sort().join(""):I=I.replace(h,""),y[2]=I||"-";const R=y.join(" ");try{n.load(R),d(R)}catch{_.error({message:"Ошибка рокировки",description:void 0})}},g=C=>{const[P,h]=[C.charCodeAt(0)-97,8-parseInt(C[1])],I=n.board()[h][P];if(m){I&&I.type===m.type&&I.color===m.color?n.remove(C):n.put(m,C),d(n.fen());return}I&&(n.remove(C),d(n.fen()))},j=()=>{n.clear(),d(n.fen()),_.success({message:"Доска очищена!",description:void 0})},k=()=>{n.reset(),d(n.fen()),_.success({message:"Установлена начальная позиция!",description:void 0})},F=()=>{u(null),v(null)},D=()=>{if(a.split("").filter(P=>P.toLowerCase()==="k").length<2){_.error({message:"Некорректная позиция",description:"На доске должно быть как минимум два короля."});return}try{n.load(a),_.success({message:"Позиция сохранена",description:`FEN: ${a}`})}catch{_.error({message:"Ошибка сохранения",description:"Некорректная FEN-позиция"})}};return e.jsxs(q,{children:[e.jsx(c,{variant:"h4",gutterBottom:!0,children:"Редактор шахматной позиции"}),e.jsxs(p,{display:"flex",children:[e.jsxs(p,{onMouseEnter:()=>o(!0),onMouseLeave:()=>o(!1),style:{cursor:m?"none":"default",position:"relative",width:500,height:500},children:[e.jsx(Tr,{position:a,onSquareClick:g,boardWidth:500}),f&&m&&e.jsx("div",{style:{...f,position:"absolute",pointerEvents:"none",left:f.left,top:f.top,fontSize:"32px",zIndex:1e3},children:m.icon})]}),e.jsxs(p,{ml:3,display:"flex",flexDirection:"column",children:[e.jsxs(W,{elevation:3,style:{padding:"10px",marginBottom:"20px"},children:[e.jsx(c,{variant:"h6",gutterBottom:!0,children:"Фигуры"}),e.jsx(p,{display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:1,children:b.map((C,P)=>e.jsx(p,{onClick:()=>u(C),style:{textAlign:"center",cursor:"pointer",padding:6,border:"1px solid #aaa",borderRadius:4,fontSize:24,backgroundColor:m===C?"#1976d2":"#f5f5f5",color:m===C?"#fff":"inherit"},children:C.icon},P))})]}),e.jsxs(W,{elevation:3,style:{padding:"10px",marginBottom:"20px"},children:[e.jsx(c,{variant:"h6",children:"Рокировка"}),e.jsxs(Fs,{row:!0,children:[e.jsx(le,{control:e.jsx(ke,{checked:a.includes("K"),onChange:C=>l(a,C.target.checked,"K")}),label:"Белые 0-0"}),e.jsx(le,{control:e.jsx(ke,{checked:a.includes("Q"),onChange:C=>l(a,C.target.checked,"Q")}),label:"Белые 0-0-0"}),e.jsx(le,{control:e.jsx(ke,{checked:a.includes("k"),onChange:C=>l(a,C.target.checked,"k")}),label:"Чёрные 0-0"}),e.jsx(le,{control:e.jsx(ke,{checked:a.includes("q"),onChange:C=>l(a,C.target.checked,"q")}),label:"Чёрные 0-0-0"})]})]}),e.jsxs(W,{elevation:3,style:{padding:"10px"},children:[e.jsx(c,{variant:"h6",children:"Ход"}),e.jsxs(Es,{row:!0,value:n.turn(),onChange:C=>{const P=a.split(" ");P[1]=C.target.value;const h=P.join(" ");try{n.load(h),d(h)}catch{_.error({message:"Ошибка изменения хода",description:void 0})}},children:[e.jsx(le,{value:"w",control:e.jsx(Qe,{}),label:"Белые"}),e.jsx(le,{value:"b",control:e.jsx(Qe,{}),label:"Чёрные"})]})]})]})]}),e.jsxs(M,{direction:"row",spacing:2,mt:3,children:[e.jsx(N,{variant:"contained",onClick:j,children:"Очистить доску"}),e.jsx(N,{variant:"contained",onClick:k,children:"Начальная позиция"}),e.jsx(N,{variant:"contained",onClick:F,children:"Убрать фигуру"}),e.jsx(N,{variant:"contained",color:"primary",onClick:D,children:"Сохранить"})]}),e.jsx($,{label:"FEN",value:a,fullWidth:!0,multiline:!0,rows:2,onChange:C=>{const P=C.target.value;try{n.load(P),d(P)}catch{_.error({message:"Некорректный FEN",description:void 0})}},style:{marginTop:20}}),f&&m&&e.jsx("div",{style:f,children:m.icon})]})},zr=async t=>(await A.get("/auth/check-verification",{params:{email:t}})).data,$r=async t=>(await A.post("/auth/resend-verification",{email:t})).data,Hr=()=>{const t=oe(),s=Le(),{t:r}=B(),{firstName:o,lastName:n,email:a}=s.state||{},[d,m]=i.useState(!1),[u,f]=i.useState(!0),[v,b]=i.useState(null),[x,l]=i.useState(null),[g,j]=i.useState(!1),k=i.useRef(null);i.useEffect(()=>{if(!a){console.error("Email not found in location state. Redirecting to register."),t("/register");return}return k.current=setInterval(async()=>{try{const{emailVerified:D}=await zr(a);D&&(f(!1),t("/login",{state:{message:r("verifyEmail.verifiedAndReadyToLogin")}}))}catch(D){console.error("Polling error:",D)}},5e3),()=>{k.current&&clearInterval(k.current)}},[a,t,r]);const F=async()=>{var D;if(a){m(!0),b(null),l(null);try{await $r(a),b(r("verifyEmail.resendSuccess")),j(!0),setTimeout(()=>j(!1),12e4)}catch(C){((D=C.response)==null?void 0:D.status)===429?l(r("verifyEmail.resendErrorTooMany")):l(r("verifyEmail.resendError"))}finally{m(!1)}}};return e.jsxs(p,{textAlign:"center",mt:5,p:2,children:[u&&e.jsx(se,{sx:{mb:2}}),e.jsx(c,{variant:"h4",gutterBottom:!0,children:r("verifyEmail.pageTitle")}),e.jsx(c,{variant:"body1",gutterBottom:!0,children:e.jsx("b",{children:r("verifyEmail.greeting",{firstName:o||"",lastName:n||""})})}),e.jsx(c,{variant:"body1",gutterBottom:!0,children:r("verifyEmail.sentTo",{email:a||r("verifyEmail.yourEmail")})}),e.jsx(c,{variant:"body1",color:"text.secondary",sx:{mt:2,maxWidth:"600px",mx:"auto"},children:r("verifyEmail.instruction")}),v&&!x&&e.jsx(c,{variant:"body2",color:"primary.main",sx:{mt:2,fontWeight:"bold"},children:v}),x&&e.jsx(c,{variant:"body2",color:"error",sx:{mt:2,fontWeight:"bold"},children:x}),e.jsx(N,{variant:"contained",color:"primary",onClick:F,disabled:g||d,sx:{mt:3,mb:2},children:r(d?"verifyEmail.sending":"verifyEmail.resendButton")}),e.jsx(c,{variant:"caption",display:"block",children:r("verifyEmail.didNotReceive")})]})},Br=async()=>(await A.get("/trainer/requests",{})).data,Or=async(t,s)=>{await A.patch(`/trainer/request?request_id=${t}`,{status:s})},qr=async(t,s,r)=>(await A.post("/trainer/request",{coachId:t,experience:s,goals:r})).data,Ne={"& .MuiInputBase-root":{backgroundColor:"rgba(255, 255, 255, 0.08)","&:hover":{backgroundColor:"rgba(255, 255, 255, 0.12)"}},"& .MuiInputLabel-root":{color:"rgba(255, 255, 255, 0.6)"},"& .MuiInputBase-input":{color:"white"},"& .MuiSelect-icon":{color:"rgba(255, 255, 255, 0.6)"}},Kr=()=>{var z,O,re;const{t}=B(),[s,r]=i.useState([]),[o,n]=i.useState(null),[a,d]=i.useState(""),[m,u]=i.useState(!1),[f,v]=i.useState(!1),[b,x]=i.useState(!1),[l,g]=i.useState(!1),j=localStorage.getItem("email"),[k,F]=i.useState({userName:"",userEmail:"",experienceLevel:"Intermediate",goals:""}),[D,C]=i.useState({title:"",experience:"",bio:"",price:"",services:""});i.useEffect(()=>{(async()=>{try{const S=await ar();r(S)}catch{_.error({message:t("coaches.fetchError"),description:void 0})}})()},[t]);const P=w=>{var S,T,L,ae,Q,Z;n(w),u(!0),x(!1),g(!1),C({title:((S=w.coachProfile)==null?void 0:S.title)||"",experience:((T=w.coachProfile)==null?void 0:T.experience)||"",bio:((L=w.coachProfile)==null?void 0:L.bio)||"",price:((Q=(ae=w.coachProfile)==null?void 0:ae.price)==null?void 0:Q.toString())||"",services:(((Z=w.coachProfile)==null?void 0:Z.services)||[]).join(", ")})},h=()=>{u(!1),setTimeout(()=>{n(null),x(!1),g(!1),F({userName:"",userEmail:"",experienceLevel:"Intermediate",goals:""})},300)},y=async()=>{if(o)try{v(!0),await qr(o._id,k.experienceLevel,k.goals),_.success({message:t("coaches.successMessage"),description:void 0}),h()}catch{_.error({message:t("coaches.submitError"),description:void 0})}finally{v(!1)}},I=async()=>{console.log("Saving profile:",D),_.success({message:t("coaches.updated"),description:void 0}),h()},R=s.filter(w=>`${w.firstName} ${w.lastName}`.toLowerCase().includes(a.toLowerCase())),K=o?`${o.firstName} ${o.lastName}`:"";return e.jsx(p,{sx:{bgcolor:"#0e0e0e",color:"white",minHeight:"100vh",py:8},children:e.jsxs(q,{maxWidth:"lg",children:[e.jsxs(p,{sx:{textAlign:"center",mb:8},children:[e.jsx(c,{variant:"h2",component:"h1",fontWeight:"bold",children:t("coaches.title")}),e.jsx(c,{variant:"h6",sx:{mt:1,color:"rgba(255, 255, 255, 0.7)"},children:t("coaches.subtitle")})]}),e.jsx(p,{sx:{mb:5,maxWidth:"600px",mx:"auto"},children:e.jsx($,{fullWidth:!0,variant:"outlined",placeholder:t("coaches.searchByName"),value:a,onChange:w=>d(w.target.value),sx:{"& .MuiOutlinedInput-root":{borderRadius:"30px",backgroundColor:"#1c1c1c","& fieldset":{borderColor:"rgba(255, 255, 255, 0.2)"},"&:hover fieldset":{borderColor:"#FFD700"},"&.Mui-focused fieldset":{borderColor:"#FFD700"}},"& .MuiInputBase-input":{color:"white"}},InputProps:{startAdornment:e.jsx(Ds,{position:"start",children:e.jsx(As,{sx:{color:"rgba(255, 255, 255, 0.5)"}})})}})}),e.jsx(E,{container:!0,spacing:4,children:R.map(w=>{var S,T,L;return e.jsx(E,{item:!0,xs:12,sm:6,md:4,children:e.jsxs(vt,{sx:{bgcolor:"#1c1c1c",color:"white",borderRadius:4,height:"100%",display:"flex",flexDirection:"column",transition:"transform 0.3s ease, box-shadow 0.3s ease","&:hover":{transform:"translateY(-8px)",boxShadow:"0 12px 24px rgba(255, 215, 0, 0.2)"}},children:[e.jsx(yt,{component:"img",height:"250",image:w.photoUrl||"/images/default-avatar.png",alt:`${w.firstName} ${w.lastName}`}),e.jsxs(St,{sx:{flexGrow:1},children:[e.jsxs(c,{variant:"h5",component:"div",fontWeight:"bold",children:[w.firstName," ",w.lastName]}),e.jsx(c,{variant:"body1",sx:{color:"#FFD700",mb:2},children:((S=w.coachProfile)==null?void 0:S.title)||"Chess Master"}),e.jsxs(M,{spacing:1,children:[e.jsxs(p,{sx:{display:"flex",alignItems:"center",color:"rgba(255,255,255,0.7)"},children:[e.jsx(Rs,{fontSize:"small",sx:{mr:1}}),e.jsx(c,{variant:"body2",children:((T=w.coachProfile)==null?void 0:T.experience)||"N/A"})]}),e.jsxs(p,{sx:{display:"flex",alignItems:"center",color:"rgba(255,255,255,0.7)"},children:[e.jsx(Ms,{fontSize:"small",sx:{mr:1}}),e.jsx(c,{variant:"body2",children:(L=w.coachProfile)!=null&&L.price?`${w.coachProfile.price}$ / hour`:"Contact for price"})]})]})]}),e.jsx(p,{sx:{p:2,pt:0},children:e.jsx(N,{variant:"contained",fullWidth:!0,onClick:()=>P(w),sx:{backgroundColor:"#FFD700",color:"black",fontWeight:"bold",borderRadius:"20px","&:hover":{backgroundColor:"#FFC107"}},children:t("coaches.viewProfile")})})]})},w._id)})}),e.jsx(de,{open:m,onClose:h,fullWidth:!0,maxWidth:"md",PaperProps:{sx:{bgcolor:"#1c1c1c",color:"white",borderRadius:4,backgroundImage:"none"}},children:o&&e.jsxs(e.Fragment,{children:[e.jsx(he,{sx:{p:3,pb:1},children:e.jsxs(M,{direction:"row",justifyContent:"space-between",alignItems:"center",children:[e.jsx(c,{variant:"h5",fontWeight:"bold",children:l?t("coaches.editProfile"):t("coaches.profileOf",{coachName:K})}),e.jsx(V,{onClick:h,sx:{color:"rgba(255,255,255,0.7)"},children:e.jsx(Pt,{})})]})}),e.jsx(ue,{children:l?e.jsx(M,{spacing:2,sx:{pt:1}}):e.jsxs(e.Fragment,{children:[e.jsxs(E,{container:!0,spacing:4,sx:{pt:1},children:[e.jsx(E,{item:!0,xs:12,md:4,children:e.jsx($e,{src:o.photoUrl||"/images/default-avatar.png",sx:{width:"100%",height:"auto",aspectRatio:"1 / 1",borderRadius:3},variant:"rounded"})}),e.jsx(E,{item:!0,xs:12,md:8,children:e.jsxs(M,{spacing:2.5,children:[e.jsxs(p,{children:[e.jsx(c,{fontWeight:"bold",color:"#FFD700",children:t("coaches.bio")}),e.jsx(c,{sx:{color:"rgba(255,255,255,0.8)",whiteSpace:"pre-wrap"},children:((z=o.coachProfile)==null?void 0:z.bio)||e.jsx("span",{style:{color:"rgba(255,255,255,0.5)",fontStyle:"italic"},children:"No bio provided."})})]}),e.jsxs(p,{children:[e.jsx(c,{fontWeight:"bold",color:"#FFD700",children:t("coaches.services")}),e.jsx(p,{sx:{display:"flex",flexWrap:"wrap",gap:1,mt:1},children:(re=(O=o.coachProfile)==null?void 0:O.services)!=null&&re.length?o.coachProfile.services.map(w=>e.jsx(be,{label:w,sx:{bgcolor:"rgba(255,255,255,0.2)",color:"white"}},w)):e.jsx(c,{sx:{color:"rgba(255,255,255,0.5)",fontStyle:"italic"},children:"No services listed."})})]})]})})]}),e.jsx(X,{sx:{my:3,borderColor:"rgba(255,255,255,0.2)"}}),e.jsx(p,{children:b?e.jsxs(W,{elevation:0,sx:{p:{xs:2,sm:3},bgcolor:"rgba(0,0,0,0.25)",borderRadius:2},children:[e.jsx(c,{variant:"h6",fontWeight:"bold",sx:{mb:2},children:t("coaches.requestTitle",{coachName:K})}),e.jsxs(M,{spacing:2,children:[e.jsx($,{fullWidth:!0,label:t("coaches.yourName"),value:k.userName,onChange:w=>F({...k,userName:w.target.value}),variant:"filled",sx:Ne}),e.jsx($,{fullWidth:!0,label:t("coaches.yourEmail"),value:k.userEmail,onChange:w=>F({...k,userEmail:w.target.value}),variant:"filled",sx:Ne}),e.jsxs(Oe,{fullWidth:!0,variant:"filled",sx:Ne,children:[e.jsx(qe,{id:"level-select-label",children:t("coaches.level")}),e.jsxs(Fe,{labelId:"level-select-label",value:k.experienceLevel,onChange:w=>F({...k,experienceLevel:w.target.value}),children:[e.jsx(J,{value:"Beginner",children:t("coaches.levelBeginner")}),e.jsx(J,{value:"Intermediate",children:t("coaches.levelIntermediate")}),e.jsx(J,{value:"Advanced",children:t("coaches.levelAdvanced")})]})]}),e.jsx($,{fullWidth:!0,multiline:!0,rows:3,label:t("coaches.goals"),value:k.goals,onChange:w=>F({...k,goals:w.target.value}),variant:"filled",sx:Ne})]})]}):e.jsx(N,{fullWidth:!0,variant:"outlined",onClick:()=>x(!0),sx:{color:"#FFD700",borderColor:"#FFD700","&:hover":{borderColor:"#FFC107",bgcolor:"rgba(255, 215, 0, 0.1)"}},children:t("coaches.requestTitle",{coachName:o.firstName})})})]})}),e.jsx(me,{sx:{p:3,pt:2},children:l?e.jsxs(e.Fragment,{children:[e.jsx(N,{onClick:()=>g(!1),sx:{color:"rgba(255,255,255,0.7)"},children:t("coaches.cancel")}),e.jsx(N,{variant:"contained",onClick:I,startIcon:e.jsx(_e,{}),sx:{bgcolor:"#FFD700",color:"black","&:hover":{bgcolor:"#FFC107"}},children:t("coaches.save")})]}):b?e.jsxs(e.Fragment,{children:[e.jsx(N,{variant:"outlined",onClick:()=>x(!1),sx:{color:"rgba(255,255,255,0.7)",borderColor:"rgba(255,255,255,0.3)"},children:t("coaches.cancel")}),e.jsx(N,{variant:"contained",onClick:y,disabled:f,startIcon:e.jsx(wt,{}),sx:{bgcolor:"#FFD700",color:"black","&:hover":{bgcolor:"#FFC107"}},children:t("coaches.sendRequest")})]}):o.email===j&&e.jsx(N,{variant:"text",onClick:()=>g(!0),startIcon:e.jsx(_e,{}),sx:{color:"#FFD700"},children:t("coaches.editProfile")})})]})})]})})},Se=t=>"createdAt"in t,Yr=()=>{const{t}=B(),[s,r]=i.useState("requests"),[o,n]=i.useState([]),[a,d]=i.useState(null),[m,u]=i.useState(!0),[f,v]=i.useState(""),[b,x]=i.useState(!1),[l,g]=i.useState(null),[j,k]=i.useState(!1),F=i.useCallback(async h=>{u(!0),d(null);try{const y=h==="requests"?await Br():await yr();n(Array.isArray(y)?y:[])}catch(y){console.error(`Error loading ${h}:`,y),_.error({message:t("inbox.errors.loadFailed"),description:void 0})}finally{u(!1)}},[t]);i.useEffect(()=>{F(s)},[s,F]),i.useEffect(()=>{let h=null;return(async()=>{if(!a||Se(a)||!a.hasScreenshot){g(null);return}k(!0);try{const I=await Sr(a._id);h=URL.createObjectURL(I),g(h)}catch(I){console.error("Screenshot load error:",I),_.error({message:t("inbox.errors.loadScreenshotFailed"),description:void 0})}finally{k(!1)}})(),v(""),()=>{h&&URL.revokeObjectURL(h)}},[a,t]);const D=async h=>{if(!(!a||!Se(a))){x(!0);try{await Or(a._id,h),_.success({message:t("inbox.success.requestHandled",{action:t(h==="approved"?"inbox.success.actions.approved":"inbox.success.actions.rejected")}),description:void 0}),await F("requests")}catch(y){console.error("Error handling request:",y),_.error({message:t("inbox.errors.handleRequestFailed"),description:void 0})}finally{x(!1)}}},C=async h=>{if(!(!a||Se(a))){x(!0);try{await vr(a._id,{status:h,comment:f}),_.success({message:t("inbox.success.homeworkReviewed"),description:void 0}),await F("homework")}catch(y){console.error("Error reviewing homework:",y),_.error({message:t("inbox.errors.reviewHomeworkFailed"),description:void 0})}finally{x(!1)}}},P=()=>{var h;return m&&!a?null:a?Se(a)?e.jsxs(e.Fragment,{children:[e.jsxs(c,{variant:"h6",children:[a.student.firstName," ",a.student.lastName]}),e.jsxs(c,{children:[t("inbox.details.email"),": ",a.student.email]}),e.jsxs(c,{children:[t("inbox.details.sent"),": ",new Date(a.createdAt).toLocaleString()]}),e.jsx(X,{sx:{my:2}}),e.jsxs(c,{children:[e.jsxs("strong",{children:[t("inbox.details.experience"),":"]})," ",a.experience||t("inbox.details.notSpecified")]}),e.jsxs(c,{children:[e.jsxs("strong",{children:[t("inbox.details.goals"),":"]})," ",a.goals||t("inbox.details.notSpecified")]}),e.jsxs(p,{mt:3,display:"flex",gap:2,children:[e.jsx(N,{variant:"contained",color:"primary",onClick:()=>D("approved"),disabled:b||a.status!=="pending",children:t("inbox.actions.approve")}),e.jsx(N,{variant:"contained",color:"secondary",onClick:()=>D("rejected"),disabled:b||a.status!=="pending",children:t("inbox.actions.reject")})]})]}):e.jsxs(e.Fragment,{children:[e.jsx(c,{variant:"h5",gutterBottom:!0,children:((h=a.schedule)==null?void 0:h.title)||t("inbox.list.untitled")}),e.jsxs(c,{variant:"subtitle1",color:"text.secondary",gutterBottom:!0,children:[t("inbox.details.student"),": ",a.student.firstName," ",a.student.lastName]}),e.jsx(X,{sx:{my:2}}),a.text&&e.jsxs(p,{mb:2,children:[e.jsxs(c,{variant:"h6",children:[t("inbox.details.responseText"),":"]}),e.jsx(c,{sx:{whiteSpace:"pre-wrap",p:1,bgcolor:"action.hover",borderRadius:1},children:a.text})]}),a.hasScreenshot&&e.jsxs(p,{mb:2,children:[e.jsxs(c,{variant:"h6",children:[t("inbox.details.screenshot"),":"]}),j&&e.jsxs(p,{sx:{display:"flex",alignItems:"center",my:2},children:[e.jsx(se,{size:24,sx:{mr:2}})," ",t("inbox.loading")]}),l&&!j&&e.jsx(we,{href:l,target:"_blank",rel:"noopener noreferrer",children:e.jsx("img",{src:l,alt:t("inbox.details.screenshotAlt"),style:{maxWidth:"100%",height:"auto",borderRadius:"8px",border:"1px solid #ddd",display:"block",cursor:"pointer"}})})]}),e.jsx(X,{sx:{my:2}}),e.jsxs(c,{variant:"h6",children:[t("inbox.details.feedback"),":"]}),e.jsx($,{fullWidth:!0,multiline:!0,rows:4,label:t("inbox.details.commentLabel"),value:f,onChange:y=>v(y.target.value),margin:"normal",disabled:b}),e.jsxs(p,{mt:2,display:"flex",gap:2,children:[e.jsx(N,{variant:"contained",color:"success",onClick:()=>C("approved"),disabled:b,children:t("inbox.actions.approve")}),e.jsx(N,{variant:"contained",color:"error",onClick:()=>C("rejected"),disabled:b,children:t("inbox.actions.sendForRevision")})]})]}):e.jsx(c,{color:"text.secondary",children:t("inbox.selectItemPrompt")})};return e.jsxs(q,{sx:{py:4},children:[e.jsx(c,{variant:"h4",gutterBottom:!0,children:t("inbox.title")}),e.jsx(p,{sx:{borderBottom:1,borderColor:"divider",mb:2},children:e.jsxs(Be,{value:s,onChange:(h,y)=>r(y),"aria-label":"inbox tabs",children:[e.jsx(ne,{label:t("inbox.tabs.requests"),value:"requests"}),e.jsx(ne,{label:t("inbox.tabs.homework"),value:"homework"})]})}),e.jsxs(E,{container:!0,spacing:3,children:[e.jsx(E,{item:!0,xs:12,md:4,children:e.jsx(W,{style:{maxHeight:"80vh",overflow:"auto"},children:m?e.jsx(p,{sx:{display:"flex",justifyContent:"center",p:4},children:e.jsx(se,{})}):e.jsx(bt,{component:"nav",children:o.length>0?o.map(h=>{var y;return e.jsx(ee,{selected:(a==null?void 0:a._id)===h._id,onClick:()=>d(h),children:e.jsx(G,{primaryTypographyProps:{style:{fontWeight:(a==null?void 0:a._id)===h._id?"bold":"normal"}},primary:h.student?`${h.student.firstName} ${h.student.lastName}`:t("inbox.unknownStudent","Unknown Student"),secondary:Se(h)?t("inbox.list.requestSecondary",{date:new Date(h.createdAt).toLocaleDateString()}):t("inbox.list.homeworkSecondary",{title:((y=h.schedule)==null?void 0:y.title)||t("inbox.list.untitled","Без темы")})})},h._id)}):e.jsx(c,{sx:{p:2,textAlign:"center"},children:t("inbox.empty")})})})}),e.jsx(E,{item:!0,xs:12,md:8,children:e.jsx(W,{style:{padding:24,minHeight:"50vh",display:"flex",flexDirection:"column"},children:P()})})]})]})},Gr=Rt(U),Ur={individual_lesson:e.jsx(_t,{fontSize:"small"}),group_lesson:e.jsx(Ft,{fontSize:"small"}),homework:e.jsx(Et,{fontSize:"small"}),opening_study:e.jsx(Dt,{fontSize:"small"}),tournament_participation:e.jsx(At,{fontSize:"small"})},Vr=({event:t})=>{const s=Ur[t.type],r=`custom-event rbc-event--${t.type}`;return e.jsx(He,{title:t.description||t.title,placement:"top",children:e.jsxs("div",{className:r,children:[s,e.jsx(c,{variant:"caption",noWrap:!0,component:"span",children:t.title})]})})},Jr=({events:t,onSelectEvent:s})=>{const r=i.useMemo(()=>t.map(o=>({...o,start:new Date(o.date),end:U(o.date).add(1,"hour").toDate()})),[t]);return e.jsx(W,{className:"schedule-paper",style:{height:"70vh",padding:"16px"},children:e.jsx(Mt,{localizer:Gr,events:r,startAccessor:"start",endAccessor:"end",views:["month","week","day","agenda"],components:{event:Vr},onSelectEvent:s,className:"schedule-calendar-standalone"})})},mt=5,je={scheduled:{icon:e.jsx(fe,{fontSize:"small"}),color:"info",labelKey:"status.scheduled"},pending:{icon:e.jsx(fe,{fontSize:"small"}),color:"warning",labelKey:"status.pending"},completed:{icon:e.jsx(ce,{fontSize:"small"}),color:"success",labelKey:"status.completed"},approved:{icon:e.jsx(ce,{fontSize:"small"}),color:"success",labelKey:"status.approved"},rejected:{icon:e.jsx(ze,{fontSize:"small"}),color:"error",labelKey:"status.rejected"}},Xr=Object.keys(je),Qr=({event:t,onSelect:s,t:r})=>{const o=t.status,n=je[o]||je.scheduled;return e.jsxs(W,{className:`event-card event-card--${n.color}`,onClick:()=>s(t),children:[e.jsxs(p,{className:"event-card__header",children:[e.jsx(c,{variant:"h6",className:"event-card__title",children:t.title}),e.jsx(be,{icon:n.icon,label:r(n.labelKey),color:n.color,size:"small"})]}),e.jsx(c,{variant:"body2",className:"event-card__date",children:U(t.date).format("MMMM Do, YYYY [at] HH:mm")}),t.description&&e.jsx(c,{variant:"body2",className:"event-card__description",children:t.description})]})},Zr=({events:t,onSelectEvent:s,t:r})=>e.jsx(p,{className:"event-list",children:t.length===0?e.jsx(W,{className:"event-list__empty",children:e.jsx(c,{children:r("studentSchedule.noEventsForDay")})}):t.map(o=>e.jsx(Qr,{event:o,onSelect:s,t:r},o._id))}),en=({statusFilters:t,onFilterChange:s,t:r})=>{const o=(n,a)=>s(a);return e.jsxs(W,{className:"event-controls",children:[e.jsxs(c,{variant:"button",className:"event-controls__label",children:[r("common.filterByStatus"),":"]}),e.jsx(Ws,{value:t,onChange:o,size:"small",children:Xr.map(n=>e.jsx(Ls,{value:n,className:"filter-toggle-button",children:r(je[n].labelKey)},n))})]})},tn=({event:t,open:s,onClose:r,onSendHomework:o,t:n})=>{const[a,d]=i.useState(""),[m,u]=i.useState(null),[f,v]=i.useState(!1);if(i.useEffect(()=>{s||(d(""),u(null),v(!1))},[s]),!t)return null;const b=j=>{var F;const k=(F=j.target.files)==null?void 0:F[0];if(k){if(k.size>mt*1024*1024){_.error({message:n("errors.fileTooLarge",{size:mt}),description:void 0});return}u(k)}},x=async()=>{if(!a.trim()&&!m){_.error({message:n("errors.emptyHomework"),description:void 0});return}v(!0);try{await o(a,m)}finally{v(!1)}},l=t.status,g=je[l]||je.scheduled;return e.jsxs(de,{open:s,onClose:r,fullWidth:!0,maxWidth:"sm",className:"details-dialog",children:[e.jsx(he,{className:`details-dialog__header details-dialog__header--${g.color}`,children:n("studentSchedule.eventDetails")}),e.jsxs(ue,{className:"details-dialog__content",children:[e.jsxs(p,{className:"details-dialog__info",children:[e.jsx(c,{variant:"h6",className:"details-dialog__title",children:t.title}),e.jsx(be,{icon:g.icon,label:n(g.labelKey),color:g.color,size:"small"})]}),e.jsx(c,{variant:"body2",children:U(t.date).format("dddd, MMMM Do, YYYY [at] HH:mm")}),t.description&&e.jsx(c,{variant:"body1",sx:{mt:2},children:t.description}),t.link&&e.jsxs(c,{variant:"body2",sx:{mt:1},children:[n("studentSchedule.form_link"),": ",e.jsx(we,{href:t.link,target:"_blank",rel:"noopener noreferrer",children:t.link})]}),t.type==="homework"&&e.jsxs(p,{className:"homework-form",children:[e.jsx(c,{variant:"h6",className:"homework-form__title",children:n("studentSchedule.sendHomeworkTitle")}),e.jsx($,{label:n("studentSchedule.form_description"),fullWidth:!0,multiline:!0,rows:4,value:a,onChange:j=>d(j.target.value),variant:"filled",disabled:f}),e.jsxs(N,{variant:"outlined",component:"label",startIcon:e.jsx(Ct,{}),disabled:f,children:[m?m.name:n("studentSchedule.uploadScreenshot"),e.jsx("input",{type:"file",hidden:!0,accept:"image/*",onChange:b})]})]})]}),e.jsxs(me,{className:"details-dialog__actions",children:[e.jsx(N,{onClick:r,disabled:f,children:n("common.close")}),t.type==="homework"&&e.jsx(N,{onClick:x,variant:"contained",color:"primary",disabled:f,children:n("studentSchedule.send")})]})]})},sn=()=>{const{t}=B(),[s,r]=i.useState([]),[o,n]=i.useState(!0),[a,d]=i.useState(null),[m,u]=i.useState([]);i.useEffect(()=>{(async()=>{const g=localStorage.getItem("user");let j=null;try{g&&g!=="undefined"&&g!=="null"&&(j=JSON.parse(g)._id)}catch(k){console.error("Ошибка парсинга пользователя из localStorage:",k)}if(!j){n(!1),_.error({message:t("errors.userNotFound"),description:void 0});return}n(!0);try{const k=await Ee(j);r(k)}catch(k){console.error("Ошибка при загрузке расписания:",k),_.error({message:t("errors.fetchSchedule"),description:void 0})}finally{n(!1)}})()},[t]);const f=l=>d(l),v=()=>d(null),b=async(l,g)=>{const j=localStorage.getItem("user"),k=j?JSON.parse(j)._id:null;if(!(!k||!a))try{await Ye({studentId:k,scheduleId:a._id,homeworkText:l.trim()?l:void 0,screenshot:g||void 0}),a.coach&&await Ke({recipient:a.coach,type:"homework_submission",content:`Ученик отправил домашнее задание по теме: "${a.title}"`,metadata:{scheduleId:a._id}}),_.success({message:t("studentSchedule.homeworkSentSuccess"),description:void 0}),v(),r(F=>F.map(D=>D._id===a._id?{...D,status:"pending"}:D))}catch(F){console.error("Ошибка при отправке ДЗ:",F),_.error({message:t("errors.sendHomework"),description:void 0})}},x=i.useMemo(()=>{let l=[...s];return m.length>0&&(l=l.filter(g=>m.includes(g.status))),l.sort((g,j)=>new Date(g.date).getTime()-new Date(j.date).getTime())},[s,m]);return e.jsxs(p,{className:"student-schedule-v2-page",children:[e.jsxs(q,{maxWidth:"lg",children:[e.jsx(c,{variant:"h4",component:"h1",className:"page-title",children:t("studentSchedule.myScheduleTitle")}),e.jsx(Jr,{events:x,onSelectEvent:f}),e.jsxs(p,{className:"list-controls-container",children:[e.jsx(c,{variant:"h5",component:"h2",children:t("studentSchedule.eventListTitle")}),e.jsx(en,{statusFilters:m,onFilterChange:u,t})]}),o?e.jsx(p,{className:"loader-container",children:e.jsx(se,{className:"loader"})}):e.jsx(Zr,{events:x,onSelectEvent:f,t})]}),e.jsx(tn,{event:a,open:!!a,onClose:v,onSendHomework:b,t})]})};function Me(t){const{children:s,value:r,index:o,...n}=t;return e.jsx("div",{role:"tabpanel",hidden:r!==o,...n,children:r===o&&e.jsx(p,{sx:{pt:3},children:s})})}const rn=()=>{const{t}=B(),s=oe(),{userId:r}=jt(),o=i.useContext(ve);if(!o)throw new Error("AuthContext is not available");const{user:n,logout:a,loading:d,refetchUser:m}=o,[u,f]=i.useState(null),[v,b]=i.useState(null),[x,l]=i.useState([]),[g,j]=i.useState({profile:!0,coach:!1,schedule:!1}),[k,F]=i.useState(null),[D,C]=i.useState(!1),[P,h]=i.useState(0),[y,I]=i.useState(null);i.useEffect(()=>{if(d)return;if(!r){F("User ID is missing from the URL."),j(S=>({...S,profile:!1}));return}(async()=>{j({profile:!0,coach:!1,schedule:!1});try{const S=await Tt(r);f(S)}catch{F(t("profile.errorLoadingProfile"))}finally{j(S=>({...S,profile:!1}))}})()},[t,r,d]),i.useEffect(()=>{if(u){const w=(n==null?void 0:n._id)===u._id;u.trainer?(j(S=>({...S,coach:!0})),zt(u.trainer).then(b).catch(S=>console.error("Failed to fetch coach",S)).finally(()=>j(S=>({...S,coach:!1})))):b(null),w&&u.roles.some(S=>["student","user"].includes(S))?(j(S=>({...S,schedule:!0})),Ee(u._id).then(l).catch(S=>console.error("Failed to fetch schedule",S)).finally(()=>j(S=>({...S,schedule:!1})))):l([])}},[u,n==null?void 0:n._id]);const R=()=>{a(),s("/login")},K=(w,S)=>h(S),z=async(w,S)=>{if(!(!n||!y))try{await Ye({studentId:n._id,scheduleId:y._id,homeworkText:w.trim()||void 0,screenshot:S||void 0}),y.coach&&await Ke({recipient:y.coach,type:"homework_submission",content:`New homework from ${n.firstName} for: "${y.title}"`,metadata:{scheduleId:y._id}}),_.success({message:t("studentSchedule.homeworkSentSuccess","Homework sent successfully!"),description:void 0}),I(null),l(T=>T.map(L=>L._id===y._id?{...L,status:"pending"}:L))}catch{_.error({message:t("errors.sendHomework","Failed to send homework."),description:void 0})}},O=(n==null?void 0:n._id)===(u==null?void 0:u._id),re=i.useMemo(()=>u!=null&&u._id?Lt(u._id):"",[u]);return d||g.profile?e.jsx(p,{sx:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh",bgcolor:"#0e0e0e"},children:e.jsx(se,{sx:{color:"#FFD700"}})}):k||!u?e.jsx(p,{sx:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh",bgcolor:"#0e0e0e"},children:e.jsx(c,{color:"error",children:k||"User not found"})}):e.jsx(p,{sx:{bgcolor:"#0e0e0e",color:"white",minHeight:"100vh",py:5},children:e.jsxs(q,{maxWidth:"lg",children:[e.jsxs(p,{sx:{textAlign:"center",mb:5},children:[e.jsx(c,{variant:"h2",component:"h1",fontWeight:"bold",children:O?t("profile.title"):`${u.firstName}'s Profile`}),e.jsx(c,{variant:"h6",sx:{mt:1,color:"rgba(255, 255, 255, 0.7)"},children:O&&t("profile.subtitle")})]}),e.jsx(Bt,{user:u,coach:v,avatarUrl:re,isMyProfile:O,onEdit:()=>C(!0),onLogout:R,t}),e.jsx(p,{sx:{borderBottom:1,borderColor:"divider"},children:e.jsxs(Be,{value:P,onChange:K,textColor:"inherit",TabIndicatorProps:{sx:{backgroundColor:"#FFD700"}},children:[e.jsx(ne,{label:t("profile.tabs.overview","Overview")}),O&&u.roles.some(w=>["student","user"].includes(w))&&e.jsx(ne,{label:t("profile.tabs.lessons","All Lessons")}),e.jsx(ne,{label:t("profile.tabs.statistics","Statistics"),disabled:!0})]})}),e.jsx(Me,{value:P,index:0,children:O?e.jsx(qt,{schedule:x,isLoading:g.schedule,onEventSelect:I}):e.jsx(c,{sx:{color:"grey.500",textAlign:"center",p:4},children:"This is a public profile overview."})}),O&&u.roles.some(w=>["student","user"].includes(w))&&e.jsx(Me,{value:P,index:1,children:e.jsx(Ot,{schedule:x,isLoading:g.schedule,onEventSelect:I})}),e.jsx(Me,{value:P,index:O&&u.roles.some(w=>["student","user"].includes(w))?2:1,children:e.jsx(c,{sx:{color:"grey.500",textAlign:"center",p:4},children:"Game statistics and analytics are coming soon!"})}),O&&D&&e.jsx(Ht,{user:u,onClose:()=>{C(!1),m()}}),O&&e.jsx(Kt,{event:y,open:!!y,onClose:()=>I(null),onSendHomework:z})]})})},nn=()=>{const t=i.useContext(ve);if(!t)throw new Error("GuestRoute must be used within an AuthProvider");const{isAuthenticated:s,user:r,loading:o}=t;return o?e.jsx(p,{sx:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh"},children:e.jsx(se,{})}):s&&r?e.jsx(pt,{to:`/profile/${r._id}`,replace:!0}):e.jsx(gt,{})};function on(){const t=Le(),r=["/login","/register"].includes(t.pathname);return e.jsxs(e.Fragment,{children:[e.jsx(Ts,{}),!r&&e.jsx(or,{}),e.jsxs(rs,{children:[e.jsx(H,{path:"/",element:e.jsx(ur,{})}),e.jsx(H,{path:"/about",element:e.jsx(mr,{})}),e.jsx(H,{path:"/achievements",element:e.jsx(xr,{})}),e.jsxs(H,{element:e.jsx(nn,{}),children:[e.jsx(H,{path:"/login",element:e.jsx(nt,{})}),e.jsx(H,{path:"/register",element:e.jsx(nt,{})})]}),e.jsx(H,{path:"/analysis",element:e.jsx(Lr,{})}),e.jsx(H,{path:"/verify-email",element:e.jsx(Hr,{})}),e.jsx(H,{path:"/coaches",element:e.jsx(Kr,{})}),e.jsxs(H,{element:e.jsx(pr,{}),children:[e.jsx(H,{path:"/editor",element:e.jsx(ut,{})}),e.jsx(H,{path:"/profile",element:e.jsx(ct,{})}),e.jsx(H,{path:"/profile/:userId",element:e.jsx(ct,{})},t.pathname),e.jsx(H,{path:"/profile-test/:userId",element:e.jsx(rn,{})},t.pathname),e.jsx(H,{path:"/users",element:e.jsx(kr,{})}),e.jsx(H,{path:"/students-shedule",element:e.jsx(sn,{})}),e.jsx(H,{path:"/students",element:e.jsx(Er,{})}),e.jsx(H,{path:"/puzzle-editor",element:e.jsx(ut,{})}),e.jsx(H,{path:"/inbox",element:e.jsx(Yr,{})})]})]})]})}function an(){return e.jsx(i.Suspense,{fallback:e.jsx("div",{children:"Loading..."}),children:e.jsx(on,{})})}const Yt=document.getElementById("root");if(!Yt)throw new Error("Failed to find the root element");const ln=Xt.createRoot(Yt);ln.render(e.jsx(i.StrictMode,{children:e.jsx(ns,{children:e.jsx(Us,{children:e.jsx(an,{})})})}));
//# sourceMappingURL=index-CbhY6Cbi.js.map
